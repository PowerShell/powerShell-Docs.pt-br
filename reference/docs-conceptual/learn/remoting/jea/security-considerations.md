---
ms.date: 07/10/2019
keywords: jea,powershell,segurança
title: Considerações sobre segurança de JEA
description: Como o JEA permite que esses usuários executem comandos de administrador sem ter o acesso de administrador completo, você então poderá remover esses usuários de grupos de segurança altamente privilegiados.
ms.openlocfilehash: f65f9d6c6620261de0a9c8de7812637565ca1806
ms.sourcegitcommit: 9080316e3ca4f11d83067b41351531672b667b7a
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/24/2020
ms.locfileid: "92501568"
---
# <a name="jea-security-considerations"></a><span data-ttu-id="9f481-104">Considerações sobre segurança de JEA</span><span class="sxs-lookup"><span data-stu-id="9f481-104">JEA Security Considerations</span></span>

<span data-ttu-id="9f481-105">O JEA ajuda a melhorar a sua situação de segurança, reduzindo o número de administradores permanentes em seus computadores.</span><span class="sxs-lookup"><span data-stu-id="9f481-105">JEA helps you improve your security posture by reducing the number of permanent administrators on your machines.</span></span> <span data-ttu-id="9f481-106">O JEA usa uma configuração de sessão do PowerShell para criar um ponto de entrada para os usuários gerenciarem o sistema.</span><span class="sxs-lookup"><span data-stu-id="9f481-106">JEA uses a PowerShell session configuration to create a new entry point for users to manage the system.</span></span> <span data-ttu-id="9f481-107">Os usuários que precisam de acesso com privilégios elevados, mas não acesso ilimitado, ao computador para realizar tarefas administrativas podem receber acesso ao ponto de extremidade JEA.</span><span class="sxs-lookup"><span data-stu-id="9f481-107">Users who need elevated, but not unlimited, access to the machine to do administrative tasks can be granted access to the JEA endpoint.</span></span> <span data-ttu-id="9f481-108">Como o JEA permite que esses usuários executem comandos de administrador sem ter o acesso de administrador completo, você então poderá remover esses usuários de grupos de segurança altamente privilegiados.</span><span class="sxs-lookup"><span data-stu-id="9f481-108">Since JEA allows these users to run admin commands without having full admin access, you can then remove those users from highly privileged security groups.</span></span>

## <a name="run-as-account"></a><span data-ttu-id="9f481-109">Conta Executar como</span><span class="sxs-lookup"><span data-stu-id="9f481-109">Run-As account</span></span>

<span data-ttu-id="9f481-110">Cada ponto de extremidade JEA tem uma conta **Executar como** designada.</span><span class="sxs-lookup"><span data-stu-id="9f481-110">Each JEA endpoint has a designated **run-as** account.</span></span> <span data-ttu-id="9f481-111">Essa é a conta na qual as ações do usuário que está se conectando são executadas.</span><span class="sxs-lookup"><span data-stu-id="9f481-111">This is the account under which the connecting user's actions are executed.</span></span> <span data-ttu-id="9f481-112">Essa conta é configurável no [arquivo de configuração de sessão](session-configurations.md) e a conta que você escolher tem uma influência significativa sobre a segurança de seu ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="9f481-112">This account is configurable in the [session configuration file](session-configurations.md), and the account you choose has a significant bearing on the security of your endpoint.</span></span>

<span data-ttu-id="9f481-113">As **contas virtuais** são a maneira recomendada de configurar a conta **Executar como** .</span><span class="sxs-lookup"><span data-stu-id="9f481-113">**Virtual accounts** are the recommended way of configuring the **run-as** account.</span></span> <span data-ttu-id="9f481-114">As contas virtuais são avulsas, temporárias e locais que são criadas para o usuário que está se conectando para ser usada durante a duração de sua sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="9f481-114">Virtual accounts are one-time, temporary local accounts that are created for the connecting user to use during the duration of their JEA session.</span></span> <span data-ttu-id="9f481-115">Assim que a sessão é terminada, a conta virtual é destruída e não pode mais ser usada.</span><span class="sxs-lookup"><span data-stu-id="9f481-115">As soon as their session is terminated, the virtual account is destroyed and can't be used anymore.</span></span> <span data-ttu-id="9f481-116">O usuário que está se conectando não sabe as credenciais da conta virtual.</span><span class="sxs-lookup"><span data-stu-id="9f481-116">The connecting user doesn't know the credentials for the virtual account.</span></span> <span data-ttu-id="9f481-117">A conta virtual não pode ser usada para acessar o sistema por outros meios, como a Área de Trabalho Remota ou um ponto de extremidade irrestrito do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9f481-117">The virtual account can't be used to access the system via other means like Remote Desktop or an unconstrained PowerShell endpoint.</span></span>

<span data-ttu-id="9f481-118">Por padrão, as contas virtuais pertencem ao grupo local de **administradores** no computador.</span><span class="sxs-lookup"><span data-stu-id="9f481-118">By default, virtual accounts belong to the local **Administrators** group on the machine.</span></span> <span data-ttu-id="9f481-119">Isso dá a eles direitos totais para gerenciar qualquer coisa no sistema, mas não dá direito para gerenciar recursos na rede.</span><span class="sxs-lookup"><span data-stu-id="9f481-119">This gives them full rights to manage anything on the system, but no rights to manage resources on the network.</span></span>
<span data-ttu-id="9f481-120">Durante a autenticação com outros computadores, o contexto do usuário é aquele da conta do computador local, não da conta virtual.</span><span class="sxs-lookup"><span data-stu-id="9f481-120">When authenticating with other machines, the user context is that of the local computer account, not the virtual account.</span></span>

<span data-ttu-id="9f481-121">Os controladores de domínio são um caso especial, uma vez que não há um grupo local de **administradores** .</span><span class="sxs-lookup"><span data-stu-id="9f481-121">Domain controllers are a special case since there isn't a local **Administrators** group.</span></span> <span data-ttu-id="9f481-122">Em vez disso, as contas virtuais pertencem a **Administradores de Domínio** e podem gerenciar os serviços de diretório no controlador de domínio.</span><span class="sxs-lookup"><span data-stu-id="9f481-122">Instead, virtual accounts belong to **Domain Admins** and can manage the directory services on the domain controller.</span></span> <span data-ttu-id="9f481-123">A identidade do domínio ainda é restrita para uso no controlador de domínio em que foi criada uma instância da sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="9f481-123">The domain identity is still restricted for use on the domain controller where the JEA session was instantiated.</span></span> <span data-ttu-id="9f481-124">Qualquer acesso à rede parece ser proveniente do objeto de computador do controlador de domínio.</span><span class="sxs-lookup"><span data-stu-id="9f481-124">Any network access appears to come from the domain controller computer object instead.</span></span>

<span data-ttu-id="9f481-125">Em ambos os casos, você pode definir explicitamente a quais grupos de segurança a conta virtual pertence.</span><span class="sxs-lookup"><span data-stu-id="9f481-125">In both cases, you may explicitly define which security groups the virtual account belongs to.</span></span> <span data-ttu-id="9f481-126">Essa é uma boa prática quando a tarefa que pode ser realizada sem privilégios de administrador local ou de domínio.</span><span class="sxs-lookup"><span data-stu-id="9f481-126">This is a good practice when the task can be done without local or domain admin privileges.</span></span> <span data-ttu-id="9f481-127">Se você já tiver um grupo de segurança definido para seus administradores, conceda a associação de conta virtual a esse grupo.</span><span class="sxs-lookup"><span data-stu-id="9f481-127">If you already have a security group defined for your admins, grant the virtual account membership to that group.</span></span> <span data-ttu-id="9f481-128">A associação de grupo da conta virtual é limitada aos grupos de segurança locais na estação de trabalho e em servidores membro.</span><span class="sxs-lookup"><span data-stu-id="9f481-128">Virtual account group membership is limited to local security groups on workstation and member servers.</span></span> <span data-ttu-id="9f481-129">Em controladores de domínio, as contas virtuais precisam ser membros de grupos de segurança de domínio.</span><span class="sxs-lookup"><span data-stu-id="9f481-129">On domain controllers, virtual accounts must be members of domain security groups.</span></span>
<span data-ttu-id="9f481-130">Depois que a conta virtual é adicionada a um ou mais grupos de segurança, ela deixa de pertencer aos grupos padrão (administradores locais ou de domínio).</span><span class="sxs-lookup"><span data-stu-id="9f481-130">Once the virtual account has been added to one or more security groups, it no longer belongs to the default groups (local or domain admins).</span></span>

<span data-ttu-id="9f481-131">A seguinte tabela resume as possíveis opções de configuração e as permissões resultantes para as contas virtuais:</span><span class="sxs-lookup"><span data-stu-id="9f481-131">The following table summarizes the possible configuration options and resulting permissions for virtual accounts:</span></span>

|        <span data-ttu-id="9f481-132">Tipo de Computador</span><span class="sxs-lookup"><span data-stu-id="9f481-132">Computer type</span></span>         | <span data-ttu-id="9f481-133">Configuração do grupo de conta virtual</span><span class="sxs-lookup"><span data-stu-id="9f481-133">Virtual account group configuration</span></span> |                   <span data-ttu-id="9f481-134">Contexto de usuário local</span><span class="sxs-lookup"><span data-stu-id="9f481-134">Local user context</span></span>                    | <span data-ttu-id="9f481-135">Contexto de usuário de rede</span><span class="sxs-lookup"><span data-stu-id="9f481-135">Network user context</span></span> |
| ---------------------------- | ----------------------------------- | ------------------------------------------------------- | -------------------- |
| <span data-ttu-id="9f481-136">Controlador de domínio</span><span class="sxs-lookup"><span data-stu-id="9f481-136">Domain controller</span></span>            | <span data-ttu-id="9f481-137">Padrão</span><span class="sxs-lookup"><span data-stu-id="9f481-137">Default</span></span>                             | <span data-ttu-id="9f481-138">Usuário do domínio, membro de ' *DOMÍNIO* \Administradores de Domínio'</span><span class="sxs-lookup"><span data-stu-id="9f481-138">Domain user, member of ' *DOMAIN* \Domain Admins'</span></span>         | <span data-ttu-id="9f481-139">Conta de Computador</span><span class="sxs-lookup"><span data-stu-id="9f481-139">Computer account</span></span>     |
| <span data-ttu-id="9f481-140">Controlador de domínio</span><span class="sxs-lookup"><span data-stu-id="9f481-140">Domain controller</span></span>            | <span data-ttu-id="9f481-141">Grupos de domínio A e B</span><span class="sxs-lookup"><span data-stu-id="9f481-141">Domain groups A and B</span></span>               | <span data-ttu-id="9f481-142">Usuário do domínio, membro de ' *DOMÍNIO* \A', ' *DOMÍNIO* \B'</span><span class="sxs-lookup"><span data-stu-id="9f481-142">Domain user, member of ' *DOMAIN* \A', ' *DOMAIN* \B'</span></span>       | <span data-ttu-id="9f481-143">Conta de Computador</span><span class="sxs-lookup"><span data-stu-id="9f481-143">Computer account</span></span>     |
| <span data-ttu-id="9f481-144">Estação de trabalho ou servidor membro</span><span class="sxs-lookup"><span data-stu-id="9f481-144">Member server or workstation</span></span> | <span data-ttu-id="9f481-145">Padrão</span><span class="sxs-lookup"><span data-stu-id="9f481-145">Default</span></span>                             | <span data-ttu-id="9f481-146">Usuário local, membro de ' *BUILTIN* \Administradores'</span><span class="sxs-lookup"><span data-stu-id="9f481-146">Local user, member of ' *BUILTIN* \Administrators'</span></span>        | <span data-ttu-id="9f481-147">Conta de Computador</span><span class="sxs-lookup"><span data-stu-id="9f481-147">Computer account</span></span>     |
| <span data-ttu-id="9f481-148">Estação de trabalho ou servidor membro</span><span class="sxs-lookup"><span data-stu-id="9f481-148">Member server or workstation</span></span> | <span data-ttu-id="9f481-149">Grupos locais C e D</span><span class="sxs-lookup"><span data-stu-id="9f481-149">Local groups C and D</span></span>                | <span data-ttu-id="9f481-150">Usuário local, membro de ' *COMPUTADOR* \C' e ' *COMPUTADOR* \D'</span><span class="sxs-lookup"><span data-stu-id="9f481-150">Local user, member of ' *COMPUTER* \C' and ' *COMPUTER* \D'</span></span> | <span data-ttu-id="9f481-151">Conta de Computador</span><span class="sxs-lookup"><span data-stu-id="9f481-151">Computer account</span></span>     |

<span data-ttu-id="9f481-152">Quando você examinar os eventos de auditoria de segurança e os logs de eventos do aplicativo, verá que cada sessão de usuário JEA tem uma conta virtual exclusiva.</span><span class="sxs-lookup"><span data-stu-id="9f481-152">When you look at security audit events and application event logs, you see that each JEA user session has a unique virtual account.</span></span> <span data-ttu-id="9f481-153">Essa conta exclusiva ajuda você a acompanhar as ações de usuário em um ponto de extremidade JEA até o usuário original que executou o comando.</span><span class="sxs-lookup"><span data-stu-id="9f481-153">This unique account helps you track user actions in a JEA endpoint back to the original user who ran the command.</span></span> <span data-ttu-id="9f481-154">Os nomes das contas virtuais seguem o formato `WinRM Virtual Users\WinRM_VA_<ACCOUNTNUMBER>_<DOMAIN>_<sAMAccountName>`. Por exemplo, se o usuário **Alice** no domínio **Contoso** reiniciar um serviço em um ponto de extremidade JEA, o nome de usuário associado aos eventos do Gerenciador de Controle de Serviço será `WinRM Virtual Users\WinRM_VA_1_contoso_alice`.</span><span class="sxs-lookup"><span data-stu-id="9f481-154">Virtual account names follow the format `WinRM Virtual Users\WinRM_VA_<ACCOUNTNUMBER>_<DOMAIN>_<sAMAccountName>` For example, if user **Alice** in domain **Contoso** restarts a service in a JEA endpoint, the username associated with any service control manager events would be `WinRM Virtual Users\WinRM_VA_1_contoso_alice`.</span></span>

<span data-ttu-id="9f481-155">**As GMSAs (contas de serviço gerenciado de grupo)** são úteis quando um servidor membro precisa ter acesso aos recursos de rede na sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="9f481-155">**Group-managed service accounts (gMSAs)** are useful when a member server needs to have access to network resources in the JEA session.</span></span> <span data-ttu-id="9f481-156">Por exemplo, quando um ponto de extremidade JEA é usado para controlar o acesso a um serviço de API REST hospedado em outro computador.</span><span class="sxs-lookup"><span data-stu-id="9f481-156">For example, when a JEA endpoint is used to control access to a REST API service hosted on a different machine.</span></span> <span data-ttu-id="9f481-157">É fácil escrever funções para invocar as APIs REST, mas você precisa de uma identidade de rede para autenticação na API.</span><span class="sxs-lookup"><span data-stu-id="9f481-157">It's easy to write functions to invoke the REST APIs, but you need a network identity to authenticate with the API.</span></span> <span data-ttu-id="9f481-158">O uso de uma conta de serviço gerenciado de grupo possibilita o segundo salto, sem perder o controle sobre quais computadores podem usar a conta.</span><span class="sxs-lookup"><span data-stu-id="9f481-158">Using a group-managed service account makes the second hop possible while maintaining control over which computers can use the account.</span></span> <span data-ttu-id="9f481-159">As permissões efetivas da gMSA são definidas pelos grupos de segurança (local ou de domínio) ao qual a conta gMSA pertence.</span><span class="sxs-lookup"><span data-stu-id="9f481-159">The effective permissions of the gMSA are defined by the security groups (local or domain) to which the gMSA account belongs.</span></span>

<span data-ttu-id="9f481-160">Quando um ponto de extremidade JEA é configurado para usar uma GMSA, as ações de todos os usuários JEA parecem vir da mesma GMSA.</span><span class="sxs-lookup"><span data-stu-id="9f481-160">When a JEA endpoint is configured to use a gMSA, the actions of all JEA users appear to come from the same gMSA.</span></span> <span data-ttu-id="9f481-161">A única maneira de rastrear as ações até um usuário específico é identificar o conjunto de comandos executados em uma transcrição de sessão do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9f481-161">The only way to trace actions back to a specific user is to identify the set of commands run in a PowerShell session transcript.</span></span>

<span data-ttu-id="9f481-162">**Credenciais de passagem** são usadas quando você não especifica uma conta **Executar como** .</span><span class="sxs-lookup"><span data-stu-id="9f481-162">**Pass-thru credentials** are used when you don't specify a **run-as** account.</span></span> <span data-ttu-id="9f481-163">O PowerShell usa a credencial do usuário que está se conectando para executar comandos no servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="9f481-163">PowerShell uses the connecting user's credential to run commands on the remote server.</span></span> <span data-ttu-id="9f481-164">Isso exige que você permita acesso direto ao usuário que está se conectando aos grupos de gerenciamento privilegiado.</span><span class="sxs-lookup"><span data-stu-id="9f481-164">This requires you to grant the connecting user direct access to privileged management groups.</span></span> <span data-ttu-id="9f481-165">Essa configuração **não** é recomendada para o JEA.</span><span class="sxs-lookup"><span data-stu-id="9f481-165">This configuration is **not** recommended for JEA.</span></span> <span data-ttu-id="9f481-166">Se o usuário que estiver se conectando já tiver privilégios de administrador, ele poderá evitar o JEA e gerenciar o sistema por outros meios irrestritos.</span><span class="sxs-lookup"><span data-stu-id="9f481-166">If the connecting user already has admin privileges, they can avoid JEA and manage the system via other, unconstrained means.</span></span> <span data-ttu-id="9f481-167">Para obter mais informações, confira a seção abaixo sobre como [o JEA não fornece proteção contra administradores](#jea-doesnt-protect-against-admins).</span><span class="sxs-lookup"><span data-stu-id="9f481-167">For more information, see the section below on how [JEA doesn't protect against admins](#jea-doesnt-protect-against-admins).</span></span>

<span data-ttu-id="9f481-168">As **contas padrão Executar como** permitem especificar qualquer conta de usuário na qual toda a sessão do PowerShell é executada.</span><span class="sxs-lookup"><span data-stu-id="9f481-168">**Standard run-as accounts** allow you to specify any user account under which the entire PowerShell session runs.</span></span> <span data-ttu-id="9f481-169">As configurações de sessão que usam contas fixas **Executar como** (com o parâmetro `-RunAsCredential`) não reconhecem o JEA.</span><span class="sxs-lookup"><span data-stu-id="9f481-169">Session configurations using fixed **run-as** accounts (with the `-RunAsCredential` parameter) aren't JEA-aware.</span></span> <span data-ttu-id="9f481-170">As definições de função deixarão de funcionar conforme o esperado.</span><span class="sxs-lookup"><span data-stu-id="9f481-170">Role definitions no longer function as expected.</span></span> <span data-ttu-id="9f481-171">A mesma função é atribuída a todos os usuários autorizados a acessar o ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="9f481-171">Every user authorized to access the endpoint is assigned the same role.</span></span>

<span data-ttu-id="9f481-172">Você não deve usar uma **RunAsCredential** em um ponto de extremidade JEA, devido ao fato de ser difícil rastrear as ações até usuários específicos e não haver suporte para ela no mapeamento de usuários às funções.</span><span class="sxs-lookup"><span data-stu-id="9f481-172">You shouldn't use a **RunAsCredential** on a JEA endpoint because it's difficult to trace actions back to specific users and lacks support for mapping users to roles.</span></span>

## <a name="winrm-endpoint-acl"></a><span data-ttu-id="9f481-173">ACL do Ponto de Extremidade do WinRM</span><span class="sxs-lookup"><span data-stu-id="9f481-173">WinRM Endpoint ACL</span></span>

<span data-ttu-id="9f481-174">Assim como acontece com pontos de extremidade regulares de comunicação remota do PowerShell, cada ponto de extremidade JEA tem uma ACL (lista de controle de acesso) separada que controla quem pode se autenticar no ponto de extremidade JEA.</span><span class="sxs-lookup"><span data-stu-id="9f481-174">As with regular PowerShell remoting endpoints, each JEA endpoint has a separate access control list (ACL) that controls who can authenticate with the JEA endpoint.</span></span> <span data-ttu-id="9f481-175">Se ele for configurado incorretamente, os usuários confiáveis poderão não conseguir acessar o ponto de extremidade JEA e os usuários não confiáveis poderão ter acesso.</span><span class="sxs-lookup"><span data-stu-id="9f481-175">If improperly configured, trusted users may not be able to access the JEA endpoint and untrusted users may have access.</span></span> <span data-ttu-id="9f481-176">A ACL do WinRM não afeta o mapeamento de usuários às funções JEA.</span><span class="sxs-lookup"><span data-stu-id="9f481-176">The WinRM ACL doesn't affect the mapping of users to JEA roles.</span></span> <span data-ttu-id="9f481-177">O mapeamento é controlado pelo campo **RoleDefinitions** no arquivo de configuração de sessão usado para registrar o ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="9f481-177">Mapping is controlled by the **RoleDefinitions** field in the session configuration file used to register the endpoint.</span></span>

<span data-ttu-id="9f481-178">Por padrão, quando um ponto de extremidade JEA tem várias capacidades de função, a ACL do WinRM é configurada para permitir o acesso a todos os usuários mapeados.</span><span class="sxs-lookup"><span data-stu-id="9f481-178">By default, when a JEA endpoint has multiple role capabilities, the WinRM ACL is configured to allow access to all mapped users.</span></span> <span data-ttu-id="9f481-179">Por exemplo, uma sessão JEA configurada que usa os comandos a seguir permite acesso completo a `CONTOSO\JEA_Lev1` e `CONTOSO\JEA_Lev2`.</span><span class="sxs-lookup"><span data-stu-id="9f481-179">For example, a JEA session configured using the following commands grants full access to `CONTOSO\JEA_Lev1` and `CONTOSO\JEA_Lev2`.</span></span>

```powershell
$roles = @{ 'CONTOSO\JEA_Lev1' = 'Lev1Role'; 'CONTOSO\JEA_Lev2' = 'Lev2Role' }
New-PSSessionConfigurationFile -Path '.\jea.pssc' -SessionType RestrictedRemoteServer -RoleDefinitions $roles -RunAsVirtualAccount
Register-PSSessionConfiguration -Path '.\jea.pssc' -Name 'MyJEAEndpoint'
```

<span data-ttu-id="9f481-180">Você pode auditar as permissões de usuário com o cmdlet [Get-PSSessionConfiguration](/powershell/module/microsoft.powershell.core/get-pssessionconfiguration).</span><span class="sxs-lookup"><span data-stu-id="9f481-180">You can audit user permissions with the [Get-PSSessionConfiguration](/powershell/module/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span></span>

```powershell
Get-PSSessionConfiguration -Name 'MyJEAEndpoint' | Select-Object Permission
```

```Output
Permission
----------
CONTOSO\JEA_Lev1 AccessAllowed
CONTOSO\JEA_Lev2 AccessAllowed
```

<span data-ttu-id="9f481-181">Para alterar quais usuários têm acesso, execute `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` para um prompt interativo ou `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` para atualizar as permissões.</span><span class="sxs-lookup"><span data-stu-id="9f481-181">To change which users have access, run either `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` for an interactive prompt or `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` to update the permissions.</span></span> <span data-ttu-id="9f481-182">Os usuários precisam, pelo menos, de direitos de *Invocar* para acessar o ponto de extremidade JEA.</span><span class="sxs-lookup"><span data-stu-id="9f481-182">Users need at least *Invoke* rights to access the JEA endpoint.</span></span>

<span data-ttu-id="9f481-183">É possível criar um ponto de extremidade JEA que não mapeia uma função definida para cada usuário que tem acesso.</span><span class="sxs-lookup"><span data-stu-id="9f481-183">It's possible to create a JEA endpoint that doesn't map a defined role to every user that has access.</span></span> <span data-ttu-id="9f481-184">Esses usuários podem iniciar uma sessão JEA, mas só têm acesso aos cmdlets padrão.</span><span class="sxs-lookup"><span data-stu-id="9f481-184">These users can start a JEA session, but only have access to the default cmdlets.</span></span> <span data-ttu-id="9f481-185">Você pode auditar as permissões de usuário em um ponto de extremidade JEA executando o `Get-PSSessionCapability`.</span><span class="sxs-lookup"><span data-stu-id="9f481-185">You can audit user permissions in a JEA endpoint by running `Get-PSSessionCapability`.</span></span> <span data-ttu-id="9f481-186">Para obter mais informações, confira [Auditoria e relatórios no JEA](audit-and-report.md).</span><span class="sxs-lookup"><span data-stu-id="9f481-186">For more information, see [Auditing and Reporting on JEA](audit-and-report.md).</span></span>

## <a name="least-privilege-roles"></a><span data-ttu-id="9f481-187">Funções de privilégio mínimo</span><span class="sxs-lookup"><span data-stu-id="9f481-187">Least privilege roles</span></span>

<span data-ttu-id="9f481-188">Durante a criação de funções JEA, é importante lembrar que as contas virtuais e as contas de serviço gerenciado de grupo executadas em segundo plano têm acesso irrestrito ao computador local.</span><span class="sxs-lookup"><span data-stu-id="9f481-188">When designing JEA roles, it's important to remember that the virtual and group-managed service accounts running behind the scenes can have unrestricted access to the local machine.</span></span> <span data-ttu-id="9f481-189">As capacidades de função JEA ajudam a limitar os comandos e os aplicativos que podem ser executados nesse contexto privilegiado.</span><span class="sxs-lookup"><span data-stu-id="9f481-189">JEA role capabilities help limit the commands and applications that can be run in that privileged context.</span></span>
<span data-ttu-id="9f481-190">As funções projetadas de modo inadequado podem permitir comandos perigosos que, por sua vez, podem permitir que um usuário ultrapasse os limites do JEA ou obtenha acesso a informações confidenciais.</span><span class="sxs-lookup"><span data-stu-id="9f481-190">Improperly designed roles can allow dangerous commands that may permit a user to break out of the JEA boundaries or obtain access to sensitive information.</span></span>

<span data-ttu-id="9f481-191">Por exemplo, considere a seguinte entrada de capacidade de função:</span><span class="sxs-lookup"><span data-stu-id="9f481-191">For example, consider the following role capability entry:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\*-Process'
}
```

<span data-ttu-id="9f481-192">Essa capacidade de função permite que os usuários executem cmdlets do PowerShell com o substantivo **Process** do módulo **Microsoft.PowerShell.Management** .</span><span class="sxs-lookup"><span data-stu-id="9f481-192">This role capability allows users to run any PowerShell cmdlet with the noun **Process** from the **Microsoft.PowerShell.Management** module.</span></span> <span data-ttu-id="9f481-193">Os usuários podem precisar acessar cmdlets como `Get-Process` para ver quais aplicativos estão sendo executados no sistema e `Stop-Process` para encerrar os aplicativos que não esteja respondendo.</span><span class="sxs-lookup"><span data-stu-id="9f481-193">Users may need to access cmdlets like `Get-Process` to see what applications are running on the system and `Stop-Process` to kill applications that aren't responding.</span></span> <span data-ttu-id="9f481-194">No entanto, essa entrada também permite o `Start-Process`, que pode ser usado para iniciar um programa arbitrário com permissões de administrador completas.</span><span class="sxs-lookup"><span data-stu-id="9f481-194">However, this entry also allows `Start-Process`, which can be used to start up an arbitrary program with full administrator permissions.</span></span> <span data-ttu-id="9f481-195">O programa não precisa ser instalado localmente no sistema.</span><span class="sxs-lookup"><span data-stu-id="9f481-195">The program doesn't need to be installed locally on the system.</span></span> <span data-ttu-id="9f481-196">Um usuário conectado pode iniciar um programa em um compartilhamento de arquivo que concede privilégios de administrador local ao usuário, executa malware, entre outros.</span><span class="sxs-lookup"><span data-stu-id="9f481-196">A connected user could start a program from a file share that gives the user local admin privileges, runs malware, and more.</span></span>

<span data-ttu-id="9f481-197">Uma versão muito mais segura desse mesma capacidade de função seria:</span><span class="sxs-lookup"><span data-stu-id="9f481-197">A more secure version of this same role capability would look like:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\Get-Process', 'Microsoft.PowerShell.Management\Stop-Process'
}
```

<span data-ttu-id="9f481-198">Evite usar curingas em capacidades de função.</span><span class="sxs-lookup"><span data-stu-id="9f481-198">Avoid using wildcards in role capabilities.</span></span> <span data-ttu-id="9f481-199">Lembre-se de [auditar regularmente as permissões efetivas de usuário](audit-and-report.md#check-effective-rights-for-a-specific-user) para entender quais comandos estão disponíveis para o usuário.</span><span class="sxs-lookup"><span data-stu-id="9f481-199">Be sure to regularly [audit effective user permissions](audit-and-report.md#check-effective-rights-for-a-specific-user) to understand which commands are accessible to the user.</span></span>

## <a name="jea-doesnt-protect-against-admins"></a><span data-ttu-id="9f481-200">O JEA não oferece proteção contra administradores</span><span class="sxs-lookup"><span data-stu-id="9f481-200">JEA doesn't protect against admins</span></span>

<span data-ttu-id="9f481-201">Um dos princípios básicos do JEA é que ele permite que não administradores executem algumas tarefas de administrador.</span><span class="sxs-lookup"><span data-stu-id="9f481-201">One of the core principles of JEA is that it allows non-admins to do some admin tasks.</span></span> <span data-ttu-id="9f481-202">O JEA não oferece proteção contra os usuários que já têm privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="9f481-202">JEA doesn't protect against users who already have administrator privileges.</span></span> <span data-ttu-id="9f481-203">Os usuários que pertencem ao grupo **Administradores do Domínio** , ao grupo local de **administradores** ou a outros grupos altamente privilegiados podem burlar as proteções do JEA por outros meios.</span><span class="sxs-lookup"><span data-stu-id="9f481-203">Users who belong **Domain Admins** , local **Administrators** , or other highly privileged groups can circumvent JEA's protections via another means.</span></span> <span data-ttu-id="9f481-204">Por exemplo, eles podem entrar com o RDP, usar consoles remotos do MMC ou se conectar aos pontos de extremidade irrestritos do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9f481-204">For example, they could sign in with RDP, use remote MMC consoles, or connect to unconstrained PowerShell endpoints.</span></span> <span data-ttu-id="9f481-205">Além disso, os administradores locais em um sistema podem modificar as configurações do JEA para permitir usuários adicionais ou alterar uma capacidade de função para estender o escopo do que um usuário pode fazer em sua sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="9f481-205">Also, local admins on a system can modify JEA configurations to allow additional users or change a role capability to extend the scope of what a user can do in their JEA session.</span></span> <span data-ttu-id="9f481-206">É importante avaliar as permissões estendidas dos usuários JEA para ver se existem outras maneiras de obter acesso privilegiado ao sistema.</span><span class="sxs-lookup"><span data-stu-id="9f481-206">It's important to evaluate your JEA users' extended permissions to see if there are other ways to gain privileged access to the system.</span></span>

<span data-ttu-id="9f481-207">Uma prática comum é usar o JEA para a manutenção de rotina e ter uma solução de gerenciamento de acesso privilegiado just-in-time que permita que os usuários se tornem administradores locais temporariamente em situações de emergência.</span><span class="sxs-lookup"><span data-stu-id="9f481-207">A common practice is to use JEA for regular day-to-day maintenance and have a just-in-time, privileged access management solution that allows users to temporarily become local admins in emergency situations.</span></span> <span data-ttu-id="9f481-208">Isso ajuda a garantir que os usuários não sejam administradores permanentes no sistema, mas possam obter esses direitos se concluírem um fluxo de trabalho que documente o uso dessas permissões e somente quando fizerem isso.</span><span class="sxs-lookup"><span data-stu-id="9f481-208">This helps ensure users aren't permanent admins on the system, but can get those rights if, and only when, they complete a workflow that documents their use of those permissions.</span></span>
