---
ms.date: 07/09/2020
ms.topic: reference
title: Visão geral do sistema de tipo estendido
description: Visão geral do sistema de tipo estendido
ms.openlocfilehash: f4a789f779fa8a52f0fe524abff7ec3311e93b6c
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/10/2020
ms.locfileid: "92655724"
---
# <a name="extended-type-system-overview"></a><span data-ttu-id="8a93e-103">Visão geral do sistema de tipo estendido</span><span class="sxs-lookup"><span data-stu-id="8a93e-103">Extended Type System Overview</span></span>

<span data-ttu-id="8a93e-104">O PowerShell usa seu objeto **PSObject** para estender os tipos de objetos de duas maneiras.</span><span class="sxs-lookup"><span data-stu-id="8a93e-104">PowerShell uses its **PSObject** object to extend the types of objects in two ways.</span></span> <span data-ttu-id="8a93e-105">Primeiro, o objeto **PSObject** fornece uma maneira de mostrar diferentes modos de exibição de tipos de objetos específicos.</span><span class="sxs-lookup"><span data-stu-id="8a93e-105">First, the **PSObject** object provides a way to show different views of specific object types.</span></span> <span data-ttu-id="8a93e-106">Isso é conhecido como mostrar uma exibição adaptada de um objeto.</span><span class="sxs-lookup"><span data-stu-id="8a93e-106">This is referred to as showing an adapted view of an object.</span></span> <span data-ttu-id="8a93e-107">Em segundo lugar, o objeto **PSObject** fornece uma maneira de adicionar membros a um objeto existente.</span><span class="sxs-lookup"><span data-stu-id="8a93e-107">Second, the **PSObject** object provides a way to add members to existing object.</span></span> <span data-ttu-id="8a93e-108">Juntos, ao encapsular um objeto existente, chamado de objeto base, o objeto **PSObject** fornece um sistema de tipo estendido (ETS) que os desenvolvedores de script e cmdlet podem usar para manipular objetos .net no Shell.</span><span class="sxs-lookup"><span data-stu-id="8a93e-108">Together, by wrapping an existing object, referred to as the base object, the **PSObject** object provides an extended type system (ETS) that script and cmdlet developers can use to manipulate .NET objects within the shell.</span></span>

## <a name="cmdlet-and-script-development-issues"></a><span data-ttu-id="8a93e-109">Problemas de desenvolvimento de cmdlets e scripts</span><span class="sxs-lookup"><span data-stu-id="8a93e-109">Cmdlet and Script Development Issues</span></span>

<span data-ttu-id="8a93e-110">O ETS resolve dois problemas fundamentais:</span><span class="sxs-lookup"><span data-stu-id="8a93e-110">ETS resolves two fundamental issues:</span></span>

<span data-ttu-id="8a93e-111">Primeiro, alguns objetos .NET não têm o comportamento padrão necessário para atuar como os dados entre os cmdlets.</span><span class="sxs-lookup"><span data-stu-id="8a93e-111">First, some .NET Objects do not have the necessary default behavior for acting as the data between cmdlets.</span></span>

- <span data-ttu-id="8a93e-112">Alguns objetos .NET são objetos "meta" (por exemplo: objetos WMI, objetos ADO e objetos XML) cujos membros descrevem os dados que eles contêm.</span><span class="sxs-lookup"><span data-stu-id="8a93e-112">Some .NET objects are "meta" objects (for example: WMI Objects, ADO objects, and XML objects) whose members describe the data they contain.</span></span> <span data-ttu-id="8a93e-113">No entanto, em um ambiente de script, eles são os dados contidos que são mais interessantes, não a descrição dos dados contidos.</span><span class="sxs-lookup"><span data-stu-id="8a93e-113">However, in a scripting environment it is the contained data that is most interesting, not the description of the contained data.</span></span> <span data-ttu-id="8a93e-114">O ETS resolve esse problema introduzindo a noção de adaptadores que adaptam o objeto .NET subjacente para ter a semântica padrão esperada.</span><span class="sxs-lookup"><span data-stu-id="8a93e-114">ETS resolves this issue by introducing the notion of Adapters that adapt the underlying .NET object to have the expected default semantics.</span></span>
- <span data-ttu-id="8a93e-115">Alguns membros de objeto .NET são nomeados inconsistentes, fornecem um conjunto insuficiente de membros públicos ou fornecem funcionalidade insuficiente.</span><span class="sxs-lookup"><span data-stu-id="8a93e-115">Some .NET Object members are inconsistently named, provide an insufficient set of public members, or provide insufficient capability.</span></span> <span data-ttu-id="8a93e-116">O ETS resolve esse problema introduzindo a capacidade de estender o objeto .NET com membros adicionais.</span><span class="sxs-lookup"><span data-stu-id="8a93e-116">ETS resolves this issue by introducing the ability to extend the .NET object with additional members.</span></span>

<span data-ttu-id="8a93e-117">Em segundo lugar, a linguagem de script do PowerShell é sem _tipo_ , pois uma variável não precisa ser declarada de um tipo específico.</span><span class="sxs-lookup"><span data-stu-id="8a93e-117">Second, the PowerShell scripting language is _typeless_ in that a variable does not need to be declared of a particular type.</span></span> <span data-ttu-id="8a93e-118">Ou seja, as variáveis que um desenvolvedor de scripts cria são por natureza não _tipada_.</span><span class="sxs-lookup"><span data-stu-id="8a93e-118">That is, the variables a script developer creates are by nature _typeless_.</span></span> <span data-ttu-id="8a93e-119">No entanto, o sistema do PowerShell é "controlado por tipo", pois depende de ter um nome de tipo para operar para operações básicas, como resultados de saída ou classificação.</span><span class="sxs-lookup"><span data-stu-id="8a93e-119">However, the PowerShell system is "type-driven" in that it depends on having a type name to operate against for basic operations such as outputting results or sorting.</span></span>

<span data-ttu-id="8a93e-120">Portanto, um desenvolvedor de scripts deve ter a capacidade de declarar o tipo de uma de suas variáveis e criar seu próprio conjunto de "objetos" digitados dinamicamente que contenham Propriedades e métodos e possam participar do sistema orientado por tipos.</span><span class="sxs-lookup"><span data-stu-id="8a93e-120">Therefore a script developer must have the ability to state the type of one of their variables and build up their own set of dynamically typed "objects" that contain properties and methods and can participate in the type-driven system.</span></span> <span data-ttu-id="8a93e-121">O ETS resolve esse problema fornecendo um objeto comum para a linguagem de script que tem a capacidade de declarar seu tipo dinamicamente e adicionar membros dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="8a93e-121">ETS solves this problem by providing a common object for the scripting language that has the ability to state its type dynamically and to add members dynamically.</span></span>

<span data-ttu-id="8a93e-122">Fundamentalmente, o ETS resolve o problema mencionado anteriormente fornecendo o objeto **PSObject** , que atua como a base de todo o acesso a objetos da linguagem de script e fornece uma abstração padrão para o desenvolvedor de cmdlets.</span><span class="sxs-lookup"><span data-stu-id="8a93e-122">Fundamentally, ETS resolves the issue mentioned previously by providing the **PSObject** object, which acts as the basis of all object access from the scripting language and provides a standard abstraction for the cmdlet developer.</span></span>

### <a name="cmdlet-developers"></a><span data-ttu-id="8a93e-123">Desenvolvedores de cmdlets</span><span class="sxs-lookup"><span data-stu-id="8a93e-123">Cmdlet Developers</span></span>

<span data-ttu-id="8a93e-124">Para os desenvolvedores de cmdlets, o ETS fornece o seguinte suporte:</span><span class="sxs-lookup"><span data-stu-id="8a93e-124">For the cmdlet developers, ETS provides the following support:</span></span>

- <span data-ttu-id="8a93e-125">As abstrações para trabalhar com objetos de uma maneira genérica usando o objeto **PSObject** .</span><span class="sxs-lookup"><span data-stu-id="8a93e-125">The abstractions to work against objects in a generic way using the **PSObject** object.</span></span> <span data-ttu-id="8a93e-126">O ETS também fornece a capacidade de detalhar essas abstrações, se necessário.</span><span class="sxs-lookup"><span data-stu-id="8a93e-126">ETS also provides the ability to drill past these abstractions if required.</span></span>
- <span data-ttu-id="8a93e-127">Os mecanismos para criar um comportamento padrão para formatação, classificação, serialização e outras manipulações do sistema de seu tipo de objeto usando um conjunto conhecido de membros estendidos.</span><span class="sxs-lookup"><span data-stu-id="8a93e-127">The mechanisms to create a default behavior for formatting, sorting, serialization, and other system manipulations of their object type using a well-known set of extended members.</span></span>
- <span data-ttu-id="8a93e-128">O meio para operar em qualquer objeto usando a mesma semântica que a linguagem de script usando um objeto LanguagePrimitives.</span><span class="sxs-lookup"><span data-stu-id="8a93e-128">The means to operate against any object using the same semantics as the script language using a LanguagePrimitives object.</span></span>
- <span data-ttu-id="8a93e-129">O meio de "digitar" dinamicamente uma tabela de hash para que o restante do sistema possa operar com eficiência.</span><span class="sxs-lookup"><span data-stu-id="8a93e-129">The means to dynamically "type" a hash table so that the rest of the system can operate against it effectively.</span></span>

### <a name="script-developers"></a><span data-ttu-id="8a93e-130">Desenvolvedores de scripts</span><span class="sxs-lookup"><span data-stu-id="8a93e-130">Script Developers</span></span>

<span data-ttu-id="8a93e-131">Para os desenvolvedores de scripts, o ETS fornece o seguinte suporte:</span><span class="sxs-lookup"><span data-stu-id="8a93e-131">For the script developers, ETS provides the following support:</span></span>

- <span data-ttu-id="8a93e-132">A capacidade de fazer referência a qualquer tipo de objeto subjacente usando a mesma sintaxe ( `$a.x` ).</span><span class="sxs-lookup"><span data-stu-id="8a93e-132">The ability to reference any underlying object type using the same syntax (`$a.x`).</span></span>
- <span data-ttu-id="8a93e-133">A capacidade de acessar além da abstração fornecida pelo objeto **PSObject** (como acessar somente membros adaptados ou acessar o próprio objeto base).</span><span class="sxs-lookup"><span data-stu-id="8a93e-133">The ability to access beyond the abstraction provided by the **PSObject** object (such as accessing only adapted members, or accessing the base object itself).</span></span>
- <span data-ttu-id="8a93e-134">A capacidade de definir membros bem conhecidos que controlam a formatação, a classificação, a serialização e outras manipulações de uma instância ou tipo de objeto.</span><span class="sxs-lookup"><span data-stu-id="8a93e-134">The ability to define well-known members that control the formatting, sorting, serialization, and other manipulations of an object instance or type.</span></span>
- <span data-ttu-id="8a93e-135">O meio para nomear um objeto como um tipo específico e, portanto, controlar a herança de seus membros baseados em tipo.</span><span class="sxs-lookup"><span data-stu-id="8a93e-135">The means to name an object as a specific type and thus control the inheritance of its type-based members.</span></span>
- <span data-ttu-id="8a93e-136">A capacidade de adicionar, remover e modificar membros estendidos.</span><span class="sxs-lookup"><span data-stu-id="8a93e-136">The ability to add, remove, and modify extended members.</span></span>
- <span data-ttu-id="8a93e-137">A capacidade de manipular o objeto **PSObject** em si, se necessário.</span><span class="sxs-lookup"><span data-stu-id="8a93e-137">The ability to manipulate the **PSObject** object itself if required.</span></span>

## <a name="the-psobject-class"></a><span data-ttu-id="8a93e-138">A classe PSObject</span><span class="sxs-lookup"><span data-stu-id="8a93e-138">The PSObject class</span></span>

<span data-ttu-id="8a93e-139">O objeto **PSObject** é a base de todos os acessos a objetos da linguagem de script e fornece uma abstração padrão para o desenvolvedor de cmdlets.</span><span class="sxs-lookup"><span data-stu-id="8a93e-139">The **PSObject** object is the basis of all object access from the scripting language and provides a standard abstraction for the cmdlet developer.</span></span> <span data-ttu-id="8a93e-140">Ele contém um objeto base (um objeto .NET) e qualquer membro de instância (Membros, especificamente Membros estendidos, que estão presentes em uma determinada instância de objeto, enquanto não necessariamente em outros objetos do mesmo tipo).</span><span class="sxs-lookup"><span data-stu-id="8a93e-140">It contains a base-object (a .NET object) and any instance members (members, specifically extended members, that are present on a particular object instance while not necessarily on other objects of the same type).</span></span> <span data-ttu-id="8a93e-141">Dependendo do tipo do objeto base, o objeto **PSObject** também pode fornecer acesso implícito e explícito aos membros adaptados, bem como a qualquer membro estendido baseado em tipo.</span><span class="sxs-lookup"><span data-stu-id="8a93e-141">Depending on the type of the base-object, the **PSObject** object might also provide implicit and explicit access to adapted members as well as any type-based extended members.</span></span>

<span data-ttu-id="8a93e-142">O objeto **PSObject** fornece os seguintes mecanismos:</span><span class="sxs-lookup"><span data-stu-id="8a93e-142">The **PSObject** object provides the following mechanisms:</span></span>

- <span data-ttu-id="8a93e-143">A capacidade de construir um **PSObject** com ou sem um objeto base.</span><span class="sxs-lookup"><span data-stu-id="8a93e-143">The ability to construct an **PSObject** with or without a base-object.</span></span>
- <span data-ttu-id="8a93e-144">A capacidade de acessar todos os membros de cada objeto **PSObject** construído por meio de um algoritmo de pesquisa comum e a capacidade de substituir esse algoritmo quando necessário.</span><span class="sxs-lookup"><span data-stu-id="8a93e-144">The ability to access of all members of each constructed **PSObject** object through a common lookup algorithm and the ability to override that algorithm when required.</span></span>
- <span data-ttu-id="8a93e-145">A capacidade de obter e definir os nomes de tipo dos objetos **PSObject** construídos para que os scripts e cmdlets possam referenciar objetos **PSObject** semelhantes pelo mesmo nome-tipo, independentemente do tipo de seu objeto base.</span><span class="sxs-lookup"><span data-stu-id="8a93e-145">The ability to get and set the type-names of the constructed **PSObject** objects so that scripts and cmdlets can reference similar **PSObject** objects by the same type-name, regardless of the type of their base-object.</span></span>

### <a name="how-to-construct-a-psobject"></a><span data-ttu-id="8a93e-146">Como construir um PSObject</span><span class="sxs-lookup"><span data-stu-id="8a93e-146">How to Construct a PSObject</span></span>

<span data-ttu-id="8a93e-147">A lista a seguir descreve maneiras de criar um objeto **PSObject** :</span><span class="sxs-lookup"><span data-stu-id="8a93e-147">The following list describes ways to create a **PSObject** object:</span></span>

- <span data-ttu-id="8a93e-148">Chamar o construtor **PSObject** . #ctor cria um novo objeto **PSObject** com um objeto base de PSCustomObject.</span><span class="sxs-lookup"><span data-stu-id="8a93e-148">Calling the **PSObject** .#ctor constructor creates a new **PSObject** object with a base-object of PSCustomObject.</span></span> <span data-ttu-id="8a93e-149">Um objeto base desse tipo indica que o objeto **PSObject** não tem nenhum objeto base significativo.</span><span class="sxs-lookup"><span data-stu-id="8a93e-149">A base-object of this type indicates that the **PSObject** object has no meaningful base-object.</span></span> <span data-ttu-id="8a93e-150">No entanto, um objeto **PSObject** com esse tipo de objeto base fornece um recipiente de propriedades que os desenvolvedores de cmdlets podem encontrar úteis adicionando Membros estendidos.</span><span class="sxs-lookup"><span data-stu-id="8a93e-150">However, a **PSObject** object with this type of base-object does provide a property bag that cmdlet developers can find helpful by adding extended-members.</span></span>

<span data-ttu-id="8a93e-151">Os desenvolvedores também podem especificar o tipo de objeto-nome, que permite que esse objeto Compartilhe seus membros estendidos com outros objetos **PSObject** do mesmo nome de tipo.</span><span class="sxs-lookup"><span data-stu-id="8a93e-151">Developers can also specify the object type-name, which allows this object to share its extended-members with other **PSObject** objects of the same type-name.</span></span>

- <span data-ttu-id="8a93e-152">Chamar o construtor **PSObject** . #ctor (System. Object) cria um novo objeto **PSObject** com um objeto base do tipo System. Object.</span><span class="sxs-lookup"><span data-stu-id="8a93e-152">Calling the **PSObject** .#ctor(System.Object) constructor creates a new **PSObject** object with a base-object of type System.Object.</span></span>

  <span data-ttu-id="8a93e-153">Nesse caso, o tipo-nome para o objeto criado é uma coleção da hierarquia de derivação do objeto base.</span><span class="sxs-lookup"><span data-stu-id="8a93e-153">In this case, the type-name for the created object is a collection of the derivation hierarchy of the base-object.</span></span> <span data-ttu-id="8a93e-154">Por exemplo, o nome do tipo para o **PSObject** que contém um objeto base ProcessInfo incluiria os seguintes nomes:</span><span class="sxs-lookup"><span data-stu-id="8a93e-154">For example, the type-name for the **PSObject** that contains a ProcessInfo base-object would include the following names:</span></span>

  - <span data-ttu-id="8a93e-155">System.Diagnostics.Process</span><span class="sxs-lookup"><span data-stu-id="8a93e-155">System.Diagnostics.Process</span></span>
  - <span data-ttu-id="8a93e-156">System. ComponentModel. componente</span><span class="sxs-lookup"><span data-stu-id="8a93e-156">System.ComponentModel.Component</span></span>
  - <span data-ttu-id="8a93e-157">System.MarshalByRefObject</span><span class="sxs-lookup"><span data-stu-id="8a93e-157">System.MarshalByRefObject</span></span>
  - <span data-ttu-id="8a93e-158">System.Object</span><span class="sxs-lookup"><span data-stu-id="8a93e-158">System.Object</span></span>

- <span data-ttu-id="8a93e-159">Chamando o **PSObject** . O método AsPSObject (System. Object) cria um novo objeto **PSObject** com base em um objeto fornecido.</span><span class="sxs-lookup"><span data-stu-id="8a93e-159">Calling the **PSObject** .AsPSObject(System.Object) method creates a new **PSObject** object based on a supplied object.</span></span>

  <span data-ttu-id="8a93e-160">Se o objeto fornecido for do tipo System. Object, o objeto fornecido será usado como o objeto base para o novo objeto **PSObject** .</span><span class="sxs-lookup"><span data-stu-id="8a93e-160">If the supplied object is of type System.Object, the supplied object is used as the base-object for the new **PSObject** object.</span></span> <span data-ttu-id="8a93e-161">Se o objeto fornecido já for um objeto **PSObject** , o objeto fornecido será retornado como está.</span><span class="sxs-lookup"><span data-stu-id="8a93e-161">If the supplied object is already an **PSObject** object, the supplied object is returned as is.</span></span>

### <a name="base-adapted-and-extended-members"></a><span data-ttu-id="8a93e-162">Membros base, adaptados e estendidos</span><span class="sxs-lookup"><span data-stu-id="8a93e-162">Base, adapted, and extended members</span></span>

<span data-ttu-id="8a93e-163">Conceitualmente, o ETS usa os seguintes termos para mostrar a relação entre os membros originais do objeto base e os membros adicionados pelo PowerShell.</span><span class="sxs-lookup"><span data-stu-id="8a93e-163">Conceptually, ETS uses the following terms to show the relationship between the original members of the base-object and those members added by PowerShell.</span></span> <span data-ttu-id="8a93e-164">Para obter mais informações sobre os tipos específicos de membros que são usados pelo objeto **PSObject** , consulte [classe PSObject](/dotnet/api/system.management.automation.psobject).</span><span class="sxs-lookup"><span data-stu-id="8a93e-164">For more information about the specific types of members that are used by the **PSObject** object, see [PSObject class](/dotnet/api/system.management.automation.psobject).</span></span>

#### <a name="base-object-members"></a><span data-ttu-id="8a93e-165">Membros de objeto base</span><span class="sxs-lookup"><span data-stu-id="8a93e-165">Base-object members</span></span>

<span data-ttu-id="8a93e-166">Se o objeto base for especificado durante a construção dos objetos **PSObject** , os membros do objeto base serão disponibilizados por meio da propriedade Members.</span><span class="sxs-lookup"><span data-stu-id="8a93e-166">If the base-object is specified when constructing the **PSObject** objects, then the members of the base-object are made available through the Members property.</span></span>

#### <a name="adapted-members"></a><span data-ttu-id="8a93e-167">Membros adaptados</span><span class="sxs-lookup"><span data-stu-id="8a93e-167">Adapted members</span></span>

<span data-ttu-id="8a93e-168">Quando um objeto base é um metaobjeto, um que contém dados de um modo genérico cujas propriedades "descrevem" seus dados contidos, o ETS adapta esses objetos a uma exibição que permite o acesso direto aos dados por meio de membros adaptados do objeto **PSObject** .</span><span class="sxs-lookup"><span data-stu-id="8a93e-168">When a base-object is a meta-object, one that contains data in a generic fashion whose properties "describe" their contained data, ETS adapts those objects to a view that allows for direct access to the data through adapted members of the **PSObject** object.</span></span> <span data-ttu-id="8a93e-169">Membros adaptados e membros de objeto base são acessados por meio da propriedade Members.</span><span class="sxs-lookup"><span data-stu-id="8a93e-169">Adapted members and base-object members are accessed through the Members property.</span></span>

#### <a name="extended-members"></a><span data-ttu-id="8a93e-170">Membros estendidos</span><span class="sxs-lookup"><span data-stu-id="8a93e-170">Extended members</span></span>

<span data-ttu-id="8a93e-171">Além dos membros disponibilizados do objeto base ou dos membros adaptados criados pelo PowerShell, um **PSObject** também pode definir membros estendidos que estendem o objeto base original com informações adicionais que são úteis no ambiente de script.</span><span class="sxs-lookup"><span data-stu-id="8a93e-171">In addition to the members made available from the base-object or those adapted members created by PowerShell, an **PSObject** may also define extended members that extend the original base-object with additional information that is useful in the scripting environment.</span></span>

<span data-ttu-id="8a93e-172">Por exemplo, todos os cmdlets principais fornecidos pelo PowerShell, como os cmdlets Get-Content e Set-Content, usam um parâmetro Path.</span><span class="sxs-lookup"><span data-stu-id="8a93e-172">For example, all the core cmdlets provided by PowerShell, such as the Get-Content and Set-Content cmdlets, take a path parameter.</span></span> <span data-ttu-id="8a93e-173">Para garantir que esses cmdlets e outros possam trabalhar com objetos de tipos diferentes, um membro de caminho pode ser adicionado a esses objetos para que todos declarem suas informações de forma comum.</span><span class="sxs-lookup"><span data-stu-id="8a93e-173">To ensure that these cmdlets, and others, can work against objects of different types, a Path member can be added to those objects so that they all state their information in a common way.</span></span> <span data-ttu-id="8a93e-174">Esse membro de caminho estendido garante que os cmdlets possam trabalhar com todos esses tipos, mesmo que não haja um membro de caminho para a classe base.</span><span class="sxs-lookup"><span data-stu-id="8a93e-174">This extended Path member ensures that the cmdlets can work against all those types even though there base class might not have a Path member.</span></span>

<span data-ttu-id="8a93e-175">Membros estendidos, membros adaptados e membros de objeto base são todos acessados por meio da propriedade Members.</span><span class="sxs-lookup"><span data-stu-id="8a93e-175">Extended members, adapted members, and base-object members are all accessed through the Members property.</span></span>
