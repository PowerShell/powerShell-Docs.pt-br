---
title: Carregando e exportando dados de formatação | Microsoft Docs
ms.date: 09/13/2016
ms.openlocfilehash: b449b280ccee561679d58f2f2a8b467c83150766
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/05/2020
ms.locfileid: "87781113"
---
# <a name="loading-and-exporting-formatting-data"></a><span data-ttu-id="aaa5e-102">Carregar e exportar dados de formatação</span><span class="sxs-lookup"><span data-stu-id="aaa5e-102">Loading and Exporting Formatting Data</span></span>

<span data-ttu-id="aaa5e-103">Depois de criar o arquivo de formatação, você precisa atualizar os dados de formato da sessão carregando os arquivos na sessão atual.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-103">Once you have created your formatting file, you need to update the format data of the session by loading your files into the current session.</span></span> <span data-ttu-id="aaa5e-104">(Os arquivos de formatação fornecidos pelo Windows PowerShell são carregados por snap-ins que são registrados quando a sessão atual é aberta.) Depois que os dados de formato da sessão atual são atualizados, o Windows PowerShell usa esses dados para exibir os objetos .NET associados às exibições definidas nos arquivos de formatação carregados.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-104">(The formatting files provided by Windows PowerShell are loaded by snap-ins that are registered when the current session is opened.) Once the format data of the current session is updated, Windows PowerShell uses that data to display the .NET objects associated with the views defined in the loaded formatting files.</span></span> <span data-ttu-id="aaa5e-105">Não há nenhum limite para o número de arquivos de formatação que você pode carregar na sessão atual.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-105">There is no limit to the number of formatting files that you can load into the current session.</span></span> <span data-ttu-id="aaa5e-106">Além de atualizar os dados de formatação, você pode exportar os dados de formato na sessão atual de volta para um arquivo de formatação.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-106">In addition to updating the formatting data, you can export the format data in the current session back to a formatting file.</span></span>

## <a name="loading-format-data"></a><span data-ttu-id="aaa5e-107">Carregando dados de formato</span><span class="sxs-lookup"><span data-stu-id="aaa5e-107">Loading format data</span></span>

<span data-ttu-id="aaa5e-108">Os arquivos de formatação podem ser carregados na sessão atual usando os seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="aaa5e-108">Formatting files can be loaded into the current session using the following methods:</span></span>

- <span data-ttu-id="aaa5e-109">Você pode importar o arquivo de formatação para a sessão atual da linha de comando.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-109">You can import the formatting file into the current session from the command line.</span></span> <span data-ttu-id="aaa5e-110">Use o cmdlet [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) conforme descrito no procedimento a seguir.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-110">Use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet as described in the following procedure.</span></span>

- <span data-ttu-id="aaa5e-111">Você pode criar um manifesto de módulo que faça referência ao arquivo de formatação.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-111">You can create a module manifest that references your formatting file.</span></span> <span data-ttu-id="aaa5e-112">Os módulos permitem empacotar os arquivos de formatação para distribuição.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-112">Modules allow you to package you formatting files for distribution.</span></span> <span data-ttu-id="aaa5e-113">Use o cmdlet [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) para criar o manifesto e o cmdlet [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) para carregar o módulo na sessão atual.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-113">Use the [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) cmdlet to create the manifest, and the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to load the module into the current session.</span></span> <span data-ttu-id="aaa5e-114">Para obter mais informações sobre módulos, consulte [escrevendo um módulo do Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="aaa5e-114">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="aaa5e-115">Você pode criar um snap-in que faça referência ao arquivo de formatação.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-115">You can create a snap-in that references your formatting file.</span></span> <span data-ttu-id="aaa5e-116">Use o [System. Management. Automation. PSSnapin. formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) para fazer referência aos arquivos de formatação.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-116">Use the [System.Management.Automation.PSSnapIn.Formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) to reference your formatting files.</span></span> <span data-ttu-id="aaa5e-117">É altamente recomendável usar módulos para pacotes de cmdlets e todos os arquivos de formatação e tipos associados para distribuição.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-117">It is strongly encouraged to use modules to package cmdlets, and any associated formatting and types files for distribution.</span></span> <span data-ttu-id="aaa5e-118">Para obter mais informações sobre módulos, consulte [escrevendo um módulo do Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="aaa5e-118">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="aaa5e-119">Se você estiver invocando comandos programaticamente, poderá adicionar uma entrada de arquivo de formatação ao estado de sessão inicial do runspace em que os comandos são executados.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-119">If you are invoking commands programmatically, you can add a formatting file entry to the initial session state of the runspace where the commands are run.</span></span> <span data-ttu-id="aaa5e-120">Para obter mais informações sobre o tipo .NET usado para adicionar o arquivo de formatação, consulte [System. Management. Automation. Runspaces. Sessionstateformatentry? Classe displayproperty = FullName](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) .</span><span class="sxs-lookup"><span data-stu-id="aaa5e-120">For more information about .NET type used to add the formatting file, see the [System.Management.Automation.Runspaces.Sessionstateformatentry?Displayproperty=Fullname](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) class.</span></span>

<span data-ttu-id="aaa5e-121">Quando um arquivo de formatação é carregado, ele é adicionado a uma lista interna que o Windows PowerShell usa para determinar qual exibição usar ao exibir objetos na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-121">When a formatting file is loaded, it is added to an internal list that Windows PowerShell uses to determine which view to use when displaying objects at the command line.</span></span> <span data-ttu-id="aaa5e-122">Você pode colocar o arquivo de formatação no início da lista ou acrescentá-lo ao final da lista.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-122">You can prepend your formatting file to the beginning of the list, or you can append it to the end of the list.</span></span> <span data-ttu-id="aaa5e-123">Saber onde o arquivo de formatação é adicionado a essa lista é importante se você estiver carregando o arquivo de formatação que define uma exibição para um objeto que tem uma exibição existente definida, como quando você deseja alterar a forma como um objeto retornado por um cmdlet do Windows PowerShell Core é exibido.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-123">Knowing where your formatting file is added to this list is important if you are loading formatting file that defines a view for an object that has an existing view defined, such as when you want to change how an object that is returned by a Windows PowerShell core cmdlet is displayed.</span></span> <span data-ttu-id="aaa5e-124">Se você estiver carregando um arquivo de formatação que define a única exibição de um objeto, poderá usar qualquer um dos métodos descritos anteriormente.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-124">If you are loading a formatting file that defines the only view for an object, you can use any of the methods described previously.</span></span>  <span data-ttu-id="aaa5e-125">Se você estiver carregando um arquivo de formatação que define outra exibição para um objeto, deverá usar o cmdlet [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) e preceder o arquivo até o início da lista.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-125">If you are loading a formatting file that defines another view for an object, you must use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet and prepend your file to the beginning of the list.</span></span>

## <a name="storing-your-formatting-file"></a><span data-ttu-id="aaa5e-126">Armazenando o arquivo de formatação</span><span class="sxs-lookup"><span data-stu-id="aaa5e-126">Storing Your Formatting File</span></span>

<span data-ttu-id="aaa5e-127">Não há nenhum requisito para o local em que os arquivos de formatação são armazenados no disco.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-127">There is no requirement for where your formatting files are stored on disk.</span></span> <span data-ttu-id="aaa5e-128">No entanto, é altamente recomendável que você os armazene na seguinte pasta:`user\documents\windowspowershell\`</span><span class="sxs-lookup"><span data-stu-id="aaa5e-128">However, it is strongly suggested that you store them in the following folder: `user\documents\windowspowershell\`</span></span>

#### <a name="loading-a-format-file-using-import-formatdata"></a><span data-ttu-id="aaa5e-129">Carregando um arquivo de formato usando Import-FormatData</span><span class="sxs-lookup"><span data-stu-id="aaa5e-129">Loading a format file using Import-FormatData</span></span>

1. <span data-ttu-id="aaa5e-130">Armazene o arquivo de formatação em disco.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-130">Store your formatting file to disk.</span></span>

2. <span data-ttu-id="aaa5e-131">Execute o cmdlet [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) usando um dos comandos a seguir.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-131">Run the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet using one of the following commands.</span></span>

   <span data-ttu-id="aaa5e-132">Para adicionar o arquivo de formatação à frente da lista, use este comando.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-132">To add your formatting file to the front of the list use this command.</span></span> <span data-ttu-id="aaa5e-133">Use este comando se você estiver alterando como um objeto é exibido.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-133">Use this command if you are changing how an object is displayed.</span></span>

   ```powershell
   Update-FormatData -PrependPath PathToFormattingFile
   ```

   <span data-ttu-id="aaa5e-134">Para adicionar o arquivo de formatação ao final da lista, use este comando.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-134">To add your formatting file to the end of the list use this command.</span></span>

   ```powershell
   Update-FormatData -AppendPath PathToFormattingFile
   ```

   <span data-ttu-id="aaa5e-135">Depois de adicionar um arquivo usando o cmdlet [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) , você não poderá remover o arquivo da lista enquanto a sessão estiver aberta.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-135">Once you have added a file using the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet, you cannot remove the file from the list while the session is open.</span></span> <span data-ttu-id="aaa5e-136">Você deve fechar a sessão para remover o arquivo de formatação da lista.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-136">You must close the session to remove the formatting file from the list.</span></span>

## <a name="exporting-format-data"></a><span data-ttu-id="aaa5e-137">Exportando dados de formato</span><span class="sxs-lookup"><span data-stu-id="aaa5e-137">Exporting format data</span></span>

<span data-ttu-id="aaa5e-138">Insira o corpo da seção aqui.</span><span class="sxs-lookup"><span data-stu-id="aaa5e-138">Insert section body here.</span></span>
