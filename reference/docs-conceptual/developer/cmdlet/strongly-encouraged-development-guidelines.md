---
ms.date: 09/13/2016
ms.topic: reference
title: Diretrizes de desenvolvimento altamente recomendadas
description: Diretrizes de desenvolvimento altamente recomendadas
ms.openlocfilehash: e12fa0d1adc0d7a0dad938457bdcd289736df97c
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/10/2020
ms.locfileid: "93355231"
---
# <a name="strongly-encouraged-development-guidelines"></a><span data-ttu-id="f0e28-103">Diretrizes de desenvolvimento altamente recomendadas</span><span class="sxs-lookup"><span data-stu-id="f0e28-103">Strongly Encouraged Development Guidelines</span></span>

<span data-ttu-id="f0e28-104">Esta seção descreve as diretrizes que você deve seguir ao escrever seus cmdlets.</span><span class="sxs-lookup"><span data-stu-id="f0e28-104">This section describes guidelines that you should follow when you write your cmdlets.</span></span> <span data-ttu-id="f0e28-105">Elas são separadas em diretrizes para criar cmdlets e diretrizes para escrever seu código de cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e28-105">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="f0e28-106">Você pode achar que essas diretrizes não são aplicáveis a todos os cenários.</span><span class="sxs-lookup"><span data-stu-id="f0e28-106">You might find that these guidelines are not applicable for every scenario.</span></span> <span data-ttu-id="f0e28-107">No entanto, se eles se aplicarem e você não seguir essas diretrizes, os usuários poderão ter uma experiência ruim ao usar seus cmdlets.</span><span class="sxs-lookup"><span data-stu-id="f0e28-107">However, if they do apply and you do not follow these guidelines, your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="design-guidelines"></a><span data-ttu-id="f0e28-108">Diretrizes de design</span><span class="sxs-lookup"><span data-stu-id="f0e28-108">Design Guidelines</span></span>

<span data-ttu-id="f0e28-109">As diretrizes a seguir devem ser seguidas durante a criação de cmdlets para garantir uma experiência de usuário consistente entre usar seus cmdlets e outros cmdlets.</span><span class="sxs-lookup"><span data-stu-id="f0e28-109">The following guidelines should be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="f0e28-110">Quando encontrar uma diretriz de design que se aplique à sua situação, certifique-se de examinar as diretrizes de código para obter diretrizes semelhantes.</span><span class="sxs-lookup"><span data-stu-id="f0e28-110">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-a-specific-noun-for-a-cmdlet-name-sd01"></a><span data-ttu-id="f0e28-111">Usar um substantivo específico para um nome de cmdlet (SD01)</span><span class="sxs-lookup"><span data-stu-id="f0e28-111">Use a Specific Noun for a Cmdlet Name (SD01)</span></span>

<span data-ttu-id="f0e28-112">Os substantivos usados na nomenclatura de cmdlets precisam ser muito específicos para que o usuário possa descobrir seus cmdlets.</span><span class="sxs-lookup"><span data-stu-id="f0e28-112">Nouns used in cmdlet naming need to be very specific so that the user can discover your cmdlets.</span></span>
<span data-ttu-id="f0e28-113">Prefixe os substantivos genéricos, como "servidor", por uma versão reduzida do nome do produto.</span><span class="sxs-lookup"><span data-stu-id="f0e28-113">Prefix generic nouns such as "server" with a shortened version of the product name.</span></span> <span data-ttu-id="f0e28-114">Por exemplo, se um substantivo se referir a um servidor que está executando uma instância do Microsoft SQL Server, use um substantivo como "SQLServer".</span><span class="sxs-lookup"><span data-stu-id="f0e28-114">For example, if a noun refers to a server that is running an instance of Microsoft SQL Server, use a noun such as "SQLServer".</span></span> <span data-ttu-id="f0e28-115">A combinação de substantivos específicos e a lista curta de verbos aprovados permite que o usuário descubra e antecipe rapidamente a funcionalidade e, ao mesmo tempo, evita a duplicação entre nomes de cmdlets.</span><span class="sxs-lookup"><span data-stu-id="f0e28-115">The combination of specific nouns and the short list of approved verbs enable the user to quickly discover and anticipate functionality while avoiding duplication among cmdlet names.</span></span>

<span data-ttu-id="f0e28-116">Para aprimorar a experiência do usuário, o substantivo que você escolher para um nome de cmdlet deve ser singular.</span><span class="sxs-lookup"><span data-stu-id="f0e28-116">To enhance the user experience, the noun that you choose for a cmdlet name should be singular.</span></span> <span data-ttu-id="f0e28-117">Por exemplo, use o nome `Get-Process` em vez de **Get-Processes**.</span><span class="sxs-lookup"><span data-stu-id="f0e28-117">For example, use the name `Get-Process` instead of **Get-Processes**.</span></span> <span data-ttu-id="f0e28-118">É melhor seguir essa regra para todos os nomes de cmdlet, mesmo quando é provável que um cmdlet atue em mais de um item.</span><span class="sxs-lookup"><span data-stu-id="f0e28-118">It is best to follow this rule for all cmdlet names, even when a cmdlet is likely to act upon more than one item.</span></span>

### <a name="use-pascal-case-for-cmdlet-names-sd02"></a><span data-ttu-id="f0e28-119">Usar caso de Pascal para nomes de cmdlet (SD02)</span><span class="sxs-lookup"><span data-stu-id="f0e28-119">Use Pascal Case for Cmdlet Names (SD02)</span></span>

<span data-ttu-id="f0e28-120">Use o caso do Pascal para nomes de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f0e28-120">Use Pascal case for parameter names.</span></span> <span data-ttu-id="f0e28-121">Em outras palavras, coloque a primeira letra do verbo em maiúscula e todos os termos usados no substantivo.</span><span class="sxs-lookup"><span data-stu-id="f0e28-121">In other words, capitalize the first letter of verb and all terms used in the noun.</span></span> <span data-ttu-id="f0e28-122">Por exemplo, "`Clear-ItemProperty`".</span><span class="sxs-lookup"><span data-stu-id="f0e28-122">For example, "`Clear-ItemProperty`".</span></span>

### <a name="parameter-design-guidelines-sd03"></a><span data-ttu-id="f0e28-123">Diretrizes de design de parâmetro (SD03)</span><span class="sxs-lookup"><span data-stu-id="f0e28-123">Parameter Design Guidelines (SD03)</span></span>

<span data-ttu-id="f0e28-124">Um cmdlet precisa de parâmetros que recebem os dados nos quais ele deve operar e parâmetros que indicam informações que são usadas para determinar as características da operação.</span><span class="sxs-lookup"><span data-stu-id="f0e28-124">A cmdlet needs parameters that receive the data on which it must operate, and parameters that indicate information that is used to determine the characteristics of the operation.</span></span> <span data-ttu-id="f0e28-125">Por exemplo, um cmdlet pode ter um `Name` parâmetro que recebe dados do pipeline e o cmdlet pode ter um `Force` parâmetro para indicar que o cmdlet pode ser forçado a executar sua operação.</span><span class="sxs-lookup"><span data-stu-id="f0e28-125">For example, a cmdlet might have a `Name` parameter that receives data from the pipeline, and the cmdlet might have a `Force` parameter to indicate that the cmdlet can be forced to perform its operation.</span></span> <span data-ttu-id="f0e28-126">Não há nenhum limite para o número de parâmetros que um cmdlet pode definir.</span><span class="sxs-lookup"><span data-stu-id="f0e28-126">There is no limit to the number of parameters that a cmdlet can define.</span></span>

#### <a name="use-standard-parameter-names"></a><span data-ttu-id="f0e28-127">Usar nomes de parâmetro padrão</span><span class="sxs-lookup"><span data-stu-id="f0e28-127">Use Standard Parameter Names</span></span>

<span data-ttu-id="f0e28-128">O cmdlet deve usar nomes de parâmetro padrão para que o usuário possa determinar rapidamente o que significa um determinado parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f0e28-128">Your cmdlet should use standard parameter names so that the user can quickly determine what a particular parameter means.</span></span> <span data-ttu-id="f0e28-129">Se um nome mais específico for necessário, use um nome de parâmetro padrão e, em seguida, especifique um nome mais específico como um alias.</span><span class="sxs-lookup"><span data-stu-id="f0e28-129">If a more specific name is required, use a standard parameter name, and then specify a more specific name as an alias.</span></span> <span data-ttu-id="f0e28-130">Por exemplo, o `Get-Service` cmdlet tem um parâmetro que tem um nome genérico ( `Name` ) e um alias mais específico ( `ServiceName` ).</span><span class="sxs-lookup"><span data-stu-id="f0e28-130">For example, the `Get-Service` cmdlet has a parameter that has a generic name (`Name`) and a more specific alias (`ServiceName`).</span></span> <span data-ttu-id="f0e28-131">Ambos os termos podem ser usados para especificar o parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f0e28-131">Both terms can be used to specify the parameter.</span></span>

<span data-ttu-id="f0e28-132">Para obter mais informações sobre nomes de parâmetro e seus tipos de dados, consulte [diretrizes de funcionalidade e nome de parâmetro de cmdlet](./standard-cmdlet-parameter-names-and-types.md).</span><span class="sxs-lookup"><span data-stu-id="f0e28-132">For more information about parameter names and their data types, see [Cmdlet Parameter Name and Functionality Guidelines](./standard-cmdlet-parameter-names-and-types.md).</span></span>

#### <a name="use-singular-parameter-names"></a><span data-ttu-id="f0e28-133">Usar nomes de parâmetro singulares</span><span class="sxs-lookup"><span data-stu-id="f0e28-133">Use Singular Parameter Names</span></span>

<span data-ttu-id="f0e28-134">Evite usar nomes no plural para parâmetros cujo valor é um único elemento.</span><span class="sxs-lookup"><span data-stu-id="f0e28-134">Avoid using plural names for parameters whose value is a single element.</span></span> <span data-ttu-id="f0e28-135">Isso inclui parâmetros que usam matrizes ou listas porque o usuário pode fornecer uma matriz ou lista com apenas um elemento.</span><span class="sxs-lookup"><span data-stu-id="f0e28-135">This includes parameters that take arrays or lists because the user might supply an array or list with only one element.</span></span>

<span data-ttu-id="f0e28-136">Os nomes de parâmetro plural devem ser usados somente nesses casos em que o valor do parâmetro seja sempre um valor de vários elementos.</span><span class="sxs-lookup"><span data-stu-id="f0e28-136">Plural parameter names should be used only in those cases where the value of the parameter is always a multiple-element value.</span></span> <span data-ttu-id="f0e28-137">Nesses casos, o cmdlet deve verificar se vários elementos são fornecidos e o cmdlet deve exibir um aviso para o usuário se vários elementos não forem fornecidos.</span><span class="sxs-lookup"><span data-stu-id="f0e28-137">In these cases, the cmdlet should verify that multiple elements are supplied, and the cmdlet should display a warning to the user if multiple elements are not supplied.</span></span>

#### <a name="use-pascal-case-for-parameter-names"></a><span data-ttu-id="f0e28-138">Usar caso de Pascal para nomes de parâmetro</span><span class="sxs-lookup"><span data-stu-id="f0e28-138">Use Pascal Case for Parameter Names</span></span>

<span data-ttu-id="f0e28-139">Use o caso do Pascal para nomes de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f0e28-139">Use Pascal case for parameter names.</span></span> <span data-ttu-id="f0e28-140">Em outras palavras, coloque em maiúscula a primeira letra de cada palavra no nome do parâmetro, incluindo a primeira letra do nome.</span><span class="sxs-lookup"><span data-stu-id="f0e28-140">In other words, capitalize the first letter of each word in the parameter name, including the first letter of the name.</span></span> <span data-ttu-id="f0e28-141">Por exemplo, o nome do parâmetro `ErrorAction` usa a capitalização correta.</span><span class="sxs-lookup"><span data-stu-id="f0e28-141">For example, the parameter name `ErrorAction` uses the correct capitalization.</span></span> <span data-ttu-id="f0e28-142">Os seguintes nomes de parâmetro usam capitalização incorreta:</span><span class="sxs-lookup"><span data-stu-id="f0e28-142">The following parameter names use incorrect capitalization:</span></span>

- `errorAction`
- `erroraction`

#### <a name="parameters-that-take-a-list-of-options"></a><span data-ttu-id="f0e28-143">Parâmetros que usam uma lista de opções</span><span class="sxs-lookup"><span data-stu-id="f0e28-143">Parameters That Take a List of Options</span></span>

<span data-ttu-id="f0e28-144">Há duas maneiras de criar um parâmetro cujo valor pode ser selecionado em um conjunto de opções.</span><span class="sxs-lookup"><span data-stu-id="f0e28-144">There are two ways to create a parameter whose value can be selected from a set of options.</span></span>

- <span data-ttu-id="f0e28-145">Defina um tipo de enumeração (ou use um tipo de enumeração existente) que especifique os valores válidos.</span><span class="sxs-lookup"><span data-stu-id="f0e28-145">Define an enumeration type (or use an existing enumeration type) that specifies the valid values.</span></span>
  <span data-ttu-id="f0e28-146">Em seguida, use o tipo de enumeração para criar um parâmetro desse tipo.</span><span class="sxs-lookup"><span data-stu-id="f0e28-146">Then, use the enumeration type to create a parameter of that type.</span></span>

- <span data-ttu-id="f0e28-147">Adicione o atributo **ValidateSet** à declaração de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f0e28-147">Add the **ValidateSet** attribute to the parameter declaration.</span></span> <span data-ttu-id="f0e28-148">Para obter mais informações sobre esse atributo, consulte [declaração de atributo ValidateSet](./validateset-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="f0e28-148">For more information about this attribute, see [ValidateSet Attribute Declaration](./validateset-attribute-declaration.md).</span></span>

#### <a name="use-standard-types-for-parameters"></a><span data-ttu-id="f0e28-149">Usar tipos padrão para parâmetros</span><span class="sxs-lookup"><span data-stu-id="f0e28-149">Use Standard Types for Parameters</span></span>

<span data-ttu-id="f0e28-150">Para garantir a consistência com outros cmdlets, use tipos padrão para parâmetros onde for possível.</span><span class="sxs-lookup"><span data-stu-id="f0e28-150">To ensure consistency with other cmdlets, use standard types for parameters where ever possible.</span></span> <span data-ttu-id="f0e28-151">Para obter mais informações sobre os tipos que devem ser usados para parâmetros diferentes, consulte [tipos e nomes de parâmetro de cmdlet padrão](./standard-cmdlet-parameter-names-and-types.md).</span><span class="sxs-lookup"><span data-stu-id="f0e28-151">For more information about the types that should be used for different parameter, see [Standard Cmdlet Parameter Names and Types](./standard-cmdlet-parameter-names-and-types.md).</span></span> <span data-ttu-id="f0e28-152">Este tópico fornece links para vários tópicos que descrevem os nomes e os tipos de .NET Framework para grupos de parâmetros padrão, como "parâmetros de atividade".</span><span class="sxs-lookup"><span data-stu-id="f0e28-152">This topic provides links to several topics that describe the names and .NET Framework types for groups of standard parameters, such as the "activity parameters".</span></span>

#### <a name="use-strongly-typed-net-framework-types"></a><span data-ttu-id="f0e28-153">Usar tipos de .NET Framework de Strongly-Typed</span><span class="sxs-lookup"><span data-stu-id="f0e28-153">Use Strongly-Typed .NET Framework Types</span></span>

<span data-ttu-id="f0e28-154">Os parâmetros devem ser definidos como tipos de .NET Framework para fornecer melhor validação de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f0e28-154">Parameters should be defined as .NET Framework types to provide better parameter validation.</span></span> <span data-ttu-id="f0e28-155">Por exemplo, parâmetros que são restritos a um valor de um conjunto de valores devem ser definidos como um tipo de enumeração.</span><span class="sxs-lookup"><span data-stu-id="f0e28-155">For example, parameters that are restricted to one value from a set of values should be defined as an enumeration type.</span></span> <span data-ttu-id="f0e28-156">Para dar suporte a um valor de Uniform Resource Identifier (URI), defina o parâmetro como um tipo [System. URI](/dotnet/api/System.Uri) .</span><span class="sxs-lookup"><span data-stu-id="f0e28-156">To support a Uniform Resource Identifier (URI) value, define the parameter as a [System.Uri](/dotnet/api/System.Uri) type.</span></span> <span data-ttu-id="f0e28-157">Evite parâmetros de cadeia de caracteres básicos para todas as propriedades de texto de forma livre.</span><span class="sxs-lookup"><span data-stu-id="f0e28-157">Avoid basic string parameters for all but free-form text properties.</span></span>

#### <a name="use-consistent-parameter-types"></a><span data-ttu-id="f0e28-158">Usar tipos de parâmetro consistentes</span><span class="sxs-lookup"><span data-stu-id="f0e28-158">Use Consistent Parameter Types</span></span>

<span data-ttu-id="f0e28-159">Quando o mesmo parâmetro é usado por vários cmdlets, sempre use o mesmo tipo de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f0e28-159">When the same parameter is used by multiple cmdlets, always use the same parameter type.</span></span> <span data-ttu-id="f0e28-160">Por exemplo, se o `Process` parâmetro for um tipo [System. Int16](/dotnet/api/System.Int16) para um cmdlet, não torne o `Process` parâmetro para outro cmdlet um tipo [System. UInt16](/dotnet/api/System.UInt16) .</span><span class="sxs-lookup"><span data-stu-id="f0e28-160">For example, if the `Process` parameter is an [System.Int16](/dotnet/api/System.Int16) type for one cmdlet, do not make the `Process` parameter for another cmdlet a [System.Uint16](/dotnet/api/System.UInt16) type.</span></span>

#### <a name="parameters-that-take-true-and-false"></a><span data-ttu-id="f0e28-161">Parâmetros que assumem true e false</span><span class="sxs-lookup"><span data-stu-id="f0e28-161">Parameters That Take True and False</span></span>

<span data-ttu-id="f0e28-162">Se o parâmetro apenas usar `true` e `false` , defina o parâmetro como [System. Management. Automation. SwitchParameter](/dotnet/api/System.Management.Automation.SwitchParameter).</span><span class="sxs-lookup"><span data-stu-id="f0e28-162">If your parameter takes only `true` and `false`, define the parameter as type [System.Management.Automation.SwitchParameter](/dotnet/api/System.Management.Automation.SwitchParameter).</span></span>
<span data-ttu-id="f0e28-163">Um parâmetro de opção é tratado como `true` quando é especificado em um comando.</span><span class="sxs-lookup"><span data-stu-id="f0e28-163">A switch parameter is treated as `true` when it is specified in a command.</span></span> <span data-ttu-id="f0e28-164">Se o parâmetro não for incluído em um comando, o Windows PowerShell considerará o valor do parâmetro como `false` .</span><span class="sxs-lookup"><span data-stu-id="f0e28-164">If the parameter is not included in a command, Windows PowerShell considers the value of the parameter to be `false`.</span></span> <span data-ttu-id="f0e28-165">Não defina parâmetros boolianos.</span><span class="sxs-lookup"><span data-stu-id="f0e28-165">Do not define Boolean parameters.</span></span>

<span data-ttu-id="f0e28-166">Se o parâmetro precisar diferenciar entre 3 valores: $true, $false e "não especificado", defina um parâmetro do tipo Nullable \<bool> .</span><span class="sxs-lookup"><span data-stu-id="f0e28-166">If your parameter needs to differentiate between 3 values: $true, $false and "unspecified", then define a parameter of type Nullable\<bool>.</span></span> <span data-ttu-id="f0e28-167">A necessidade de um terceiro, o valor "não especificado", normalmente ocorre quando o cmdlet pode modificar uma propriedade booliana de um objeto.</span><span class="sxs-lookup"><span data-stu-id="f0e28-167">The need for a 3rd, "unspecified" value typically occurs when the cmdlet can modify a Boolean property of an object.</span></span> <span data-ttu-id="f0e28-168">Nesse caso, "não especificado" significa não alterar o valor atual da propriedade.</span><span class="sxs-lookup"><span data-stu-id="f0e28-168">In this case "unspecified" means to not change the current value of the property.</span></span>

#### <a name="support-arrays-for-parameters"></a><span data-ttu-id="f0e28-169">Suporte a matrizes para parâmetros</span><span class="sxs-lookup"><span data-stu-id="f0e28-169">Support Arrays for Parameters</span></span>

<span data-ttu-id="f0e28-170">Frequentemente, os usuários devem executar a mesma operação em vários argumentos.</span><span class="sxs-lookup"><span data-stu-id="f0e28-170">Frequently, users must perform the same operation against multiple arguments.</span></span> <span data-ttu-id="f0e28-171">Para esses usuários, um cmdlet deve aceitar uma matriz como entrada de parâmetro para que um usuário possa passar os argumentos para o parâmetro como uma variável do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f0e28-171">For these users, a cmdlet should accept an array as parameter input so that a user can pass the arguments into the parameter as a Windows PowerShell variable.</span></span> <span data-ttu-id="f0e28-172">Por exemplo, o cmdlet [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) usa uma matriz para as cadeias de caracteres que identificam os nomes dos processos a serem recuperados.</span><span class="sxs-lookup"><span data-stu-id="f0e28-172">For example, the [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) cmdlet uses an array for the strings that identify the names of the processes to retrieve.</span></span>

#### <a name="support-the-passthru-parameter"></a><span data-ttu-id="f0e28-173">Suporte ao parâmetro PassThru</span><span class="sxs-lookup"><span data-stu-id="f0e28-173">Support the PassThru Parameter</span></span>

<span data-ttu-id="f0e28-174">Por padrão, muitos cmdlets que modificam o sistema, como o cmdlet [Stop-Process](/powershell/module/Microsoft.PowerShell.Management/Stop-Process) , atuam como "coletores" para objetos e não retornam um resultado.</span><span class="sxs-lookup"><span data-stu-id="f0e28-174">By default, many cmdlets that modify the system, such as the [Stop-Process](/powershell/module/Microsoft.PowerShell.Management/Stop-Process) cmdlet, act as "sinks" for objects and do not return a result.</span></span> <span data-ttu-id="f0e28-175">Esse cmdlet deve implementar o `PassThru` parâmetro para forçar o cmdlet a retornar um objeto.</span><span class="sxs-lookup"><span data-stu-id="f0e28-175">These cmdlet should implement the `PassThru` parameter to force the cmdlet to return an object.</span></span> <span data-ttu-id="f0e28-176">Quando o `PassThru` parâmetro é especificado, o cmdlet retorna um objeto usando uma chamada para o método [System. Management. Automation. cmdlet. WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) .</span><span class="sxs-lookup"><span data-stu-id="f0e28-176">When the `PassThru` parameter is specified, the cmdlet returns an object by using a call to the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="f0e28-177">Por exemplo, o comando a seguir interrompe o processo de cálculo e passa o processo resultante para o pipeline.</span><span class="sxs-lookup"><span data-stu-id="f0e28-177">For example, the following command stops the Calc process and passes the resultant process to the pipeline.</span></span>

```powershell
Stop-Process calc -passthru
```

<span data-ttu-id="f0e28-178">Na maioria dos casos, adicionar, definir e novos cmdlets devem dar suporte a um `PassThru` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f0e28-178">In most cases, Add, Set, and New cmdlets should support a `PassThru` parameter.</span></span>

#### <a name="support-parameter-sets"></a><span data-ttu-id="f0e28-179">Conjuntos de parâmetros de suporte</span><span class="sxs-lookup"><span data-stu-id="f0e28-179">Support Parameter Sets</span></span>

<span data-ttu-id="f0e28-180">Um cmdlet destina-se a realizar uma única finalidade.</span><span class="sxs-lookup"><span data-stu-id="f0e28-180">A cmdlet is intended to accomplish a single purpose.</span></span> <span data-ttu-id="f0e28-181">No entanto, há muitas vezes mais de uma maneira de descrever a operação ou o destino da operação.</span><span class="sxs-lookup"><span data-stu-id="f0e28-181">However, there is frequently more than one way to describe the operation or the operation target.</span></span> <span data-ttu-id="f0e28-182">Por exemplo, um processo pode ser identificado por seu nome, por seu identificador ou por um objeto de processo.</span><span class="sxs-lookup"><span data-stu-id="f0e28-182">For example, a process might be identified by its name, by its identifier, or by a process object.</span></span> <span data-ttu-id="f0e28-183">O cmdlet deve dar suporte a todas as representações razoáveis de seus destinos.</span><span class="sxs-lookup"><span data-stu-id="f0e28-183">The cmdlet should support all the reasonable representations of its targets.</span></span> <span data-ttu-id="f0e28-184">Normalmente, o cmdlet atende a esse requisito especificando conjuntos de parâmetros (chamados de conjuntos de parâmetros) que operam juntos.</span><span class="sxs-lookup"><span data-stu-id="f0e28-184">Normally, the cmdlet satisfies this requirement by specifying sets of parameters (referred to as parameter sets) that operate together.</span></span> <span data-ttu-id="f0e28-185">Um único parâmetro pode pertencer a qualquer número de conjuntos de parâmetros.</span><span class="sxs-lookup"><span data-stu-id="f0e28-185">A single parameter can belong to any number of parameter sets.</span></span> <span data-ttu-id="f0e28-186">Para obter mais informações sobre conjuntos de parâmetros, consulte [conjuntos de parâmetros de cmdlet](./cmdlet-parameter-sets.md).</span><span class="sxs-lookup"><span data-stu-id="f0e28-186">For more information about parameter sets, see [Cmdlet Parameter Sets](./cmdlet-parameter-sets.md).</span></span>

<span data-ttu-id="f0e28-187">Ao especificar conjuntos de parâmetros, defina apenas um parâmetro no conjunto como ValueFromPipeline.</span><span class="sxs-lookup"><span data-stu-id="f0e28-187">When you specify parameter sets, set only one parameter in the set to ValueFromPipeline.</span></span> <span data-ttu-id="f0e28-188">Para obter mais informações sobre como declarar o atributo de **parâmetro** , consulte [declaração de ParameterAttribute](./parameter-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="f0e28-188">For more information about how to declare the **Parameter** attribute, see [ParameterAttribute Declaration](./parameter-attribute-declaration.md).</span></span>

<span data-ttu-id="f0e28-189">Quando os conjuntos de parâmetros são usados, o conjunto de parâmetros padrão é definido pelo atributo de **cmdlet** .</span><span class="sxs-lookup"><span data-stu-id="f0e28-189">When parameter sets are used, the default parameter set is defined by the **Cmdlet** attribute.</span></span> <span data-ttu-id="f0e28-190">O conjunto de parâmetros padrão deve incluir os parâmetros mais prováveis de serem usados em uma sessão interativa do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f0e28-190">The default parameter set should include the parameters most likely to be used in an interactive Windows PowerShell session.</span></span> <span data-ttu-id="f0e28-191">Para obter mais informações sobre como declarar o atributo de **cmdlet** , consulte [declaração de CmdletAttribute](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="f0e28-191">For more information about how to declare the **Cmdlet** attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="provide-feedback-to-the-user-sd04"></a><span data-ttu-id="f0e28-192">Fornecer comentários para o usuário (SD04)</span><span class="sxs-lookup"><span data-stu-id="f0e28-192">Provide Feedback to the User (SD04)</span></span>

<span data-ttu-id="f0e28-193">Use as diretrizes desta seção para fornecer comentários ao usuário.</span><span class="sxs-lookup"><span data-stu-id="f0e28-193">Use the guidelines in this section to provide feedback to the user.</span></span> <span data-ttu-id="f0e28-194">Esses comentários permitem que o usuário esteja ciente do que está ocorrendo no sistema e tome decisões administrativas melhores.</span><span class="sxs-lookup"><span data-stu-id="f0e28-194">This feedback allows the user to be aware of what is occurring in the system and to make better administrative decisions.</span></span>

<span data-ttu-id="f0e28-195">O tempo de execução do Windows PowerShell permite que um usuário especifique como tratar a saída de cada chamada para o `Write` método definindo uma variável de preferência.</span><span class="sxs-lookup"><span data-stu-id="f0e28-195">The Windows PowerShell runtime allows a user to specify how to handle output from each call to the `Write` method by setting a preference variable.</span></span> <span data-ttu-id="f0e28-196">O usuário pode definir várias variáveis de preferência, incluindo uma variável que determina se o sistema deve exibir informações e uma variável que determina se o sistema deve consultar o usuário antes de realizar uma ação adicional.</span><span class="sxs-lookup"><span data-stu-id="f0e28-196">The user can set several preference variables, including a variable that determines whether the system should display information and a variable that determines whether the system should query the user before taking further action.</span></span>

#### <a name="support-the-writewarning-writeverbose-and-writedebug-methods"></a><span data-ttu-id="f0e28-197">Suporte aos métodos WriteWarning, WriteVerbose e WriteDebug</span><span class="sxs-lookup"><span data-stu-id="f0e28-197">Support the WriteWarning, WriteVerbose, and WriteDebug Methods</span></span>

<span data-ttu-id="f0e28-198">Um cmdlet deve chamar o método [System. Management. Automation. cmdlet. WriteWarning](/dotnet/api/System.Management.Automation.Cmdlet.WriteWarning) quando o cmdlet está prestes a executar uma operação que pode ter um resultado indesejado.</span><span class="sxs-lookup"><span data-stu-id="f0e28-198">A cmdlet should call the [System.Management.Automation.Cmdlet.WriteWarning](/dotnet/api/System.Management.Automation.Cmdlet.WriteWarning) method when the cmdlet is about to perform an operation that might have an unintended result.</span></span> <span data-ttu-id="f0e28-199">Por exemplo, um cmdlet deve chamar esse método se o cmdlet estiver prestes a substituir um arquivo somente leitura.</span><span class="sxs-lookup"><span data-stu-id="f0e28-199">For example, a cmdlet should call this method if the cmdlet is about to overwrite a read-only file.</span></span>

<span data-ttu-id="f0e28-200">Um cmdlet deve chamar o método [System. Management. Automation. cmdlet. WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) quando o usuário precisar de detalhes sobre o que o cmdlet está fazendo.</span><span class="sxs-lookup"><span data-stu-id="f0e28-200">A cmdlet should call the [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) method when the user requires some detail about what the cmdlet is doing.</span></span> <span data-ttu-id="f0e28-201">Por exemplo, um cmdlet deve chamar essas informações se o autor do cmdlet sentir que há cenários que podem exigir mais informações sobre o que o cmdlet está fazendo.</span><span class="sxs-lookup"><span data-stu-id="f0e28-201">For example, a cmdlet should call this information if the cmdlet author feels that there are scenarios that might require more information about what the cmdlet is doing.</span></span>

<span data-ttu-id="f0e28-202">O cmdlet deve chamar o método [System. Management. Automation. cmdlet. WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) quando um engenheiro de suporte a produtos ou desenvolvedores precisar entender o que corrompeu a operação de cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e28-202">The cmdlet should call the [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) method when a developer or product support engineer must understand what has corrupted the cmdlet operation.</span></span> <span data-ttu-id="f0e28-203">Não é necessário que o cmdlet chame o método [System. Management. Automation. cmdlet. WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) no mesmo código que chama o método [System. Management. Automation. cmdlet. WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) , pois o `Debug` parâmetro apresenta os dois conjuntos de informações.</span><span class="sxs-lookup"><span data-stu-id="f0e28-203">It is not necessary for the cmdlet to call the [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) method in the same code that calls the [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) method because the `Debug` parameter presents both sets of information.</span></span>

#### <a name="support-writeprogress-for-operations-that-take-a-long-time"></a><span data-ttu-id="f0e28-204">Suporte a WriteProgress para operações que levam muito tempo</span><span class="sxs-lookup"><span data-stu-id="f0e28-204">Support WriteProgress for Operations that take a Long Time</span></span>

<span data-ttu-id="f0e28-205">Operações de cmdlet que levam muito tempo para serem concluídas e que não podem ser executadas em segundo plano devem dar suporte a relatórios de progresso por meio de chamadas periódicas para o método [System. Management. Automation. cmdlet. WriteProgress](/dotnet/api/System.Management.Automation.Cmdlet.WriteProgress) .</span><span class="sxs-lookup"><span data-stu-id="f0e28-205">Cmdlet operations that take a long time to complete and that cannot run in the background should support progress reporting through periodic calls to the [System.Management.Automation.Cmdlet.WriteProgress](/dotnet/api/System.Management.Automation.Cmdlet.WriteProgress) method.</span></span>

#### <a name="use-the-host-interfaces"></a><span data-ttu-id="f0e28-206">Usar as interfaces de host</span><span class="sxs-lookup"><span data-stu-id="f0e28-206">Use the Host Interfaces</span></span>

<span data-ttu-id="f0e28-207">Ocasionalmente, um cmdlet deve se comunicar diretamente com o usuário em vez de usar as várias gravações ou os métodos com suporte na classe [System. Management. Automation. cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) .</span><span class="sxs-lookup"><span data-stu-id="f0e28-207">Occasionally, a cmdlet must communicate directly with the user instead of by using the various Write or Should methods supported by the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span> <span data-ttu-id="f0e28-208">Nesse caso, o cmdlet deve derivar da classe [System. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) e usar a propriedade [System. Management. Automation. PSCmdlet. host \*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) .</span><span class="sxs-lookup"><span data-stu-id="f0e28-208">In this case, the cmdlet should derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class and use the [System.Management.Automation.PSCmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) property.</span></span> <span data-ttu-id="f0e28-209">Essa propriedade dá suporte a diferentes níveis de tipo de comunicação, incluindo os tipos PromptForChoice, prompt e WriteLine/ReadLine.</span><span class="sxs-lookup"><span data-stu-id="f0e28-209">This property supports different levels of communication type, including the PromptForChoice, Prompt, and WriteLine/ReadLine types.</span></span> <span data-ttu-id="f0e28-210">No nível mais específico, ele também fornece maneiras de ler e gravar chaves individuais e lidar com buffers.</span><span class="sxs-lookup"><span data-stu-id="f0e28-210">At the most specific level, it also provides ways to read and write individual keys and to deal with buffers.</span></span>

<span data-ttu-id="f0e28-211">A menos que um cmdlet seja projetado especificamente para gerar uma GUI (interface gráfica do usuário), ele não deve ignorar o host usando a propriedade [System. Management. Automation. PSCmdlet. host \*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) .</span><span class="sxs-lookup"><span data-stu-id="f0e28-211">Unless a cmdlet is specifically designed to generate a graphical user interface (GUI), it should not bypass the host by using the [System.Management.Automation.PSCmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) property.</span></span> <span data-ttu-id="f0e28-212">Um exemplo de um cmdlet criado para gerar uma GUI é o cmdlet [Out-GridView](/powershell/module/Microsoft.PowerShell.Utility/Out-GridView) .</span><span class="sxs-lookup"><span data-stu-id="f0e28-212">An example of a cmdlet that is designed to generate a GUI is the [Out-GridView](/powershell/module/Microsoft.PowerShell.Utility/Out-GridView) cmdlet.</span></span>

> [!NOTE]
> <span data-ttu-id="f0e28-213">Os cmdlets não devem usar a API [System. console](/dotnet/api/System.Console) .</span><span class="sxs-lookup"><span data-stu-id="f0e28-213">Cmdlets should not use the [System.Console](/dotnet/api/System.Console) API.</span></span>

### <a name="create-a-cmdlet-help-file-sd05"></a><span data-ttu-id="f0e28-214">Criar um arquivo de ajuda de cmdlet (SD05)</span><span class="sxs-lookup"><span data-stu-id="f0e28-214">Create a Cmdlet Help File (SD05)</span></span>

<span data-ttu-id="f0e28-215">Para cada assembly de cmdlet, crie um arquivo de Help.xml que contém informações sobre o cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e28-215">For each cmdlet assembly, create a Help.xml file that contains information about the cmdlet.</span></span> <span data-ttu-id="f0e28-216">Essas informações incluem uma descrição do cmdlet, descrições dos parâmetros do cmdlet, exemplos de uso do cmdlet e muito mais.</span><span class="sxs-lookup"><span data-stu-id="f0e28-216">This information includes a description of the cmdlet, descriptions of the cmdlet's parameters, examples of the cmdlet's use, and more.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="f0e28-217">Diretrizes de código</span><span class="sxs-lookup"><span data-stu-id="f0e28-217">Code Guidelines</span></span>

<span data-ttu-id="f0e28-218">As diretrizes a seguir devem ser seguidas durante a codificação de cmdlets para garantir uma experiência de usuário consistente entre usar seus cmdlets e outros cmdlets.</span><span class="sxs-lookup"><span data-stu-id="f0e28-218">The following guidelines should be followed when coding cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="f0e28-219">Quando você encontrar uma diretriz de código que se aplica à sua situação, certifique-se de examinar as diretrizes de design para obter diretrizes semelhantes.</span><span class="sxs-lookup"><span data-stu-id="f0e28-219">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="coding-parameters-sc01"></a><span data-ttu-id="f0e28-220">Parâmetros de codificação (SC01)</span><span class="sxs-lookup"><span data-stu-id="f0e28-220">Coding Parameters (SC01)</span></span>

<span data-ttu-id="f0e28-221">Defina um parâmetro declarando uma propriedade pública da classe cmdlet que é decorada com o atributo **Parameter** .</span><span class="sxs-lookup"><span data-stu-id="f0e28-221">Define a parameter by declaring a public property of the cmdlet class that is decorated with the **Parameter** attribute.</span></span> <span data-ttu-id="f0e28-222">Os parâmetros não precisam ser membros estáticos da classe de .NET Framework derivada para o cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e28-222">Parameters do not have to be static members of the derived .NET Framework class for the cmdlet.</span></span> <span data-ttu-id="f0e28-223">Para obter mais informações sobre como declarar o atributo de **parâmetro** , consulte [declaração de atributo de parâmetro](./parameter-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="f0e28-223">For more information about how to declare the **Parameter** attribute, see [Parameter Attribute Declaration](./parameter-attribute-declaration.md).</span></span>

#### <a name="support-windows-powershell-paths"></a><span data-ttu-id="f0e28-224">Suporte a caminhos do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f0e28-224">Support Windows PowerShell Paths</span></span>

<span data-ttu-id="f0e28-225">O caminho do Windows PowerShell é o mecanismo para normalizar o acesso a namespaces.</span><span class="sxs-lookup"><span data-stu-id="f0e28-225">The Windows PowerShell path is the mechanism for normalizing access to namespaces.</span></span> <span data-ttu-id="f0e28-226">Quando você atribui um caminho do Windows PowerShell a um parâmetro no cmdlet, o usuário pode definir uma "unidade" personalizada que atue como um atalho para um caminho específico.</span><span class="sxs-lookup"><span data-stu-id="f0e28-226">When you assign a Windows PowerShell path to a parameter in the cmdlet, the user can define a custom "drive" that acts as a shortcut to a specific path.</span></span> <span data-ttu-id="f0e28-227">Quando um usuário designa tal unidade, os dados armazenados, como os dados no registro, podem ser usados de forma consistente.</span><span class="sxs-lookup"><span data-stu-id="f0e28-227">When a user designates such a drive, stored data, such as data in the Registry, can be used in a consistent way.</span></span>

<span data-ttu-id="f0e28-228">Se o cmdlet permitir que o usuário especifique um arquivo ou uma fonte de dados, ele deverá definir um parâmetro do tipo [System. String](/dotnet/api/System.String).</span><span class="sxs-lookup"><span data-stu-id="f0e28-228">If your cmdlet allows the user to specify a file or a data source, it should define a parameter of type [System.String](/dotnet/api/System.String).</span></span> <span data-ttu-id="f0e28-229">Se houver suporte para mais de uma unidade, o tipo deverá ser uma matriz.</span><span class="sxs-lookup"><span data-stu-id="f0e28-229">If more than one drive is supported, the type should be an array.</span></span> <span data-ttu-id="f0e28-230">O nome do parâmetro deve ser `Path` , com um alias de `PSPath` .</span><span class="sxs-lookup"><span data-stu-id="f0e28-230">The name of the parameter should be `Path`, with an alias of `PSPath`.</span></span>
<span data-ttu-id="f0e28-231">Além disso, o `Path` parâmetro deve dar suporte a caracteres curinga.</span><span class="sxs-lookup"><span data-stu-id="f0e28-231">Additionally, the `Path` parameter should support wildcard characters.</span></span> <span data-ttu-id="f0e28-232">Se o suporte para caracteres curinga não for necessário, defina um `LiteralPath` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f0e28-232">If support for wildcard characters is not required, define a `LiteralPath` parameter.</span></span>

<span data-ttu-id="f0e28-233">Se os dados que o cmdlet ler ou gravar tiverem que ser um arquivo, o cmdlet deverá aceitar a entrada de caminho do Windows PowerShell e o cmdlet deverá usar a propriedade [System. Management. Automation. SessionState. path](/dotnet/api/System.Management.Automation.SessionState.Path) para converter os caminhos do Windows PowerShell em caminhos que o sistema de arquivos reconhece.</span><span class="sxs-lookup"><span data-stu-id="f0e28-233">If the data that the cmdlet reads or writes has to be a file, the cmdlet should accept Windows PowerShell path input, and the cmdlet should use the [System.Management.Automation.Sessionstate.Path](/dotnet/api/System.Management.Automation.SessionState.Path) property to translate the Windows PowerShell paths into paths that the file system recognizes.</span></span> <span data-ttu-id="f0e28-234">Os mecanismos específicos incluem os seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="f0e28-234">The specific mechanisms include the following methods:</span></span>

- [<span data-ttu-id="f0e28-235">System. Management. Automation. PSCmdlet. GetResolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="f0e28-235">System.Management.Automation.PSCmdlet.GetResolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PSCmdlet.GetResolvedProviderPathFromPSPath)
- [<span data-ttu-id="f0e28-236">System. Management. Automation. PSCmdlet. GetUnresolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="f0e28-236">System.Management.Automation.PSCmdlet.GetUnresolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PSCmdlet.GetUnresolvedProviderPathFromPSPath)
- [<span data-ttu-id="f0e28-237">System. Management. Automation. PathIntrinsics. GetResolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="f0e28-237">System.Management.Automation.PathIntrinsics.GetResolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PathIntrinsics.GetResolvedProviderPathFromPSPath)
- [<span data-ttu-id="f0e28-238">System. Management. Automation. PathIntrinsics. GetUnresolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="f0e28-238">System.Management.Automation.PathIntrinsics.GetUnresolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PathIntrinsics.GetUnresolvedProviderPathFromPSPath)

<span data-ttu-id="f0e28-239">Se os dados que o cmdlet lê ou grava são apenas um conjunto de cadeias de caracteres em vez de um arquivo, o cmdlet deve usar as informações de conteúdo do provedor ( `Content` membro) para ler e gravar.</span><span class="sxs-lookup"><span data-stu-id="f0e28-239">If the data that the cmdlet reads or writes is only a set of strings instead of a file, the cmdlet should use the provider content information (`Content` member) to read and write.</span></span> <span data-ttu-id="f0e28-240">Essas informações são obtidas da propriedade [System. Management. Automation. Provider. cmdletprovider. invokeprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.InvokeProvider) .</span><span class="sxs-lookup"><span data-stu-id="f0e28-240">This information is obtained from the [System.Management.Automation.Provider.CmdletProvider.InvokeProvider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.InvokeProvider) property.</span></span> <span data-ttu-id="f0e28-241">Esses mecanismos permitem que outros armazenamentos de dados participem da leitura e gravação de dados.</span><span class="sxs-lookup"><span data-stu-id="f0e28-241">These mechanisms allow other data stores to participate in the reading and writing of data.</span></span>

#### <a name="support-wildcard-characters"></a><span data-ttu-id="f0e28-242">Suporte a caracteres curinga</span><span class="sxs-lookup"><span data-stu-id="f0e28-242">Support Wildcard Characters</span></span>

<span data-ttu-id="f0e28-243">Um cmdlet deve dar suporte A caracteres curinga, se possível.</span><span class="sxs-lookup"><span data-stu-id="f0e28-243">A cmdlet should support wildcard characters if possible.</span></span> <span data-ttu-id="f0e28-244">O suporte para caracteres curinga ocorre em muitos lugares em um cmdlet (especialmente quando um parâmetro usa uma cadeia de caracteres para identificar um objeto de um conjunto de objetos).</span><span class="sxs-lookup"><span data-stu-id="f0e28-244">Support for wildcard characters occurs in many places in a cmdlet (especially when a parameter takes a string to identify one object from a set of objects).</span></span> <span data-ttu-id="f0e28-245">Por exemplo, o cmdlet **Stop-proc** de exemplo do [tutorial StopProc](./stopproc-tutorial.md) define um `Name` parâmetro para manipular cadeias de caracteres que representam nomes de processo.</span><span class="sxs-lookup"><span data-stu-id="f0e28-245">For example, the sample **Stop-Proc** cmdlet from the [StopProc Tutorial](./stopproc-tutorial.md) defines a `Name` parameter to handle strings that represent process names.</span></span> <span data-ttu-id="f0e28-246">Esse parâmetro dá suporte a caracteres curinga para que o usuário possa especificar facilmente os processos a serem interrompidos.</span><span class="sxs-lookup"><span data-stu-id="f0e28-246">This parameter supports wildcard characters so that the user can easily specify the processes to stop.</span></span>

<span data-ttu-id="f0e28-247">Quando o suporte para caracteres curinga está disponível, uma operação de cmdlet geralmente produz uma matriz.</span><span class="sxs-lookup"><span data-stu-id="f0e28-247">When support for wildcard characters is available, a cmdlet operation usually produces an array.</span></span>
<span data-ttu-id="f0e28-248">Ocasionalmente, não faz sentido dar suporte a uma matriz porque o usuário pode usar apenas um único item por vez.</span><span class="sxs-lookup"><span data-stu-id="f0e28-248">Occasionally, it does not make sense to support an array because the user might use only a single item at a time.</span></span> <span data-ttu-id="f0e28-249">Por exemplo, o cmdlet [Set-Location](/powershell/module/Microsoft.PowerShell.Management/Set-Location) não precisa dar suporte a uma matriz porque o usuário está definindo apenas um único local.</span><span class="sxs-lookup"><span data-stu-id="f0e28-249">For example, the [Set-Location](/powershell/module/Microsoft.PowerShell.Management/Set-Location) cmdlet does not need to support an array because the user is setting only a single location.</span></span> <span data-ttu-id="f0e28-250">Nessa instância, o cmdlet ainda dá suporte a caracteres curinga, mas força a resolução para um único local.</span><span class="sxs-lookup"><span data-stu-id="f0e28-250">In this instance, the cmdlet still supports wildcard characters, but it forces resolution to a single location.</span></span>

<span data-ttu-id="f0e28-251">Para obter mais informações sobre padrões de caracteres curinga, consulte [suporte a caracteres curinga em parâmetros de cmdlet](./supporting-wildcard-characters-in-cmdlet-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="f0e28-251">For more information about wildcard-character patterns, see [Supporting Wildcard Characters in Cmdlet Parameters](./supporting-wildcard-characters-in-cmdlet-parameters.md).</span></span>

#### <a name="defining-objects"></a><span data-ttu-id="f0e28-252">Definindo objetos</span><span class="sxs-lookup"><span data-stu-id="f0e28-252">Defining Objects</span></span>

<span data-ttu-id="f0e28-253">Esta seção contém diretrizes para definir objetos para cmdlets e para estender objetos existentes.</span><span class="sxs-lookup"><span data-stu-id="f0e28-253">This section contains guidelines for defining objects for cmdlets and for extending existing objects.</span></span>

##### <a name="define-standard-members"></a><span data-ttu-id="f0e28-254">Definir membros padrão</span><span class="sxs-lookup"><span data-stu-id="f0e28-254">Define Standard Members</span></span>

<span data-ttu-id="f0e28-255">Defina membros padrão para estender um tipo de objeto em um arquivo XML de Types.ps1personalizado (use o arquivo XML do Windows PowerShell Types.ps1como um modelo).</span><span class="sxs-lookup"><span data-stu-id="f0e28-255">Define standard members to extend an object type in a custom Types.ps1xml file (use the Windows PowerShell Types.ps1xml file as a template).</span></span> <span data-ttu-id="f0e28-256">Os membros padrão são definidos por um nó com o nome PSStandardMembers.</span><span class="sxs-lookup"><span data-stu-id="f0e28-256">Standard members are defined by a node with the name PSStandardMembers.</span></span> <span data-ttu-id="f0e28-257">Essas definições permitem que outros cmdlets e o tempo de execução do Windows PowerShell funcionem com seu objeto de forma consistente.</span><span class="sxs-lookup"><span data-stu-id="f0e28-257">These definitions allow other cmdlets and the Windows PowerShell runtime to work with your object in a consistent way.</span></span>

##### <a name="define-objectmembers-to-be-used-as-parameters"></a><span data-ttu-id="f0e28-258">Definir objectmembers a serem usados como parâmetros</span><span class="sxs-lookup"><span data-stu-id="f0e28-258">Define ObjectMembers to Be Used as Parameters</span></span>

<span data-ttu-id="f0e28-259">Se você estiver criando um objeto para um cmdlet, certifique-se de que seus membros sejam mapeados diretamente para os parâmetros dos cmdlets que o usarão.</span><span class="sxs-lookup"><span data-stu-id="f0e28-259">If you are designing an object for a cmdlet, ensure that its members map directly to the parameters of the cmdlets that will use it.</span></span> <span data-ttu-id="f0e28-260">Esse mapeamento permite que o objeto seja enviado facilmente para o pipeline e seja passado de um cmdlet para outro.</span><span class="sxs-lookup"><span data-stu-id="f0e28-260">This mapping allows the object to be easily sent to the pipeline and to be passed from one cmdlet to another.</span></span>

<span data-ttu-id="f0e28-261">Objetos de .NET Framework preexistentes que são retornados por cmdlets geralmente não têm alguns membros importantes ou convenientes que são necessários para o desenvolvedor ou o usuário de script.</span><span class="sxs-lookup"><span data-stu-id="f0e28-261">Preexisting .NET Framework objects that are returned by cmdlets are frequently missing some important or convenient members that are needed by the script developer or user.</span></span> <span data-ttu-id="f0e28-262">Esses membros ausentes podem ser particularmente importantes para exibição e para criar os nomes de membro corretos para que o objeto possa ser passado corretamente para o pipeline.</span><span class="sxs-lookup"><span data-stu-id="f0e28-262">These missing members can be particularly important for display and for creating the correct member names so that the object can be correctly passed to the pipeline.</span></span> <span data-ttu-id="f0e28-263">Crie um arquivo XML Types.ps1personalizado para documentar esses membros necessários.</span><span class="sxs-lookup"><span data-stu-id="f0e28-263">Create a custom Types.ps1xml file to document these required members.</span></span> <span data-ttu-id="f0e28-264">Ao criar esse arquivo, recomendamos a seguinte convenção de nomenclatura: *<Your_Product_Name>*.Types.ps1XML.</span><span class="sxs-lookup"><span data-stu-id="f0e28-264">When you create this file, we recommend the following naming convention: *<Your_Product_Name>*.Types.ps1xml.</span></span>

<span data-ttu-id="f0e28-265">Por exemplo, você pode adicionar uma `Mode` propriedade de script ao tipo [System. IO. FileInfo](/dotnet/api/System.IO.FileInfo) para exibir os atributos de um arquivo mais claramente.</span><span class="sxs-lookup"><span data-stu-id="f0e28-265">For example, you could add a `Mode` script property to the [System.IO.FileInfo](/dotnet/api/System.IO.FileInfo) type to display the attributes of a file more clearly.</span></span> <span data-ttu-id="f0e28-266">Além disso, você pode adicionar uma `Count` propriedade de alias ao tipo [System. array](/dotnet/api/System.Array) para permitir o uso consistente desse nome de propriedade (em vez de `Length` ).</span><span class="sxs-lookup"><span data-stu-id="f0e28-266">Additionally, you could add a `Count` alias property to the [System.Array](/dotnet/api/System.Array) type to allow the consistent use of that property name (instead of `Length`).</span></span>

##### <a name="implement-the-icomparable-interface"></a><span data-ttu-id="f0e28-267">Implementar a interface IComparable</span><span class="sxs-lookup"><span data-stu-id="f0e28-267">Implement the IComparable Interface</span></span>

<span data-ttu-id="f0e28-268">Implemente uma interface [System. IComparable](/dotnet/api/System.IComparable) em todos os objetos de saída.</span><span class="sxs-lookup"><span data-stu-id="f0e28-268">Implement a [System.IComparable](/dotnet/api/System.IComparable) interface on all output objects.</span></span>
<span data-ttu-id="f0e28-269">Isso permite que os objetos de saída sejam facilmente canalizados para vários cmdlets de classificação e de análise.</span><span class="sxs-lookup"><span data-stu-id="f0e28-269">This allows the output objects to be easily piped to various sorting and analysis cmdlets.</span></span>

##### <a name="update-display-information"></a><span data-ttu-id="f0e28-270">Atualizar informações de exibição</span><span class="sxs-lookup"><span data-stu-id="f0e28-270">Update Display Information</span></span>

<span data-ttu-id="f0e28-271">Se a exibição de um objeto não fornecer os resultados esperados, crie um *\<YourProductName>* arquivo XML de.Format.ps1personalizado para esse objeto.</span><span class="sxs-lookup"><span data-stu-id="f0e28-271">If the display for an object does not provide the expected results, create a custom *\<YourProductName>*.Format.ps1xml file for that object.</span></span>

### <a name="support-well-defined-pipeline-input-sc02"></a><span data-ttu-id="f0e28-272">Suporte à entrada de pipeline bem definida (SC02)</span><span class="sxs-lookup"><span data-stu-id="f0e28-272">Support Well Defined Pipeline Input (SC02)</span></span>

#### <a name="implement-for-the-middle-of-a-pipeline"></a><span data-ttu-id="f0e28-273">Implementar para o meio de um pipeline</span><span class="sxs-lookup"><span data-stu-id="f0e28-273">Implement for the Middle of a Pipeline</span></span>

<span data-ttu-id="f0e28-274">Implemente um cmdlet supondo que ele será chamado do meio de um pipeline (ou seja, outros cmdlets produzirão sua entrada ou consumirão sua saída).</span><span class="sxs-lookup"><span data-stu-id="f0e28-274">Implement a cmdlet assuming that it will be called from the middle of a pipeline (that is, other cmdlets will produce its input or consume its output).</span></span> <span data-ttu-id="f0e28-275">Por exemplo, você pode pressupor que o `Get-Process` cmdlet, porque ele gera dados, é usado somente como o primeiro cmdlet em um pipeline.</span><span class="sxs-lookup"><span data-stu-id="f0e28-275">For example, you might assume that the `Get-Process` cmdlet, because it generates data, is used only as the first cmdlet in a pipeline.</span></span>
<span data-ttu-id="f0e28-276">No entanto, como esse cmdlet é projetado para o meio de um pipeline, esse cmdlet permite que os cmdlets ou dados anteriores no pipeline especifiquem os processos a serem recuperados.</span><span class="sxs-lookup"><span data-stu-id="f0e28-276">However, because this cmdlet is designed for the middle of a pipeline, this cmdlet allows previous cmdlets or data in the pipeline to specify the processes to retrieve.</span></span>

#### <a name="support-input-from-the-pipeline"></a><span data-ttu-id="f0e28-277">Suporte à entrada do pipeline</span><span class="sxs-lookup"><span data-stu-id="f0e28-277">Support Input from the Pipeline</span></span>

<span data-ttu-id="f0e28-278">Em cada conjunto de parâmetros para um cmdlet, inclua pelo menos um parâmetro que ofereça suporte à entrada do pipeline.</span><span class="sxs-lookup"><span data-stu-id="f0e28-278">In each parameter set for a cmdlet, include at least one parameter that supports input from the pipeline.</span></span> <span data-ttu-id="f0e28-279">O suporte para entrada de pipeline permite que o usuário recupere dados ou objetos, para enviá-los ao conjunto de parâmetros correto e para passar os resultados diretamente para um cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e28-279">Support for pipeline input allows the user to retrieve data or objects, to send them to the correct parameter set, and to pass the results directly to a cmdlet.</span></span>

<span data-ttu-id="f0e28-280">Um parâmetro aceita a entrada do pipeline se o atributo **Parameter** incluir a `ValueFromPipeline` palavra-chave, o `ValueFromPipelineByPropertyName` atributo keyword ou ambas as palavras-chave em sua declaração.</span><span class="sxs-lookup"><span data-stu-id="f0e28-280">A parameter accepts input from the pipeline if the **Parameter** attribute includes the `ValueFromPipeline` keyword, the `ValueFromPipelineByPropertyName` keyword attribute, or both keywords in its declaration.</span></span> <span data-ttu-id="f0e28-281">Se nenhum dos parâmetros em um conjunto de parâmetros oferecer suporte `ValueFromPipeline` às `ValueFromPipelineByPropertyName` palavras-chave ou, o cmdlet não poderá ser colocado de forma significativa após outro cmdlet, pois ignorará qualquer entrada de pipeline.</span><span class="sxs-lookup"><span data-stu-id="f0e28-281">If none of the parameters in a parameter set support the `ValueFromPipeline` or `ValueFromPipelineByPropertyName` keywords, the cmdlet cannot meaningfully be placed after another cmdlet because it will ignore any pipeline input.</span></span>

#### <a name="support-the-processrecord-method"></a><span data-ttu-id="f0e28-282">Suporte ao método ProcessRecord</span><span class="sxs-lookup"><span data-stu-id="f0e28-282">Support the ProcessRecord Method</span></span>

<span data-ttu-id="f0e28-283">Para aceitar todos os registros do cmdlet anterior no pipeline, o cmdlet deve implementar o método [System. Management. Automation. cmdlet. ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) .</span><span class="sxs-lookup"><span data-stu-id="f0e28-283">To accept all the records from the preceding cmdlet in the pipeline, your cmdlet must implement the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method.</span></span> <span data-ttu-id="f0e28-284">O Windows PowerShell chama esse método várias vezes, uma vez para cada registro enviado ao seu cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e28-284">Windows PowerShell calls this method multiple times, once for every record that is sent to your cmdlet.</span></span>

### <a name="write-single-records-to-the-pipeline-sc03"></a><span data-ttu-id="f0e28-285">Gravar registros únicos no pipeline (SC03)</span><span class="sxs-lookup"><span data-stu-id="f0e28-285">Write Single Records to the Pipeline (SC03)</span></span>

<span data-ttu-id="f0e28-286">Quando um cmdlet retorna objetos, o cmdlet deve gravar os objetos imediatamente conforme eles são gerados.</span><span class="sxs-lookup"><span data-stu-id="f0e28-286">When a cmdlet returns objects, the cmdlet should write the objects immediately as they are generated.</span></span> <span data-ttu-id="f0e28-287">O cmdlet não deve contê-los para armazená-los em uma matriz combinada.</span><span class="sxs-lookup"><span data-stu-id="f0e28-287">The cmdlet should not hold them in order to buffer them into a combined array.</span></span> <span data-ttu-id="f0e28-288">Os cmdlets que recebem os objetos como entrada serão capazes de processar, exibir ou processar e exibir os objetos de saída sem atraso.</span><span class="sxs-lookup"><span data-stu-id="f0e28-288">The cmdlets that receive the objects as input will then be able to process, display, or process and display the output objects without delay.</span></span> <span data-ttu-id="f0e28-289">Um cmdlet que gera objetos de saída um de cada vez deve chamar o método [System. Management. Automation. cmdlet. WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) .</span><span class="sxs-lookup"><span data-stu-id="f0e28-289">A cmdlet that generates output objects one at a time should call the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="f0e28-290">Um cmdlet que gera objetos de saída em lotes (por exemplo, porque uma API subjacente retorna uma matriz de objetos de saída) deve chamar o método [System. Management. Automation. cmdlet. WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) com seu segundo parâmetro definido como `true` .</span><span class="sxs-lookup"><span data-stu-id="f0e28-290">A cmdlet that generates output objects in batches (for example, because an underlying API returns an array of output objects) should call the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) Method with its second parameter set to `true`.</span></span>

### <a name="make-cmdlets-case-insensitive-and-case-preserving-sc04"></a><span data-ttu-id="f0e28-291">Tornar cmdlets Case-Insensitive e Case-Preserving (SC04)</span><span class="sxs-lookup"><span data-stu-id="f0e28-291">Make Cmdlets Case-Insensitive and Case-Preserving (SC04)</span></span>

<span data-ttu-id="f0e28-292">Por padrão, o próprio Windows PowerShell não diferencia maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="f0e28-292">By default, Windows PowerShell itself is case-insensitive.</span></span> <span data-ttu-id="f0e28-293">No entanto, como ele lida com muitos sistemas preexistentes, o Windows PowerShell preserva o caso para facilitar a operação e a compatibilidade.</span><span class="sxs-lookup"><span data-stu-id="f0e28-293">However, because it deals with many preexisting systems, Windows PowerShell does preserve case for ease of operation and compatibility.</span></span>
<span data-ttu-id="f0e28-294">Em outras palavras, se um caractere for fornecido em letras maiúsculas, o Windows PowerShell o manterá em letras maiúsculas.</span><span class="sxs-lookup"><span data-stu-id="f0e28-294">In other words, if a character is supplied in uppercase letters, Windows PowerShell keeps it in uppercase letters.</span></span> <span data-ttu-id="f0e28-295">Para que os sistemas funcionem bem, um cmdlet precisa seguir essa convenção.</span><span class="sxs-lookup"><span data-stu-id="f0e28-295">For systems to work well, a cmdlet needs to follow this convention.</span></span> <span data-ttu-id="f0e28-296">Se possível, ele deve operar de forma não diferencia maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="f0e28-296">If possible, it should operate in a case-insensitive way.</span></span> <span data-ttu-id="f0e28-297">No entanto, ele deve preservar o caso original para cmdlets que ocorrem posteriormente em um comando ou no pipeline.</span><span class="sxs-lookup"><span data-stu-id="f0e28-297">It should, however, preserve the original case for cmdlets that occur later in a command or in the pipeline.</span></span>

## <a name="see-also"></a><span data-ttu-id="f0e28-298">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="f0e28-298">See Also</span></span>

[<span data-ttu-id="f0e28-299">Diretrizes para desenvolvimento necessárias</span><span class="sxs-lookup"><span data-stu-id="f0e28-299">Required Development Guidelines</span></span>](./required-development-guidelines.md)

[<span data-ttu-id="f0e28-300">Diretrizes para desenvolvimento de consultoria</span><span class="sxs-lookup"><span data-stu-id="f0e28-300">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

<span data-ttu-id="f0e28-301">[Writing a Windows PowerShell Cmdlet](./writing-a-windows-powershell-cmdlet.md) (Escrevendo um Cmdlet do Windows PowerShell)</span><span class="sxs-lookup"><span data-stu-id="f0e28-301">[Writing a Windows PowerShell Cmdlet](./writing-a-windows-powershell-cmdlet.md)</span></span>
