---
title: Visão geral do cmdlet
ms.date: 06/11/2020
ms.openlocfilehash: 576df03f35dff80479d1fce18cf4306c9219d42f
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/05/2020
ms.locfileid: "87784394"
---
# <a name="cmdlet-overview"></a><span data-ttu-id="031c2-102">Visão geral do cmdlet</span><span class="sxs-lookup"><span data-stu-id="031c2-102">Cmdlet Overview</span></span>

<span data-ttu-id="031c2-103">Um cmdlet é um comando leve que é usado no ambiente do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="031c2-103">A cmdlet is a lightweight command that is used in the PowerShell environment.</span></span> <span data-ttu-id="031c2-104">O tempo de execução do PowerShell invoca esses cmdlets dentro do contexto de scripts de automação que são fornecidos na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="031c2-104">The PowerShell runtime invokes these cmdlets within the context of automation scripts that are provided at the command line.</span></span> <span data-ttu-id="031c2-105">O tempo de execução do PowerShell também os chama programaticamente por meio de APIs do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="031c2-105">The PowerShell runtime also invokes them programmatically through PowerShell APIs.</span></span>

## <a name="cmdlets"></a><span data-ttu-id="031c2-106">Cmdlets</span><span class="sxs-lookup"><span data-stu-id="031c2-106">Cmdlets</span></span>

<span data-ttu-id="031c2-107">Os cmdlets executam uma ação e normalmente retornam um objeto Microsoft .NET para o próximo comando no pipeline.</span><span class="sxs-lookup"><span data-stu-id="031c2-107">Cmdlets perform an action and typically return a Microsoft .NET object to the next command in the pipeline.</span></span> <span data-ttu-id="031c2-108">Um cmdlet é um único comando que participa da semântica do pipeline do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="031c2-108">A cmdlet is a single command that participates in the pipeline semantics of PowerShell.</span></span>
<span data-ttu-id="031c2-109">Isso inclui cmdlets binários (C#), funções de script avançadas, CDXML e fluxos de trabalho.</span><span class="sxs-lookup"><span data-stu-id="031c2-109">This includes binary (C#) cmdlets, advanced script functions, CDXML, and Workflows.</span></span>

<span data-ttu-id="031c2-110">Esta documentação do SDK descreve como criar cmdlets binários escritos em C#.</span><span class="sxs-lookup"><span data-stu-id="031c2-110">This SDK documentation describes how to create binary cmdlets written in C#.</span></span> <span data-ttu-id="031c2-111">Para obter informações sobre cmdlets baseados em script, consulte:</span><span class="sxs-lookup"><span data-stu-id="031c2-111">For information about script-based cmdlets, see:</span></span>

- [<span data-ttu-id="031c2-112">about_Functions_Advanced</span><span class="sxs-lookup"><span data-stu-id="031c2-112">about_Functions_Advanced</span></span>](/powershell/module/microsoft.powershell.core/about/about_functions_advanced)
- [<span data-ttu-id="031c2-113">about_Functions_CmdletBindingAttribute</span><span class="sxs-lookup"><span data-stu-id="031c2-113">about_Functions_CmdletBindingAttribute</span></span>](/powershell/module/microsoft.powershell.core/about/about_functions_cmdletbindingattribute)
- [<span data-ttu-id="031c2-114">about_Functions_Advanced_Methods</span><span class="sxs-lookup"><span data-stu-id="031c2-114">about_Functions_Advanced_Methods</span></span>](/powershell/module/microsoft.powershell.core/about/about_functions_advanced_methods)

<span data-ttu-id="031c2-115">Para criar um cmdlet binário, você deve implementar uma classe de cmdlet que derive de uma das duas classes base de cmdlet especializadas.</span><span class="sxs-lookup"><span data-stu-id="031c2-115">To create a binary cmdlet, you must implement a cmdlet class that derives from one of two specialized cmdlet base classes.</span></span> <span data-ttu-id="031c2-116">A classe derivada deve:</span><span class="sxs-lookup"><span data-stu-id="031c2-116">The derived class must:</span></span>

- <span data-ttu-id="031c2-117">Declare um atributo que identifique a classe derivada como um cmdlet.</span><span class="sxs-lookup"><span data-stu-id="031c2-117">Declare an attribute that identifies the derived class as a cmdlet.</span></span>
- <span data-ttu-id="031c2-118">Defina propriedades públicas que são decoradas com atributos que identificam as propriedades públicas como parâmetros de cmdlet.</span><span class="sxs-lookup"><span data-stu-id="031c2-118">Define public properties that are decorated with attributes that identify the public properties as cmdlet parameters.</span></span>
- <span data-ttu-id="031c2-119">Substitua um ou mais métodos de processamento de entrada para processar registros.</span><span class="sxs-lookup"><span data-stu-id="031c2-119">Override one or more of the input processing methods to process records.</span></span>

<span data-ttu-id="031c2-120">Você pode carregar o assembly que contém a classe diretamente usando o cmdlet [Import-Module](/powershell/module/microsoft.powershell.core/import-module) ou pode criar um aplicativo host que carrega o assembly usando a API [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) .</span><span class="sxs-lookup"><span data-stu-id="031c2-120">You can load the assembly that contains the class directly by using the [Import-Module](/powershell/module/microsoft.powershell.core/import-module) cmdlet, or you can create a host application that loads the assembly by using the [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API.</span></span> <span data-ttu-id="031c2-121">Os dois métodos fornecem acesso programático e de linha de comando à funcionalidade do cmdlet.</span><span class="sxs-lookup"><span data-stu-id="031c2-121">Both methods provide programmatic and command-line access to the functionality of the cmdlet.</span></span>

## <a name="cmdlet-terms"></a><span data-ttu-id="031c2-122">Termos do cmdlet</span><span class="sxs-lookup"><span data-stu-id="031c2-122">Cmdlet Terms</span></span>

<span data-ttu-id="031c2-123">Os termos a seguir são usados com frequência na documentação do cmdlet do PowerShell:</span><span class="sxs-lookup"><span data-stu-id="031c2-123">The following terms are used frequently in the PowerShell cmdlet documentation:</span></span>

### <a name="cmdlet-attribute"></a><span data-ttu-id="031c2-124">Atributo de cmdlet</span><span class="sxs-lookup"><span data-stu-id="031c2-124">Cmdlet attribute</span></span>

<span data-ttu-id="031c2-125">Um atributo do .NET que é usado para declarar uma classe de cmdlet como um cmdlet.</span><span class="sxs-lookup"><span data-stu-id="031c2-125">A .NET attribute that is used to declare a cmdlet class as a cmdlet.</span></span> <span data-ttu-id="031c2-126">Embora o PowerShell use vários outros atributos opcionais, o atributo cmdlet é necessário.</span><span class="sxs-lookup"><span data-stu-id="031c2-126">Although PowerShell uses several other attributes that are optional, the Cmdlet attribute is required.</span></span> <span data-ttu-id="031c2-127">Para obter mais informações sobre esse atributo, consulte [declaração de atributo de cmdlet](cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="031c2-127">For more information about this attribute, see [Cmdlet Attribute Declaration](cmdlet-attribute-declaration.md).</span></span>

### <a name="cmdlet-parameter"></a><span data-ttu-id="031c2-128">Parâmetro de cmdlet</span><span class="sxs-lookup"><span data-stu-id="031c2-128">Cmdlet parameter</span></span>

<span data-ttu-id="031c2-129">As propriedades públicas que definem os parâmetros que estão disponíveis para o usuário ou para o aplicativo que está executando o cmdlet.</span><span class="sxs-lookup"><span data-stu-id="031c2-129">The public properties that define the parameters that are available to the user or to the application that is running the cmdlet.</span></span> <span data-ttu-id="031c2-130">Os cmdlets podem ter parâmetros obrigatórios, nomeados, posicionais e de *comutação* .</span><span class="sxs-lookup"><span data-stu-id="031c2-130">Cmdlets can have required, named, positional, and *switch* parameters.</span></span> <span data-ttu-id="031c2-131">Parâmetros de opção permitem definir parâmetros que serão avaliados somente se os parâmetros forem especificados na chamada.</span><span class="sxs-lookup"><span data-stu-id="031c2-131">Switch parameters allow you to define parameters that are evaluated only if the parameters are specified in the call.</span></span> <span data-ttu-id="031c2-132">Para obter mais informações sobre os diferentes tipos de parâmetros, consulte [cmdlet Parameters](cmdlet-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="031c2-132">For more information about the different types of parameters, see [Cmdlet Parameters](cmdlet-parameters.md).</span></span>

### <a name="parameter-set"></a><span data-ttu-id="031c2-133">Conjunto de Parâmetros</span><span class="sxs-lookup"><span data-stu-id="031c2-133">Parameter set</span></span>

<span data-ttu-id="031c2-134">Um grupo de parâmetros que podem ser usados no mesmo comando para executar uma ação específica.</span><span class="sxs-lookup"><span data-stu-id="031c2-134">A group of parameters that can be used in the same command to perform a specific action.</span></span> <span data-ttu-id="031c2-135">Um cmdlet pode ter vários conjuntos de parâmetros, mas cada conjunto de parâmetros deve ter pelo menos um parâmetro exclusivo.</span><span class="sxs-lookup"><span data-stu-id="031c2-135">A cmdlet can have multiple parameter sets, but each parameter set must have at least one parameter that is unique.</span></span> <span data-ttu-id="031c2-136">Um bom design de cmdlet sugere fortemente que o parâmetro exclusivo também seja um parâmetro necessário.</span><span class="sxs-lookup"><span data-stu-id="031c2-136">Good cmdlet design strongly suggests that the unique parameter also be a required parameter.</span></span>
<span data-ttu-id="031c2-137">Para obter mais informações sobre conjuntos de parâmetros, consulte [conjuntos de parâmetros de cmdlet](cmdlet-parameter-sets.md).</span><span class="sxs-lookup"><span data-stu-id="031c2-137">For more information about parameter sets, see [Cmdlet Parameter Sets](cmdlet-parameter-sets.md).</span></span>

### <a name="dynamic-parameter"></a><span data-ttu-id="031c2-138">Parâmetro dinâmico</span><span class="sxs-lookup"><span data-stu-id="031c2-138">Dynamic parameter</span></span>

<span data-ttu-id="031c2-139">Um parâmetro que é adicionado ao cmdlet em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="031c2-139">A parameter that is added to the cmdlet at runtime.</span></span> <span data-ttu-id="031c2-140">Normalmente, os parâmetros dinâmicos são adicionados ao cmdlet quando outro parâmetro é definido como um valor específico.</span><span class="sxs-lookup"><span data-stu-id="031c2-140">Typically, the dynamic parameters are added to the cmdlet when another parameter is set to a specific value.</span></span> <span data-ttu-id="031c2-141">Para obter mais informações sobre parâmetros dinâmicos, consulte [parâmetros dinâmicos de cmdlet](cmdlet-dynamic-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="031c2-141">For more information about dynamic parameters, see [Cmdlet Dynamic Parameters](cmdlet-dynamic-parameters.md).</span></span>

### <a name="input-processing-methods"></a><span data-ttu-id="031c2-142">Métodos de processamento de entrada</span><span class="sxs-lookup"><span data-stu-id="031c2-142">Input processing methods</span></span>

<span data-ttu-id="031c2-143">A classe [System. Management. Automation. cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) fornece os métodos virtuais a seguir que são usados para processar registros.</span><span class="sxs-lookup"><span data-stu-id="031c2-143">The [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class provides the following virtual methods that are used to process records.</span></span> <span data-ttu-id="031c2-144">Todas as classes de cmdlet derivadas devem substituir um ou mais dos três primeiros métodos:</span><span class="sxs-lookup"><span data-stu-id="031c2-144">All the derived cmdlet classes must override one or more of the first three methods:</span></span>

- <span data-ttu-id="031c2-145">[System. Management. Automation. cmdlet. BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing): usado para fornecer uma funcionalidade de pré-processamento única e opcional para o cmdlet.</span><span class="sxs-lookup"><span data-stu-id="031c2-145">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing): Used to provide optional one-time, pre-processing functionality for the cmdlet.</span></span>
- <span data-ttu-id="031c2-146">[System. Management. Automation. cmdlet. ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord): usado para fornecer a funcionalidade de processamento de registro por registro para o cmdlet.</span><span class="sxs-lookup"><span data-stu-id="031c2-146">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord): Used to provide record-by-record processing functionality for the cmdlet.</span></span> <span data-ttu-id="031c2-147">O método [System. Management. Automation. cmdlet. ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) pode ser chamado qualquer número de vezes, ou não, dependendo da entrada do cmdlet.</span><span class="sxs-lookup"><span data-stu-id="031c2-147">The [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method might be called any number of times, or not at all, depending on the input of the cmdlet.</span></span>
- <span data-ttu-id="031c2-148">[System. Management. Automation. cmdlet. Noprocessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing): usado para fornecer uma funcionalidade de pós-processamento única opcional para o cmdlet.</span><span class="sxs-lookup"><span data-stu-id="031c2-148">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing): Used to provide optional one-time, post-processing functionality for the cmdlet.</span></span>
- <span data-ttu-id="031c2-149">[System. Management. Automation. cmdlet. StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing): usado para interromper o processamento quando o usuário interrompe o cmdlet de forma assíncrona (por exemplo, pressionando <kbd>Ctrl</kbd> + <kbd>C</kbd>).</span><span class="sxs-lookup"><span data-stu-id="031c2-149">[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing): Used to stop processing when the user stops the cmdlet asynchronously (for example, by pressing <kbd>CTRL</kbd>+<kbd>C</kbd>).</span></span>

<span data-ttu-id="031c2-150">Para obter mais informações sobre esses métodos, consulte [métodos de processamento de entrada de cmdlet](./cmdlet-input-processing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="031c2-150">For more information about these methods, see [Cmdlet Input Processing Methods](./cmdlet-input-processing-methods.md).</span></span>

<span data-ttu-id="031c2-151">Ao implementar um cmdlet, você deve substituir pelo menos um desses métodos de processamento de entrada.</span><span class="sxs-lookup"><span data-stu-id="031c2-151">When you implement a cmdlet, you must override at least one of these input processing methods.</span></span>
<span data-ttu-id="031c2-152">Normalmente, o **ProcessRecord ()** é o método que você substitui porque ele é chamado para cada registro que o cmdlet processa.</span><span class="sxs-lookup"><span data-stu-id="031c2-152">Typically, the **ProcessRecord()** is the method that you override because it is called for every record that the cmdlet processes.</span></span> <span data-ttu-id="031c2-153">Por outro lado, o método **BeginProcessing ()** e o método **endprocessor ()** são chamados uma vez para executar o pré-processamento ou o pós-processamento dos registros.</span><span class="sxs-lookup"><span data-stu-id="031c2-153">In contrast, the **BeginProcessing()** method and the **EndProcessing()** method are called one time to perform pre-processing or post-processing of the records.</span></span> <span data-ttu-id="031c2-154">Para obter mais informações sobre esses métodos, consulte [métodos de processamento de entrada](cmdlet-input-processing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="031c2-154">For more information about these methods, see [Input Processing Methods](cmdlet-input-processing-methods.md).</span></span>

### <a name="shouldprocess-feature"></a><span data-ttu-id="031c2-155">Recurso ShouldProcess</span><span class="sxs-lookup"><span data-stu-id="031c2-155">ShouldProcess feature</span></span>

<span data-ttu-id="031c2-156">O PowerShell permite que você crie cmdlets que solicitam ao usuário comentários antes que o cmdlet faça uma alteração no sistema.</span><span class="sxs-lookup"><span data-stu-id="031c2-156">PowerShell allows you to create cmdlets that prompt the user for feedback before the cmdlet makes a change to the system.</span></span> <span data-ttu-id="031c2-157">Para usar esse recurso, o cmdlet deve declarar que oferece suporte ao `ShouldProcess` recurso quando você declara o atributo cmdlet, e o cmdlet deve chamar os métodos [System. Management. Automation. cmdlet. ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) e [System. Management. Automation. cmdlet. ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) de dentro de um método de processamento de entrada.</span><span class="sxs-lookup"><span data-stu-id="031c2-157">To use this feature, the cmdlet must declare that it supports the `ShouldProcess` feature when you declare the Cmdlet attribute, and the cmdlet must call the [System.Management.Automation.Cmdlet.ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) and [System.Management.Automation.Cmdlet.ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) methods from within an input processing method.</span></span> <span data-ttu-id="031c2-158">Para obter mais informações sobre como dar suporte à `ShouldProcess` funcionalidade, consulte [solicitando confirmação](requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="031c2-158">For more information about how to support the `ShouldProcess` functionality, see [Requesting Confirmation](requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="transaction"></a><span data-ttu-id="031c2-159">Transação</span><span class="sxs-lookup"><span data-stu-id="031c2-159">Transaction</span></span>

<span data-ttu-id="031c2-160">Um grupo lógico de comandos que são tratados como uma única tarefa.</span><span class="sxs-lookup"><span data-stu-id="031c2-160">A logical group of commands that are treated as a single task.</span></span> <span data-ttu-id="031c2-161">A tarefa falhará automaticamente se algum comando no grupo falhar e o usuário tiver a opção de aceitar ou rejeitar as ações executadas na transação.</span><span class="sxs-lookup"><span data-stu-id="031c2-161">The task automatically fails if any command in the group fails, and the user has the choice to accept or reject the actions performed within the transaction.</span></span> <span data-ttu-id="031c2-162">Para participar de uma transação, o cmdlet deve declarar que oferece suporte a transações quando o atributo de cmdlet é declarado.</span><span class="sxs-lookup"><span data-stu-id="031c2-162">To participate in a transaction, the cmdlet must declare that it supports transactions when the Cmdlet attribute is declared.</span></span> <span data-ttu-id="031c2-163">O suporte para transações foi introduzido no Windows PowerShell 2,0.</span><span class="sxs-lookup"><span data-stu-id="031c2-163">Support for transactions was introduced in Windows PowerShell 2.0.</span></span> <span data-ttu-id="031c2-164">Para obter mais informações sobre transações, consulte [como dar suporte a transações](how-to-support-transactions.md).</span><span class="sxs-lookup"><span data-stu-id="031c2-164">For more information about transactions, see [How to Support Transactions](how-to-support-transactions.md).</span></span>

## <a name="how-cmdlets-differ-from-commands"></a><span data-ttu-id="031c2-165">Como os cmdlets diferem dos comandos</span><span class="sxs-lookup"><span data-stu-id="031c2-165">How Cmdlets Differ from Commands</span></span>

<span data-ttu-id="031c2-166">Os cmdlets diferem dos comandos em outros ambientes de Shell de comando das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="031c2-166">Cmdlets differ from commands in other command-shell environments in the following ways:</span></span>

- <span data-ttu-id="031c2-167">Os cmdlets são instâncias de classes .NET; Eles não são executáveis autônomos.</span><span class="sxs-lookup"><span data-stu-id="031c2-167">Cmdlets are instances of .NET classes; they are not stand-alone executables.</span></span>
- <span data-ttu-id="031c2-168">Os cmdlets podem ser criados a partir de apenas uma dúzia de linhas de código.</span><span class="sxs-lookup"><span data-stu-id="031c2-168">Cmdlets can be created from as few as a dozen lines of code.</span></span>
- <span data-ttu-id="031c2-169">Os cmdlets geralmente não realizam sua própria análise, apresentação de erro ou formatação de saída.</span><span class="sxs-lookup"><span data-stu-id="031c2-169">Cmdlets do not generally do their own parsing, error presentation, or output formatting.</span></span> <span data-ttu-id="031c2-170">A análise, a apresentação de erros e a formatação de saída são manipuladas pelo tempo de execução do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="031c2-170">Parsing, error presentation, and output formatting are handled by the PowerShell runtime.</span></span>
- <span data-ttu-id="031c2-171">Os cmdlets processam objetos de entrada do pipeline em vez de fluxos de texto, e os cmdlets normalmente entregam objetos como saída para o pipeline.</span><span class="sxs-lookup"><span data-stu-id="031c2-171">Cmdlets process input objects from the pipeline rather than from streams of text, and cmdlets typically deliver objects as output to the pipeline.</span></span>
- <span data-ttu-id="031c2-172">Os cmdlets são orientados a registros porque processam um único objeto de cada vez.</span><span class="sxs-lookup"><span data-stu-id="031c2-172">Cmdlets are record-oriented because they process a single object at a time.</span></span>

## <a name="cmdlet-base-classes"></a><span data-ttu-id="031c2-173">Classes base de cmdlet</span><span class="sxs-lookup"><span data-stu-id="031c2-173">Cmdlet Base Classes</span></span>

<span data-ttu-id="031c2-174">O Windows PowerShell dá suporte a cmdlets que são derivados das duas classes base a seguir.</span><span class="sxs-lookup"><span data-stu-id="031c2-174">Windows PowerShell supports cmdlets that are derived from the following two base classes.</span></span>

- <span data-ttu-id="031c2-175">A maioria dos cmdlets baseia-se em classes .NET que derivam da classe base [System. Management. Automation. cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) .</span><span class="sxs-lookup"><span data-stu-id="031c2-175">Most cmdlets are based on .NET classes that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) base class.</span></span>
  <span data-ttu-id="031c2-176">A derivação dessa classe permite que um cmdlet Use o conjunto mínimo de dependências no tempo de execução do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="031c2-176">Deriving from this class allows a cmdlet to use the minimum set of dependencies on the Windows PowerShell runtime.</span></span> <span data-ttu-id="031c2-177">Isso oferece dois benefícios.</span><span class="sxs-lookup"><span data-stu-id="031c2-177">This has two benefits.</span></span> <span data-ttu-id="031c2-178">O primeiro benefício é que os objetos de cmdlet são menores e é menos provável que você seja afetado por alterações no tempo de execução do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="031c2-178">The first benefit is that the cmdlet objects are smaller, and you are less likely to be affected by changes to the PowerShell runtime.</span></span> <span data-ttu-id="031c2-179">O segundo benefício é que, se necessário, você pode criar diretamente uma instância do objeto cmdlet e, em seguida, chamá-lo diretamente em vez de chamá-lo por meio do tempo de execução do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="031c2-179">The second benefit is that, if you have to, you can directly create an instance of the cmdlet object and then invoke it directly instead of invoking it through the PowerShell runtime.</span></span>

- <span data-ttu-id="031c2-180">Os cmdlets mais complexos se baseiam em classes .NET que derivam da classe base [System. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) .</span><span class="sxs-lookup"><span data-stu-id="031c2-180">The more-complex cmdlets are based on .NET classes that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="031c2-181">A derivação dessa classe oferece muito mais acesso ao tempo de execução do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="031c2-181">Deriving from this class gives you much more access to the PowerShell runtime.</span></span> <span data-ttu-id="031c2-182">Esse acesso permite que o cmdlet chame scripts, acesse provedores e acesse o estado de sessão atual.</span><span class="sxs-lookup"><span data-stu-id="031c2-182">This access allows your cmdlet to call scripts, to access providers, and to access the current session state.</span></span>
  <span data-ttu-id="031c2-183">(Para acessar o estado de sessão atual, você obtém e define as preferências e variáveis de sessão.) No entanto, derivar dessa classe aumenta o tamanho do objeto cmdlet e significa que seu cmdlet está intimamente acoplado à versão atual do tempo de execução do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="031c2-183">(To access the current session state, you get and set session variables and preferences.) However, deriving from this class increases the size of the cmdlet object, and it means that your cmdlet is more tightly coupled to the current version of the PowerShell runtime.</span></span>

<span data-ttu-id="031c2-184">Em geral, a menos que você precise do acesso estendido ao tempo de execução do PowerShell, você deve derivar da classe [System. Management. Automation. cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) .</span><span class="sxs-lookup"><span data-stu-id="031c2-184">In general, unless you need the extended access to the PowerShell runtime, you should derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span>
<span data-ttu-id="031c2-185">No entanto, o tempo de execução do PowerShell tem recursos de log extensivos para a execução de cmdlets.</span><span class="sxs-lookup"><span data-stu-id="031c2-185">However, the PowerShell runtime has extensive logging capabilities for the execution of cmdlets.</span></span> <span data-ttu-id="031c2-186">Se o modelo de auditoria depender desse log, você poderá impedir a execução do cmdlet de dentro de outro cmdlet derivando da classe [System. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) .</span><span class="sxs-lookup"><span data-stu-id="031c2-186">If your auditing model depends on this logging, you can prevent the execution of your cmdlet from within another cmdlet by deriving from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class.</span></span>

## <a name="cmdlet-attributes"></a><span data-ttu-id="031c2-187">Atributos de cmdlet</span><span class="sxs-lookup"><span data-stu-id="031c2-187">Cmdlet Attributes</span></span>

<span data-ttu-id="031c2-188">O PowerShell define vários atributos .NET que são usados para gerenciar cmdlets e especificar funcionalidades comuns que são fornecidas pelo PowerShell e que podem ser exigidas pelo cmdlet.</span><span class="sxs-lookup"><span data-stu-id="031c2-188">PowerShell defines several .NET attributes that are used to manage cmdlets and to specify common functionality that is provided by PowerShell and that might be required by the cmdlet.</span></span> <span data-ttu-id="031c2-189">Por exemplo, os atributos são usados para designar uma classe como um cmdlet, especificar os parâmetros do cmdlet e solicitar a validação de entrada para que os desenvolvedores de cmdlets não precisem implementar essa funcionalidade em seu código de cmdlet.</span><span class="sxs-lookup"><span data-stu-id="031c2-189">For example, attributes are used to designate a class as a cmdlet, to specify the parameters of the cmdlet, and to request the validation of input so that cmdlet developers do not have to implement that functionality in their cmdlet code.</span></span> <span data-ttu-id="031c2-190">Para obter mais informações sobre atributos, consulte [atributos do PowerShell](./cmdlet-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="031c2-190">For more information about attributes, see [PowerShell Attributes](./cmdlet-attributes.md).</span></span>

## <a name="cmdlet-names"></a><span data-ttu-id="031c2-191">Nomes dos cmdlets</span><span class="sxs-lookup"><span data-stu-id="031c2-191">Cmdlet Names</span></span>

<span data-ttu-id="031c2-192">O PowerShell usa um par de nomes verbo-and-substantivo para nomear cmdlets.</span><span class="sxs-lookup"><span data-stu-id="031c2-192">PowerShell uses a verb-and-noun name pair to name cmdlets.</span></span> <span data-ttu-id="031c2-193">Por exemplo, o `Get-Command` cmdlet incluído no PowerShell é usado para obter todos os cmdlets registrados no Shell de comando.</span><span class="sxs-lookup"><span data-stu-id="031c2-193">For example, the `Get-Command` cmdlet included in PowerShell is used to get all the cmdlets that are registered in the command shell.</span></span> <span data-ttu-id="031c2-194">O verbo identifica a ação que o cmdlet executa e o substantivo identifica o recurso no qual o cmdlet executa sua ação.</span><span class="sxs-lookup"><span data-stu-id="031c2-194">The verb identifies the action that the cmdlet performs, and the noun identifies the resource on which the cmdlet performs its action.</span></span>

<span data-ttu-id="031c2-195">Esses nomes são especificados quando a classe .NET é declarada como um cmdlet.</span><span class="sxs-lookup"><span data-stu-id="031c2-195">These names are specified when the .NET class is declared as a cmdlet.</span></span> <span data-ttu-id="031c2-196">Para obter mais informações sobre como declarar uma classe .NET como um cmdlet, consulte [declaração de atributo de cmdlet](./cmdlet-class-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="031c2-196">For more information about how to declare a .NET class as a cmdlet, see [Cmdlet Attribute Declaration](./cmdlet-class-declaration.md).</span></span>

## <a name="writing-cmdlet-code"></a><span data-ttu-id="031c2-197">Escrevendo código de cmdlet</span><span class="sxs-lookup"><span data-stu-id="031c2-197">Writing Cmdlet Code</span></span>

<span data-ttu-id="031c2-198">Este documento fornece duas maneiras de descobrir como o código de cmdlet é escrito.</span><span class="sxs-lookup"><span data-stu-id="031c2-198">This document provides two ways to discover how cmdlet code is written.</span></span> <span data-ttu-id="031c2-199">Se você preferir ver o código sem muita explicação, consulte [exemplos de código de cmdlet](./examples-of-cmdlet-code.md).</span><span class="sxs-lookup"><span data-stu-id="031c2-199">If you prefer to see the code without much explanation, see [Examples of Cmdlet Code](./examples-of-cmdlet-code.md).</span></span> <span data-ttu-id="031c2-200">Se você preferir mais explicações sobre o código, consulte os tópicos [tutorial do getproc](./getproc-tutorial.md), [tutorial do StopProc](./stopproc-tutorial.md)ou [tutorial do SelectStr](./selectstr-tutorial.md) .</span><span class="sxs-lookup"><span data-stu-id="031c2-200">If you prefer more explanation about the code, see the [GetProc Tutorial](./getproc-tutorial.md), [StopProc Tutorial](./stopproc-tutorial.md), or [SelectStr Tutorial](./selectstr-tutorial.md) topics.</span></span>

<span data-ttu-id="031c2-201">Para obter mais informações sobre as diretrizes para escrever cmdlets, consulte [diretrizes de desenvolvimento de cmdlet](./cmdlet-development-guidelines.md).</span><span class="sxs-lookup"><span data-stu-id="031c2-201">For more information about the guidelines for writing cmdlets, see [Cmdlet Development Guidelines](./cmdlet-development-guidelines.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="031c2-202">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="031c2-202">See Also</span></span>

[<span data-ttu-id="031c2-203">Conceitos de cmdlet do PowerShell</span><span class="sxs-lookup"><span data-stu-id="031c2-203">PowerShell Cmdlet Concepts</span></span>](./windows-powershell-cmdlet-concepts.md)

[<span data-ttu-id="031c2-204">Escrevendo um cmdlet do PowerShell</span><span class="sxs-lookup"><span data-stu-id="031c2-204">Writing a PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)

[<span data-ttu-id="031c2-205">SDK do PowerShell</span><span class="sxs-lookup"><span data-stu-id="031c2-205">PowerShell SDK</span></span>](../windows-powershell-reference.md)
