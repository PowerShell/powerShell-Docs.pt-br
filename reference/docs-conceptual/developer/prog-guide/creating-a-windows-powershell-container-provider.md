---
title: Criar um provedor de contêineres do Windows PowerShell
ms.date: 09/13/2016
ms.openlocfilehash: a5bcba425909eb98c010a1ea010cb02b995771f3
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/05/2020
ms.locfileid: "87787199"
---
# <a name="creating-a-windows-powershell-container-provider"></a><span data-ttu-id="2e1a7-102">Criar um provedor de contêineres do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2e1a7-102">Creating a Windows PowerShell Container Provider</span></span>

<span data-ttu-id="2e1a7-103">Este tópico descreve como criar um provedor do Windows PowerShell que pode funcionar em armazenamentos de dados de várias camadas.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-103">This topic describes how to create a Windows PowerShell provider that can work on multi-layer data stores.</span></span> <span data-ttu-id="2e1a7-104">Para esse tipo de armazenamento de dados, o nível superior do repositório contém os itens raiz e cada nível subsequente é referido como um nó de itens filho.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-104">For this type of data store, the top level of the store contains the root items and each subsequent level is referred to as a node of child items.</span></span> <span data-ttu-id="2e1a7-105">Ao permitir que o usuário trabalhe nesses nós filho, um usuário pode interagir hierarquicamente por meio do armazenamento de dados.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-105">By allowing the user to work on these child nodes, a user can interact hierarchically through the data store.</span></span>

<span data-ttu-id="2e1a7-106">Provedores que podem trabalhar em repositórios de dados de vários níveis são chamados de provedores de contêiner do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-106">Providers that can work on multi-level data stores are referred to as Windows PowerShell container providers.</span></span> <span data-ttu-id="2e1a7-107">No entanto, lembre-se de que um provedor de contêiner do Windows PowerShell pode ser usado somente quando há um contêiner (sem Contêineres aninhados) com itens.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-107">However, be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="2e1a7-108">Se houver Contêineres aninhados, você deverá implementar um provedor de navegação do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-108">If there are nested containers, then you must implement a Windows PowerShell navigation provider.</span></span> <span data-ttu-id="2e1a7-109">Para obter mais informações sobre como implementar o provedor de navegação do Windows PowerShell, consulte [criando um provedor de navegação do Windows PowerShell](./creating-a-windows-powershell-navigation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-109">For more information about implementing Windows PowerShell navigation provider, see [Creating a Windows PowerShell Navigation Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

> [!NOTE]
> <span data-ttu-id="2e1a7-110">Você pode baixar o arquivo de origem do C# (AccessDBSampleProvider04.cs) para este provedor usando o kit de desenvolvimento de software do Microsoft Windows para Windows Vista e .NET Framework os componentes de tempo de execução do 3,0.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-110">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="2e1a7-111">Para obter instruções de download, consulte [como instalar o Windows PowerShell e baixar o SDK do Windows PowerShell](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-111">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="2e1a7-112">Os arquivos de origem baixados estão disponíveis no **\<PowerShell Samples>** diretório.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-112">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span> <span data-ttu-id="2e1a7-113">Para obter mais informações sobre outras implementações de provedor do Windows PowerShell, consulte [projetando seu provedor do Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-113">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="2e1a7-114">O provedor de contêiner do Windows PowerShell descrito aqui define o banco de dados como seu único contêiner, com as tabelas e linhas do banco de dados definidas como itens do contêiner.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-114">The Windows PowerShell container provider described here defines the database as its single container, with the tables and rows of the database defined as items of the container.</span></span>

> [!CAUTION]
> <span data-ttu-id="2e1a7-115">Lembre-se de que esse design pressupõe um banco de dados que tem um campo com a ID Name e que o tipo do campo é LongInteger.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-115">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

## <a name="defining-a-windows-powershell-container-provider-class"></a><span data-ttu-id="2e1a7-116">Definindo uma classe de provedor de contêiner do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2e1a7-116">Defining a Windows PowerShell Container Provider Class</span></span>

<span data-ttu-id="2e1a7-117">Um provedor de contêiner do Windows PowerShell deve definir uma classe .NET que deriva da classe base [System. Management. Automation. Provider. Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-117">A Windows PowerShell container provider must define a .NET class that derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="2e1a7-118">Aqui está a definição de classe para o provedor de contêiner do Windows PowerShell descrito nesta seção.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-118">Here is the class definition for the Windows PowerShell container provider described in this section.</span></span>

```csharp
[CmdletProvider("AccessDB", ProviderCapabilities.None)]
public class AccessDBProvider : ContainerCmdletProvider
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="34-35":::

<span data-ttu-id="2e1a7-119">Observe que nessa definição de classe, o atributo [System. Management. Automation. Provider. Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) inclui dois parâmetros.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-119">Notice that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="2e1a7-120">O primeiro parâmetro especifica um nome amigável para o provedor usado pelo Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-120">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="2e1a7-121">O segundo parâmetro especifica os recursos específicos do Windows PowerShell que o provedor expõe para o tempo de execução do Windows PowerShell durante o processamento do comando.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-121">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="2e1a7-122">Para esse provedor, não há recursos específicos do Windows PowerShell adicionados.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-122">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="2e1a7-123">Definindo a funcionalidade base</span><span class="sxs-lookup"><span data-stu-id="2e1a7-123">Defining Base Functionality</span></span>

<span data-ttu-id="2e1a7-124">Conforme descrito em [projetando seu provedor do Windows PowerShell](./designing-your-windows-powershell-provider.md), a classe [System. Management. Automation. Provider. Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) deriva de várias outras classes que forneceram funcionalidade de provedor diferente.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-124">As described in [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="2e1a7-125">O provedor de contêiner do Windows PowerShell, portanto, precisa definir toda a funcionalidade fornecida por essas classes.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-125">A Windows PowerShell container provider, therefore, needs to define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="2e1a7-126">Para implementar a funcionalidade para adicionar informações de inicialização específicas da sessão e para liberar recursos que são usados pelo provedor, consulte [criando um provedor básico do Windows PowerShell](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-126">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span>
<span data-ttu-id="2e1a7-127">No entanto, a maioria dos provedores (incluindo o provedor descrito aqui) pode usar a implementação padrão dessa funcionalidade fornecida pelo Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-127">However, most providers (including the provider described here) can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="2e1a7-128">Para obter acesso ao armazenamento de dados, o provedor deve implementar os métodos da classe base [System. Management. Automation. Provider. Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-128">To get access to the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="2e1a7-129">Para obter mais informações sobre como implementar esses métodos, consulte [criando um provedor de unidade do Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-129">For more information about implementing these methods, see [Creating an Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="2e1a7-130">Para manipular os itens de um armazenamento de dados, como obter, configurar e limpar itens, o provedor deve implementar os métodos fornecidos pela classe base [System. Management. Automation. Provider. @ cmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-130">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="2e1a7-131">Para obter mais informações sobre como implementar esses métodos, consulte [criando um provedor de item do Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-131">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

## <a name="retrieving-child-items"></a><span data-ttu-id="2e1a7-132">Recuperando itens filho</span><span class="sxs-lookup"><span data-stu-id="2e1a7-132">Retrieving Child Items</span></span>

<span data-ttu-id="2e1a7-133">Para recuperar um item filho, o provedor de contêiner do Windows PowerShell deve substituir o método [System. Management. Automation. provedor. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) para dar suporte a chamadas do `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-133">To retrieve a child item, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method to support calls from the `Get-ChildItem` cmdlet.</span></span> <span data-ttu-id="2e1a7-134">Esse método recupera itens filho do armazenamento de dados e os grava no pipeline como objetos.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-134">This method retrieves child items from the data store and writes them to the pipeline as objects.</span></span> <span data-ttu-id="2e1a7-135">Se o `recurse` parâmetro do cmdlet for especificado, o método recuperará todos os filhos, independentemente do nível em que estão.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-135">If the `recurse` parameter of the cmdlet is specified, the method retrieves all children regardless of what level they are at.</span></span> <span data-ttu-id="2e1a7-136">Se o `recurse` parâmetro não for especificado, o método recuperará apenas um único nível de filhos.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-136">If the `recurse` parameter is not specified, the method retrieves only a single level of children.</span></span>

<span data-ttu-id="2e1a7-137">Aqui está a implementação do método [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) para esse provedor.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-137">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method for this provider.</span></span> <span data-ttu-id="2e1a7-138">Observe que esse método recupera os itens filho em todas as tabelas de banco de dados quando o caminho indica o banco de dados do Access e recupera os itens filho das linhas dessa tabela, caso o caminho indique uma tabela.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-138">Notice that this method retrieves the child items in all database tables when the path indicates the Access database, and retrieves the child items from the rows of that table if the path indicates a data table.</span></span>

```csharp
protected override void GetChildItems(string path, bool recurse)
{
    // If path represented is a drive then the children in the path are
    // tables. Hence all tables in the drive represented will have to be
    // returned
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table, path, true);

            // if the specified item exists and recurse has been set then
            // all child items within it have to be obtained as well
            if (ItemExists(path) && recurse)
            {
                GetChildItems(path + pathSeparator + table.Name, recurse);
            }
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get the table name, row number and type of path from the
        // path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Obtain all the rows within the table
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);
            WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
        }
        else
        {
            // In this case, the path specified is not valid
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildItems
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="311-362":::

#### <a name="things-to-remember-about-implementing-getchilditems"></a><span data-ttu-id="2e1a7-139">Coisas a serem lembradas sobre a implementação de GetChildItems</span><span class="sxs-lookup"><span data-stu-id="2e1a7-139">Things to Remember About Implementing GetChildItems</span></span>

<span data-ttu-id="2e1a7-140">As condições a seguir podem se aplicar à implementação de [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="2e1a7-140">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="2e1a7-141">Ao definir a classe do provedor, um provedor de contêiner do Windows PowerShell pode declarar os recursos do provedor de ExpandWildcards, filtrar, incluir ou excluir da enumeração [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-141">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="2e1a7-142">Nesses casos, a implementação do método [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) precisa garantir que o caminho passado para o método atenda aos requisitos dos recursos especificados.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-142">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="2e1a7-143">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, as propriedades [System. Management. Automation. Provider. cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [System. Management. Automation. Provider. cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-143">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="2e1a7-144">A implementação desse método deve levar em conta qualquer forma de acesso ao item que pode tornar o item visível para o usuário.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-144">The implementation of this method should take into account any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="2e1a7-145">Por exemplo, se um usuário tiver acesso de gravação a um arquivo por meio do provedor FileSystem (fornecido pelo Windows PowerShell), mas não tiver acesso de leitura, o arquivo ainda existirá e [System. Management. Automation. Provider. @ cmdletprovider. myexists \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) retornará `true` .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-145">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="2e1a7-146">Sua implementação pode exigir a verificação de um item pai para ver se o filho pode ser enumerado.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-146">Your implementation might require the checking of a parent item to see if the child can be enumerated.</span></span>

- <span data-ttu-id="2e1a7-147">Ao gravar vários itens, o método [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) pode levar algum tempo.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-147">When writing multiple items, the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method can take some time.</span></span> <span data-ttu-id="2e1a7-148">Você pode criar seu provedor para gravar os itens usando o método [System. Management. Automation. Provider. cmdletprovider. Writeitemobject \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) um de cada vez.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-148">You can design your provider to write the items using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method one at a time.</span></span> <span data-ttu-id="2e1a7-149">Usar essa técnica apresentará os itens para o usuário em um fluxo.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-149">Using this technique will present the items to the user in a stream.</span></span>

- <span data-ttu-id="2e1a7-150">Sua implementação de [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) é responsável por impedir a recursão infinita quando há links circulares e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-150">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="2e1a7-151">Uma exceção de encerramento apropriada deve ser lançada para refletir essa condição.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-151">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet"></a><span data-ttu-id="2e1a7-152">Anexando parâmetros dinâmicos ao cmdlet Get-ChildItem</span><span class="sxs-lookup"><span data-stu-id="2e1a7-152">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet</span></span>

<span data-ttu-id="2e1a7-153">Às vezes, o `Get-ChildItem` cmdlet que chama [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requer parâmetros adicionais que são especificados dinamicamente no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-153">Sometimes the `Get-ChildItem` cmdlet that calls [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="2e1a7-154">Para fornecer esses parâmetros dinâmicos, o provedor de contêiner do Windows PowerShell deve implementar o método [System. Management. Automation. Provider. Containercmdletprovider. Getchilditemsdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-154">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) method.</span></span> <span data-ttu-id="2e1a7-155">Esse método recupera parâmetros dinâmicos para o item no caminho indicado e retorna um objeto que tem propriedades e campos com atributos de análise semelhantes a uma classe de cmdlet ou um objeto [System. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-155">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="2e1a7-156">O tempo de execução do Windows PowerShell usa o objeto retornado para adicionar os parâmetros ao `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-156">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="2e1a7-157">Este provedor de contêiner do Windows PowerShell não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-157">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="2e1a7-158">No entanto, o código a seguir é a implementação padrão desse método.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-158">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters](Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters)]  -->

## <a name="retrieving-child-item-names"></a><span data-ttu-id="2e1a7-159">Recuperando nomes de item filho</span><span class="sxs-lookup"><span data-stu-id="2e1a7-159">Retrieving Child Item Names</span></span>

<span data-ttu-id="2e1a7-160">Para recuperar os nomes dos itens filho, o provedor de contêiner do Windows PowerShell deve substituir o método [System. Management. Automation. provedor. Containercmdletprovider. getchildnames \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) para dar suporte a chamadas do `Get-ChildItem` cmdlet quando seu `Name` parâmetro for especificado.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-160">To retrieve the names of child items, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method to support calls from the `Get-ChildItem` cmdlet when its `Name` parameter is specified.</span></span> <span data-ttu-id="2e1a7-161">Esse método recupera os nomes dos itens filho para o caminho especificado ou os nomes de item filho para todos os contêineres se o `returnAllContainers` parâmetro do cmdlet for especificado.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-161">This method retrieves the names of the child items for the specified path or child item names for all containers if the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="2e1a7-162">Um nome filho é a parte folha de um caminho.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-162">A child name is the leaf portion of a path.</span></span> <span data-ttu-id="2e1a7-163">Por exemplo, o nome do filho para o caminho c:\windows\system32\abc.dll é "abc.dll".</span><span class="sxs-lookup"><span data-stu-id="2e1a7-163">For example, the child name for the path c:\windows\system32\abc.dll is "abc.dll".</span></span> <span data-ttu-id="2e1a7-164">O nome filho do diretório c:\Windows\System32 é "System32".</span><span class="sxs-lookup"><span data-stu-id="2e1a7-164">The child name for the directory c:\windows\system32 is "system32".</span></span>

<span data-ttu-id="2e1a7-165">Aqui está a implementação do método [System. Management. Automation. Provider. Containercmdletprovider. getchildnames \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) para esse provedor.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-165">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method for this provider.</span></span> <span data-ttu-id="2e1a7-166">Observe que o método recupera nomes de tabela se o caminho especificado indicar o banco de dados do Access (unidade) e os números de linha se o caminho indicar uma tabela.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-166">Notice that the method retrieves table names if the specified path indicates the Access database (drive) and row numbers if the path indicates a table.</span></span>

```csharp
protected override void GetChildNames(string path,
                            ReturnContainers returnContainers)
{
    // If the path represented is a drive, then the child items are
    // tables. get the names of all the tables in the drive.
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table.Name, path, true);
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get type, table name and row number from path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Get all the rows in the table and then write out the
            // row numbers.
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row.RowNumber, path, false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);

            WriteItemObject(row.RowNumber, path, false);
        }
        else
        {
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildNames
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="369-411":::

#### <a name="things-to-remember-about-implementing-getchildnames"></a><span data-ttu-id="2e1a7-167">Coisas a serem lembradas sobre a implementação de getchildnames</span><span class="sxs-lookup"><span data-stu-id="2e1a7-167">Things to Remember About Implementing GetChildNames</span></span>

<span data-ttu-id="2e1a7-168">As condições a seguir podem se aplicar à implementação de [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="2e1a7-168">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="2e1a7-169">Ao definir a classe do provedor, um provedor de contêiner do Windows PowerShell pode declarar os recursos do provedor de ExpandWildcards, filtrar, incluir ou excluir da enumeração [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-169">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="2e1a7-170">Nesses casos, a implementação do método [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) precisa garantir que o caminho passado para o método atenda aos requisitos dos recursos especificados.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-170">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="2e1a7-171">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, as propriedades [System. Management. Automation. Provider. cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [System. Management. Automation. Provider. cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-171">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

  > [!NOTE]
  > <span data-ttu-id="2e1a7-172">Uma exceção a essa regra ocorre quando o `returnAllContainers` parâmetro do cmdlet é especificado.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-172">An exception to this rule occurs when the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="2e1a7-173">Nesse caso, o método deve recuperar qualquer nome filho para um contêiner, mesmo que ele não corresponda aos valores de [System. Management. Automation. Provider. cmdletprovider. Filter \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System. Management. Automation. Provider. cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)ou [System. Management. Automation. Provider. cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) Properties.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-173">In this case, the method should retrieve any child name for a container, even if it does not match the values of the [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), or [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) properties.</span></span>

- <span data-ttu-id="2e1a7-174">Por padrão, as substituições desse método não devem recuperar nomes de objetos que geralmente são ocultados do usuário, a menos que a propriedade [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) seja especificada.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-174">By default, overrides of this method should not retrieve names of objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="2e1a7-175">Se o caminho especificado indicar um contêiner, a propriedade [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) não será necessária.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-175">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="2e1a7-176">Sua implementação de [System. Management. Automation. Provider. Containercmdletprovider. getchildnames \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) é responsável por impedir a recursão infinita quando há links circulares e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-176">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="2e1a7-177">Uma exceção de encerramento apropriada deve ser lançada para refletir essa condição.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-177">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet-name"></a><span data-ttu-id="2e1a7-178">Anexando parâmetros dinâmicos ao cmdlet Get-ChildItem (Name)</span><span class="sxs-lookup"><span data-stu-id="2e1a7-178">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet (Name)</span></span>

<span data-ttu-id="2e1a7-179">Às vezes, o `Get-ChildItem` cmdlet (com o `Name` parâmetro) requer parâmetros adicionais que são especificados dinamicamente no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-179">Sometimes the `Get-ChildItem` cmdlet (with the `Name` parameter) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="2e1a7-180">Para fornecer esses parâmetros dinâmicos, o provedor de contêiner do Windows PowerShell deve implementar o método [System. Management. Automation. Provider. Containercmdletprovider. Getchildnamesdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-180">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) method.</span></span> <span data-ttu-id="2e1a7-181">Esse método recupera os parâmetros dinâmicos para o item no caminho indicado e retorna um objeto que tem propriedades e campos com atributos de análise semelhantes a uma classe de cmdlet ou um objeto [System. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-181">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="2e1a7-182">O tempo de execução do Windows PowerShell usa o objeto retornado para adicionar os parâmetros ao `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-182">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="2e1a7-183">Este provedor não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-183">This provider does not implement this method.</span></span> <span data-ttu-id="2e1a7-184">No entanto, o código a seguir é a implementação padrão desse método.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-184">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters](Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters)]  -->

## <a name="renaming-items"></a><span data-ttu-id="2e1a7-185">Renomeando itens</span><span class="sxs-lookup"><span data-stu-id="2e1a7-185">Renaming Items</span></span>

<span data-ttu-id="2e1a7-186">Para renomear um item, um provedor de contêiner do Windows PowerShell deve substituir o método [System. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) para dar suporte a chamadas do `Rename-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-186">To rename an item, a Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method to support calls from the `Rename-Item` cmdlet.</span></span> <span data-ttu-id="2e1a7-187">Esse método altera o nome do item no caminho especificado para o novo nome fornecido.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-187">This method changes the name of the item at the specified path to the new name provided.</span></span> <span data-ttu-id="2e1a7-188">O novo nome deve sempre ser relativo ao item pai (contêiner).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-188">The new name must always be relative to the parent item (container).</span></span>

<span data-ttu-id="2e1a7-189">Esse provedor não substitui o método [System. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-189">This provider does not override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method.</span></span> <span data-ttu-id="2e1a7-190">No entanto, a implementação padrão é a seguinte.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-190">However, the following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitem](Msh_samplestestcmdlets#testproviderrenameitem)]  -->

#### <a name="things-to-remember-about-implementing-renameitem"></a><span data-ttu-id="2e1a7-191">Coisas a serem lembradas sobre a implementação de RenameItem</span><span class="sxs-lookup"><span data-stu-id="2e1a7-191">Things to Remember About Implementing RenameItem</span></span>

<span data-ttu-id="2e1a7-192">As condições a seguir podem se aplicar à sua implementação de [System. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span><span class="sxs-lookup"><span data-stu-id="2e1a7-192">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span></span>

- <span data-ttu-id="2e1a7-193">Ao definir a classe do provedor, um provedor de contêiner do Windows PowerShell pode declarar os recursos do provedor de ExpandWildcards, filtrar, incluir ou excluir da enumeração [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-193">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="2e1a7-194">Nesses casos, a implementação do método [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) precisa garantir que o caminho passado para o método atenda aos requisitos dos recursos especificados.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-194">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="2e1a7-195">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, as propriedades [System. Management. Automation. Provider. cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [System. Management. Automation. Provider. cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-195">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="2e1a7-196">O método [System. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) destina-se apenas à modificação do nome de um item e não para operações de movimentação.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-196">The [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method is intended for the modification of the name of an item only, and not for move operations.</span></span>
  <span data-ttu-id="2e1a7-197">Sua implementação do método deve gravar um erro se o `newName` parâmetro contiver separadores de caminho ou, caso contrário, fazer com que o item altere seu local pai.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-197">Your implementation of the method should write an error if the `newName` parameter contains path separators, or might otherwise cause the item to change its parent location.</span></span>

- <span data-ttu-id="2e1a7-198">Por padrão, as substituições desse método não devem renomear objetos, a menos que a propriedade [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) seja especificada.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-198">By default, overrides of this method should not rename objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="2e1a7-199">Se o caminho especificado indicar um contêiner, a propriedade [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) não será necessária.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-199">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="2e1a7-200">Sua implementação do método [System. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) deve chamar [System. Management. Automation. Provider. cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e verificar seu valor de retorno antes de fazer qualquer alteração no armazenamento de dados.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-200">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="2e1a7-201">Esse método é usado para confirmar a execução de uma operação quando uma alteração é feita no estado do sistema, por exemplo, renomeando arquivos.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-201">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span>
  <span data-ttu-id="2e1a7-202">[System. Management. Automation. Provider. cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) envia o nome do recurso a ser alterado para o usuário, com o tempo de execução do Windows PowerShell levando em conta quaisquer configurações de linha de comando ou variáveis de preferência para determinar o que deve ser exibido.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-202">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="2e1a7-203">Após a chamada para [System. Management. Automation. Provider. cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retornar `true` , o método [System. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) deverá chamar o método [System. Management. Automation. Provider. cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-203">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="2e1a7-204">Esse método envia uma mensagem de confirmação ao usuário para permitir comentários adicionais a fim de dizer se a operação deve continuar.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-204">This method sends a message a confirmation message to the user to allow additional feedback to say if the operation should be continued.</span></span> <span data-ttu-id="2e1a7-205">Um provedor deve chamar [System. Management. Automation. Provider. cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) como uma verificação adicional para modificações potencialmente perigosas do sistema.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-205">A provider should call [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-rename-item-cmdlet"></a><span data-ttu-id="2e1a7-206">Anexando parâmetros dinâmicos ao cmdlet Rename-Item</span><span class="sxs-lookup"><span data-stu-id="2e1a7-206">Attaching Dynamic Parameters to the Rename-Item Cmdlet</span></span>

<span data-ttu-id="2e1a7-207">Às vezes, o `Rename-Item` cmdlet requer parâmetros adicionais que são especificados dinamicamente no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-207">Sometimes the `Rename-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="2e1a7-208">Para fornecer esses parâmetros dinâmicos, o provedor de contêiner do Windows PowerShell deve implementar o método [System. Management. Automation. Provider. Containercmdletprovider. Renameitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-208">To provide these dynamic parameters, Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) method.</span></span> <span data-ttu-id="2e1a7-209">Esse método recupera os parâmetros para o item no caminho indicado e retorna um objeto que tem propriedades e campos com atributos de análise semelhantes a uma classe de cmdlet ou um objeto [System. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-209">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="2e1a7-210">O tempo de execução do Windows PowerShell usa o objeto retornado para adicionar os parâmetros ao `Rename-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-210">The Windows PowerShell runtime uses the returned object to add the parameters to the `Rename-Item` cmdlet.</span></span>

<span data-ttu-id="2e1a7-211">Este provedor de contêiner não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-211">This container provider does not implement this method.</span></span> <span data-ttu-id="2e1a7-212">No entanto, o código a seguir é a implementação padrão desse método.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-212">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters](Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters)]  -->

## <a name="creating-new-items"></a><span data-ttu-id="2e1a7-213">Criando novos itens</span><span class="sxs-lookup"><span data-stu-id="2e1a7-213">Creating New Items</span></span>

<span data-ttu-id="2e1a7-214">Para criar novos itens, um provedor de contêiner deve implementar o método [System. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) para dar suporte a chamadas do `New-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-214">To create new items, a container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method to support calls from the `New-Item` cmdlet.</span></span> <span data-ttu-id="2e1a7-215">Esse método cria um item de dados localizado no caminho especificado.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-215">This method creates a data item located at the specified path.</span></span> <span data-ttu-id="2e1a7-216">O `type` parâmetro do cmdlet contém o tipo definido pelo provedor para o novo item.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-216">The `type` parameter of the cmdlet contains the provider-defined type for the new item.</span></span> <span data-ttu-id="2e1a7-217">Por exemplo, o provedor FileSystem usa um `type` parâmetro com um valor de "File" ou "Directory".</span><span class="sxs-lookup"><span data-stu-id="2e1a7-217">For example, the FileSystem provider uses a `type` parameter with a value of "file" or "directory".</span></span> <span data-ttu-id="2e1a7-218">O `newItemValue` parâmetro do cmdlet especifica um valor específico do provedor para o novo item.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-218">The `newItemValue` parameter of the cmdlet specifies a provider-specific value for the new item.</span></span>

<span data-ttu-id="2e1a7-219">Aqui está a implementação do método [System. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) para esse provedor.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-219">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method for this provider.</span></span>

```csharp
protected override void NewItem( string path, string type, object newItemValue )
{
    // Create the new item here after
    // performing necessary validations
    //
    // WriteItemObject(newItemValue, path, false);

    // Example
    //
    // if (ShouldProcess(path, "new item"))
    // {
    //      // Create a new item and then call WriteObject
    //      WriteObject(newItemValue, path, false);
    // }

} // NewItem
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="939-955":::

#### <a name="things-to-remember-about-implementing-newitem"></a><span data-ttu-id="2e1a7-220">Coisas a serem lembradas sobre a implementação de NewItem</span><span class="sxs-lookup"><span data-stu-id="2e1a7-220">Things to Remember About Implementing NewItem</span></span>

<span data-ttu-id="2e1a7-221">As condições a seguir podem se aplicar à sua implementação de [System. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="2e1a7-221">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="2e1a7-222">O método [System. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) deve executar uma comparação que não diferencia maiúsculas de minúsculas da cadeia de caracteres passada no `type` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-222">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should perform a case-insensitive comparison of the string passed in the `type` parameter.</span></span>
  <span data-ttu-id="2e1a7-223">Ele também deve permitir correspondências menos ambíguas.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-223">It should also allow for least ambiguous matches.</span></span> <span data-ttu-id="2e1a7-224">Por exemplo, para os tipos "File" e "Directory", somente a primeira letra é necessária para ambiguidade.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-224">For example, for the types "file" and "directory", only the first letter is required to disambiguate.</span></span> <span data-ttu-id="2e1a7-225">Se o `type` parâmetro indicar um tipo que seu provedor não pode criar, o método [System. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) deve escrever um ArgumentException com uma mensagem indicando os tipos que o provedor pode criar.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-225">If the `type` parameter indicates a type your provider cannot create, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should write an ArgumentException with a message indicating the types the provider can create.</span></span>

- <span data-ttu-id="2e1a7-226">Para o `newItemValue` parâmetro, a implementação do método [System. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) é recomendada para aceitar cadeias de caracteres no mínimo.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-226">For the `newItemValue` parameter, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method is recommended to accept strings at a minimum.</span></span> <span data-ttu-id="2e1a7-227">Ele também deve aceitar o tipo de objeto recuperado pelo método [System. Management. Automation. Provider. docmdletprovider. GetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) para o mesmo caminho.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-227">It should also accept the type of object that is retrieved by the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the same path.</span></span> <span data-ttu-id="2e1a7-228">O método [System. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) pode usar o método [System. Management. Automation. LanguagePrimitives. ConvertTo \*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) para converter tipos para o tipo desejado.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-228">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method can use the [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) method to convert types to the desired type.</span></span>

- <span data-ttu-id="2e1a7-229">Sua implementação do método [System. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) deve chamar [System. Management. Automation. Provider. cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e verificar seu valor de retorno antes de fazer qualquer alteração no armazenamento de dados.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-229">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="2e1a7-230">Após a chamada para [System. Management. Automation. Provider. cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retornar true, o método [System. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) deverá chamar o método [System. Management. Automation. Provider. cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) como uma verificação adicional para modificações potencialmente perigosas do sistema.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-230">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-new-item-cmdlet"></a><span data-ttu-id="2e1a7-231">Anexando parâmetros dinâmicos ao cmdlet New-Item</span><span class="sxs-lookup"><span data-stu-id="2e1a7-231">Attaching Dynamic Parameters to the New-Item Cmdlet</span></span>

<span data-ttu-id="2e1a7-232">Às vezes, o `New-Item` cmdlet requer parâmetros adicionais que são especificados dinamicamente no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-232">Sometimes the `New-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="2e1a7-233">Para fornecer esses parâmetros dinâmicos, o provedor de contêiner deve implementar o método [System. Management. Automation. Provider. Containercmdletprovider. Newitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-233">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) method.</span></span> <span data-ttu-id="2e1a7-234">Esse método recupera os parâmetros para o item no caminho indicado e retorna um objeto que tem propriedades e campos com atributos de análise semelhantes a uma classe de cmdlet ou um objeto [System. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-234">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="2e1a7-235">O tempo de execução do Windows PowerShell usa o objeto retornado para adicionar os parâmetros ao `New-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-235">The Windows PowerShell runtime uses the returned object to add the parameters to the `New-Item` cmdlet.</span></span>

<span data-ttu-id="2e1a7-236">Este provedor não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-236">This provider does not implement this method.</span></span> <span data-ttu-id="2e1a7-237">No entanto, o código a seguir é a implementação padrão desse método.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-237">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernewitemdynamicparameters](Msh_samplestestcmdlets#testprovidernewitemdynamicparameters)]  -->

## <a name="removing-items"></a><span data-ttu-id="2e1a7-238">Removendo itens</span><span class="sxs-lookup"><span data-stu-id="2e1a7-238">Removing Items</span></span>

<span data-ttu-id="2e1a7-239">Para remover itens, o provedor do Windows PowerShell deve substituir o método [System. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) para dar suporte a chamadas do `Remove-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-239">To remove items, the Windows PowerShell provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method to support calls from the `Remove-Item` cmdlet.</span></span> <span data-ttu-id="2e1a7-240">Esse método exclui um item do repositório de dados no caminho especificado.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-240">This method deletes an item from the data store at the specified path.</span></span> <span data-ttu-id="2e1a7-241">Se o `recurse` parâmetro do `Remove-Item` cmdlet for definido como `true` , o método removerá todos os itens filho, independentemente de seu nível.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-241">If the `recurse` parameter of the `Remove-Item` cmdlet is set to `true`, the method removes all child items regardless of their level.</span></span> <span data-ttu-id="2e1a7-242">Se o parâmetro for definido como `false` , o método removerá apenas um único item no caminho especificado.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-242">If the parameter is set to `false`, the method removes only a single item at the specified path.</span></span>

<span data-ttu-id="2e1a7-243">Este provedor não dá suporte à remoção de item.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-243">This provider does not support item removal.</span></span> <span data-ttu-id="2e1a7-244">No entanto, o código a seguir é a implementação padrão de [System. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-244">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitem](Msh_samplestestcmdlets#testproviderremoveitem)]  -->

#### <a name="things-to-remember-about-implementing-removeitem"></a><span data-ttu-id="2e1a7-245">Coisas a serem lembradas sobre a implementação de RemoveItem</span><span class="sxs-lookup"><span data-stu-id="2e1a7-245">Things to Remember About Implementing RemoveItem</span></span>

<span data-ttu-id="2e1a7-246">As condições a seguir podem se aplicar à sua implementação de [System. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="2e1a7-246">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="2e1a7-247">Ao definir a classe do provedor, um provedor de contêiner do Windows PowerShell pode declarar os recursos do provedor de ExpandWildcards, filtrar, incluir ou excluir da enumeração [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-247">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="2e1a7-248">Nesses casos, a implementação do método [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) precisa garantir que o caminho passado para o método atenda aos requisitos dos recursos especificados.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-248">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="2e1a7-249">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, as propriedades [System. Management. Automation. Provider. cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [System. Management. Automation. Provider. cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-249">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="2e1a7-250">Por padrão, as substituições desse método não devem remover objetos, a menos que a propriedade [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) esteja definida como true.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-250">By default, overrides of this method should not remove objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to true.</span></span> <span data-ttu-id="2e1a7-251">Se o caminho especificado indicar um contêiner, a propriedade [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) não será necessária.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-251">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="2e1a7-252">A implementação de [System. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) é responsável por impedir a recursão infinita quando há links circulares e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-252">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="2e1a7-253">Uma exceção de encerramento apropriada deve ser lançada para refletir essa condição.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-253">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="2e1a7-254">Sua implementação do método [System. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) deve chamar [System. Management. Automation. Provider. cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e verificar seu valor de retorno antes de fazer qualquer alteração no armazenamento de dados.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-254">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="2e1a7-255">Após a chamada para [System. Management. Automation. Provider. cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retornar `true` , o método [System. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) deverá chamar o método [System. Management. Automation. Provider. cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) como uma verificação adicional para modificações potencialmente perigosas do sistema.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-255">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-remove-item-cmdlet"></a><span data-ttu-id="2e1a7-256">Anexando parâmetros dinâmicos ao cmdlet Remove-Item</span><span class="sxs-lookup"><span data-stu-id="2e1a7-256">Attaching Dynamic Parameters to the Remove-Item Cmdlet</span></span>

<span data-ttu-id="2e1a7-257">Às vezes, o `Remove-Item` cmdlet requer parâmetros adicionais que são especificados dinamicamente no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-257">Sometimes the `Remove-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="2e1a7-258">Para fornecer esses parâmetros dinâmicos, o provedor de contêiner deve implementar o método [System. Management. Automation. Provider. Containercmdletprovider. Removeitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) para lidar com esses parâmetros.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-258">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="2e1a7-259">Esse método recupera os parâmetros dinâmicos para o item no caminho indicado e retorna um objeto que tem propriedades e campos com atributos de análise semelhantes a uma classe de cmdlet ou um objeto [System. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-259">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="2e1a7-260">O tempo de execução do Windows PowerShell usa o objeto retornado para adicionar os parâmetros ao `Remove-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-260">The Windows PowerShell runtime uses the returned object to add the parameters to the `Remove-Item` cmdlet.</span></span>

<span data-ttu-id="2e1a7-261">Este provedor de contêiner não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-261">This container provider does not implement this method.</span></span> <span data-ttu-id="2e1a7-262">No entanto, o código a seguir é a implementação padrão de [System. Management. Automation. Provider. Containercmdletprovider. Removeitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-262">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters](Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters)]  -->

## <a name="querying-for-child-items"></a><span data-ttu-id="2e1a7-263">Consultando itens filho</span><span class="sxs-lookup"><span data-stu-id="2e1a7-263">Querying for Child Items</span></span>

<span data-ttu-id="2e1a7-264">Para verificar se há itens filho no caminho especificado, o provedor de contêiner do Windows PowerShell deve substituir o método [System. Management. Automation. Provider. Containercmdletprovider. Haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-264">To check to see if child items exist at the specified path, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="2e1a7-265">Esse método retorna `true` se o item tem filhos e, `false` caso contrário.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-265">This method returns `true` if the item has children, and `false` otherwise.</span></span> <span data-ttu-id="2e1a7-266">Para um caminho nulo ou vazio, o método considera que todos os itens no repositório de dados sejam filhos e retorna `true` .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-266">For a null or empty path, the method considers any items in the data store to be children and returns `true`.</span></span>

<span data-ttu-id="2e1a7-267">Aqui está a substituição para o método [System. Management. Automation. Provider. Containercmdletprovider. Haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-267">Here is the override for the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="2e1a7-268">Se houver mais de duas partes de caminho criadas pelo método auxiliar ChunkPath, o método retornará `false` , pois apenas um contêiner de banco de dados e um contêiner de tabela são definidos.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-268">If there are more than two path parts created by the ChunkPath helper method, the method returns `false`, since only a database container and a table container are defined.</span></span> <span data-ttu-id="2e1a7-269">Para obter mais informações sobre esse método auxiliar, consulte o método ChunkPath é discutido na [criação de um provedor de item do Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-269">For more information about this helper method, see the ChunkPath method is discussed in [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

```csharp
protected override bool HasChildItems( string path )
{
    return false;
} // HasChildItems
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="1094-1097":::

#### <a name="things-to-remember-about-implementing-haschilditems"></a><span data-ttu-id="2e1a7-270">Coisas a serem lembradas sobre a implementação de HasChildItems</span><span class="sxs-lookup"><span data-stu-id="2e1a7-270">Things to Remember About Implementing HasChildItems</span></span>

<span data-ttu-id="2e1a7-271">As condições a seguir podem se aplicar à sua implementação de [System. Management. Automation. Provider. Containercmdletprovider. Haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span><span class="sxs-lookup"><span data-stu-id="2e1a7-271">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span></span>

- <span data-ttu-id="2e1a7-272">Se o provedor de contêiner expõe uma raiz que contém pontos de montagem interessantes, a implementação do método [System. Management. Automation. Provider. Containercmdletprovider. Haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) deve retornar `true` quando uma cadeia de caracteres nula ou vazia for passada para o caminho.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-272">If the container provider exposes a root that contains interesting mount points, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method should return `true` when a null or an empty string is passed in for the path.</span></span>

## <a name="copying-items"></a><span data-ttu-id="2e1a7-273">Copiando itens</span><span class="sxs-lookup"><span data-stu-id="2e1a7-273">Copying Items</span></span>

<span data-ttu-id="2e1a7-274">Para copiar itens, o provedor de contêiner deve implementar o método [System. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) para dar suporte a chamadas do `Copy-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-274">To copy items, the container provider must implement the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method to support calls from the `Copy-Item` cmdlet.</span></span> <span data-ttu-id="2e1a7-275">Esse método copia um item de dados do local indicado pelo `path` parâmetro do cmdlet para o local indicado pelo `copyPath` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-275">This method copies a data item from the location indicated by the `path` parameter of the cmdlet to the location indicated by the `copyPath` parameter.</span></span> <span data-ttu-id="2e1a7-276">Se o `recurse` parâmetro for especificado, o método copiará todos os subcontêineres.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-276">If the `recurse` parameter is specified, the method copies all sub-containers.</span></span> <span data-ttu-id="2e1a7-277">Se o parâmetro não for especificado, o método copiará apenas um único nível de itens.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-277">If the parameter is not specified, the method copies only a single level of items.</span></span>

<span data-ttu-id="2e1a7-278">Este provedor não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-278">This provider does not implement this method.</span></span> <span data-ttu-id="2e1a7-279">No entanto, o código a seguir é a implementação padrão de [System. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-279">However, the following code is the default implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitem](Msh_samplestestcmdlets#testprovidercopyitem)]  -->

#### <a name="things-to-remember-about-implementing-copyitem"></a><span data-ttu-id="2e1a7-280">Coisas a serem lembradas sobre a implementação de CopyItem</span><span class="sxs-lookup"><span data-stu-id="2e1a7-280">Things to Remember About Implementing CopyItem</span></span>

<span data-ttu-id="2e1a7-281">As condições a seguir podem se aplicar à sua implementação de [System. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span><span class="sxs-lookup"><span data-stu-id="2e1a7-281">The following conditions may apply to your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span></span>

- <span data-ttu-id="2e1a7-282">Ao definir a classe do provedor, um provedor de contêiner do Windows PowerShell pode declarar os recursos do provedor de ExpandWildcards, filtrar, incluir ou excluir da enumeração [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-282">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="2e1a7-283">Nesses casos, a implementação do método [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) precisa garantir que o caminho passado para o método atenda aos requisitos dos recursos especificados.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-283">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="2e1a7-284">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, as propriedades [System. Management. Automation. Provider. cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [System. Management. Automation. Provider. cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-284">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="2e1a7-285">Por padrão, as substituições desse método não devem copiar objetos sobre objetos existentes, a menos que a propriedade [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) seja definida como `true` .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-285">By default, overrides of this method should not copy objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="2e1a7-286">Por exemplo, o provedor FileSystem não copiará c:\temp\abc.txt sobre um arquivo c:\abc.txt existente, a menos que a propriedade [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) esteja definida como `true` .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-286">For example, the FileSystem provider will not copy c:\temp\abc.txt over an existing c:\abc.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="2e1a7-287">Se o caminho especificado no `copyPath` parâmetro existir e indicar um contêiner, a propriedade [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) não será necessária.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-287">If the path specified in the `copyPath` parameter exists and indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="2e1a7-288">Nesse caso, [System. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) deve copiar o item indicado pelo `path` parâmetro para o contêiner indicado pelo `copyPath` parâmetro como um filho.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-288">In this case, [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) should copy the item indicated by the `path` parameter to the container indicated by the `copyPath` parameter as a child.</span></span>

- <span data-ttu-id="2e1a7-289">Sua implementação de [System. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) é responsável por impedir a recursão infinita quando há links circulares e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-289">Your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="2e1a7-290">Uma exceção de encerramento apropriada deve ser lançada para refletir essa condição.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-290">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="2e1a7-291">Sua implementação do método [System. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) deve chamar [System. Management. Automation. Provider. cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e verificar seu valor de retorno antes de fazer qualquer alteração no armazenamento de dados.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-291">Your implementation of the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="2e1a7-292">Após a chamada para [System. Management. Automation. Provider. cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retornar true, o método [System. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) deverá chamar o método [System. Management. Automation. Provider. cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) como uma verificação adicional para modificações potencialmente perigosas do sistema.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-292">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span> <span data-ttu-id="2e1a7-293">Para obter mais informações sobre como chamar esses métodos, consulte [renomear itens](#renaming-items).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-293">For more information about calling these methods, see [Rename Items](#renaming-items).</span></span>

## <a name="attaching-dynamic-parameters-to-the-copy-item-cmdlet"></a><span data-ttu-id="2e1a7-294">Anexando parâmetros dinâmicos ao cmdlet Copy-Item</span><span class="sxs-lookup"><span data-stu-id="2e1a7-294">Attaching Dynamic Parameters to the Copy-Item Cmdlet</span></span>

<span data-ttu-id="2e1a7-295">Às vezes, o `Copy-Item` cmdlet requer parâmetros adicionais que são especificados dinamicamente no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-295">Sometimes the `Copy-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="2e1a7-296">Para fornecer esses parâmetros dinâmicos, o provedor de contêiner do Windows PowerShell deve implementar o método [System. Management. Automation. Provider. Containercmdletprovider. Copyitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) para lidar com esses parâmetros.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-296">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="2e1a7-297">Esse método recupera os parâmetros para o item no caminho indicado e retorna um objeto que tem propriedades e campos com atributos de análise semelhantes a uma classe de cmdlet ou um objeto [System. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="2e1a7-297">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="2e1a7-298">O tempo de execução do Windows PowerShell usa o objeto retornado para adicionar os parâmetros ao `Copy-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-298">The Windows PowerShell runtime uses the returned object to add the parameters to the `Copy-Item` cmdlet.</span></span>

<span data-ttu-id="2e1a7-299">Este provedor não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-299">This provider does not implement this method.</span></span> <span data-ttu-id="2e1a7-300">No entanto, o código a seguir é a implementação padrão de [System. Management. Automation. Provider. Containercmdletprovider. Copyitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-300">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters](Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters)]  -->

## <a name="code-sample"></a><span data-ttu-id="2e1a7-301">Exemplo de código</span><span class="sxs-lookup"><span data-stu-id="2e1a7-301">Code Sample</span></span>

<span data-ttu-id="2e1a7-302">Para obter o código de exemplo completo, consulte [exemplo de código AccessDbProviderSample04](./accessdbprovidersample04-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-302">For complete sample code, see [AccessDbProviderSample04 Code Sample](./accessdbprovidersample04-code-sample.md).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="2e1a7-303">Criando o provedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2e1a7-303">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="2e1a7-304">Consulte [como registrar cmdlets, provedores e aplicativos de host](/previous-versions/ms714644(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="2e1a7-304">See [How to Register Cmdlets, Providers, and Host Applications](/previous-versions/ms714644(v=vs.85)).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="2e1a7-305">Testando o provedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2e1a7-305">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="2e1a7-306">Quando o provedor do Windows PowerShell tiver sido registrado com o Windows PowerShell, você poderá testá-lo executando os cmdlets com suporte na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-306">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="2e1a7-307">Lembre-se de que a saída de exemplo a seguir usa um banco de dados de acesso fictício.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-307">Be aware that the following example output uses a fictitious Access database.</span></span>

1. <span data-ttu-id="2e1a7-308">Execute o `Get-ChildItem` cmdlet para recuperar a lista de itens filho de uma tabela Customers no banco de dados Access.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-308">Run the `Get-ChildItem` cmdlet to retrieve the list of child items from a Customers table in the Access database.</span></span>

   ```powershell
   Get-ChildItem mydb:customers
   ```

   <span data-ttu-id="2e1a7-309">A saída a seguir aparece.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-309">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : True
   Data          : System.Data.DataRow
   Name          : Customers
   RowCount      : 91
   Columns       :
   ```

2. <span data-ttu-id="2e1a7-310">Execute o `Get-ChildItem` cmdlet novamente para recuperar os dados de uma tabela.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-310">Run the `Get-ChildItem` cmdlet again to retrieve the data of a table.</span></span>

   ```powershell
   (Get-ChildItem mydb:customers).data
   ```

   <span data-ttu-id="2e1a7-311">A saída a seguir aparece.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-311">The following output appears.</span></span>

   ```output
   TABLE_CAT   : c:\PS\northwind
   TABLE_SCHEM :
   TABLE_NAME  : Customers
   TABLE_TYPE  : TABLE
   REMARKS     :
   ```

3. <span data-ttu-id="2e1a7-312">Agora, use o `Get-Item` cmdlet para recuperar os itens na linha 0 na tabela de dados.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-312">Now use the `Get-Item` cmdlet to retrieve the items at row 0 in the data table.</span></span>

   ```powershell
   Get-Item mydb:\customers\0
   ```

   <span data-ttu-id="2e1a7-313">A saída a seguir aparece.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-313">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers\0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data          : System.Data.DataRow
   RowNumber     : 0
   ```

4. <span data-ttu-id="2e1a7-314">Reutilize `Get-Item` para recuperar os dados para os itens na linha 0.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-314">Reuse `Get-Item` to retrieve the data for the items in row 0.</span></span>

   ```powershell
   (Get-Item mydb:\customers\0).data
   ```

   <span data-ttu-id="2e1a7-315">A saída a seguir aparece.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-315">The following output appears.</span></span>

   ```output
   CustomerID   : 1234
   CompanyName  : Fabrikam
   ContactName  : Eric Gruber
   ContactTitle : President
   Address      : 4567 Main Street
   City         : Buffalo
   Region       : NY
   PostalCode   : 98052
   Country      : USA
   Phone        : (425) 555-0100
   Fax          : (425) 555-0101
   ```

5. <span data-ttu-id="2e1a7-316">Agora, use o `New-Item` cmdlet para adicionar uma linha a uma tabela existente.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-316">Now use the `New-Item` cmdlet to add a row to an existing table.</span></span> <span data-ttu-id="2e1a7-317">O `Path` parâmetro especifica o caminho completo para a linha e deve indicar um número de linha maior que o número existente de linhas na tabela.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-317">The `Path` parameter specifies the full path to the row, and must indicate a row number that is greater than the existing number of rows in the table.</span></span> <span data-ttu-id="2e1a7-318">O `Type` parâmetro indica "Row" para especificar esse tipo de item a ser adicionado.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-318">The `Type` parameter indicates "row" to specify that type of item to add.</span></span>
   <span data-ttu-id="2e1a7-319">Por fim, o `Value` parâmetro especifica uma lista delimitada por vírgulas de valores de coluna para a linha.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-319">Finally, the `Value` parameter specifies a comma-delimited list of column values for the row.</span></span>

   ```powershell
   New-Item -Path mydb:\Customers\3 -ItemType "row" -Value "3,CustomerFirstName,CustomerLastName,CustomerEmailAddress,CustomerTitle,CustomerCompany,CustomerPhone, CustomerAddress,CustomerCity,CustomerState,CustomerZip,CustomerCountry"
   ```

6. <span data-ttu-id="2e1a7-320">Verifique a exatidão da nova operação de item da seguinte maneira.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-320">Verify the correctness of the new item operation as follows.</span></span>

   ```none
   PS mydb:\> cd Customers
   PS mydb:\Customers> (Get-Item 3).data
   ```

   <span data-ttu-id="2e1a7-321">A saída a seguir aparece.</span><span class="sxs-lookup"><span data-stu-id="2e1a7-321">The following output appears.</span></span>

   ```output
   ID        : 3
   FirstName : Eric
   LastName  : Gruber
   Email     : ericgruber@fabrikam.com
   Title     : President
   Company   : Fabrikam
   WorkPhone : (425) 555-0100
   Address   : 4567 Main Street
   City      : Buffalo
   State     : NY
   Zip       : 98052
   Country   : USA
   ```

## <a name="see-also"></a><span data-ttu-id="2e1a7-322">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="2e1a7-322">See Also</span></span>

[<span data-ttu-id="2e1a7-323">Criando provedores do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2e1a7-323">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="2e1a7-324">Projetar seu provedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2e1a7-324">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="2e1a7-325">Implementando um provedor de item do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2e1a7-325">Implementing an Item Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-item-provider.md)

[<span data-ttu-id="2e1a7-326">Implementando um provedor de navegação do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2e1a7-326">Implementing a Navigation Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

<span data-ttu-id="2e1a7-327">[Como registrar cmdlets, provedores e aplicativos host](/previous-versions/ms714644(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="2e1a7-327">[How to Register Cmdlets, Providers, and Host Applications](/previous-versions/ms714644(v=vs.85))</span></span>

[<span data-ttu-id="2e1a7-328">SDK do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2e1a7-328">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="2e1a7-329">Guia do programador do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2e1a7-329">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)
